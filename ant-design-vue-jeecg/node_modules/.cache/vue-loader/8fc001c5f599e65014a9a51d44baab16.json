{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\consumer\\modules\\AppUserInfoModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\consumer\\modules\\AppUserInfoModal.vue","mtime":1588673568170},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Vue from 'vue'\nimport { httpAction } from '@/api/manage'\nimport { ACCESS_TOKEN } from \"@/store/mutation-types\"\nimport pick from 'lodash.pick'\nimport moment from \"moment\"\nimport * as qiniu from 'qiniu-js'\n\nexport default {\n  name: \"AppUserInfoModal\",\n  data () {\n    return {\n      title:\"操作\",\n      visible: false,\n      model: {},\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 5 },\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 16 },\n      },\n      loading: false,\n      confirmLoading: false,\n      disableSubmit: false,\n      coverimg: '',\n      canimg: '',\n      percent: '',\n      headers: {},\n      form: this.$form.createForm(this),\n      validatorRules:{\n      userid:{rules: [{ required: true, message: '请输入用户ID!' }]},\n      },\n      url: {\n        add: \"/user/appUserInfo/add\",\n        edit: \"/user/appUserInfo/edit\",\n        fileUpload: window._CONFIG['domianQiNiu'],\n        qiniuToken: '/qiniuUpToken'\n      },\n    }\n  },\n  created () {\n    const token = Vue.ls.get(ACCESS_TOKEN);\n    this.headers = {\"X-Access-Token\":token};\n  },\n  computed:{\n    uploadAction:function () {\n      return this.url.fileUpload;\n    }\n  },\n  methods: {\n    add () {\n      this.edit({});\n    },\n    edit (record) {\n      this.coverimg = record.header;\n      this.canimg = record.header;\n      this.form.resetFields();\n      this.model = Object.assign({}, record);\n      this.visible = true;\n      this.$nextTick(() => {\n        this.form.setFieldsValue(pick(this.model,'code','nickName','header','credits','phone','role','money','balance','createTime','startTime','ambassador','endTime'))\n        this.form.setFieldsValue({endTime:this.model.endTime?moment(this.model.endTime):null})\n        this.form.setFieldsValue({startTime:this.model.startTime?moment(this.model.startTime):null})\n        this.form.setFieldsValue({createTime:this.model.createTime?moment(this.model.createTime):null})\n      });\n\n    },\n    close () {\n      this.$emit('close');\n      this.visible = false;\n    },\n    handleOk () {\n      const that = this;\n      // 触发表单验证\n      this.form.validateFields((err, values) => {\n        if (!err) {\n          that.confirmLoading = true;\n          let httpurl = '';\n          let method = '';\n          if(!this.model.id){\n            httpurl+=this.url.add;\n            method = 'post';\n          }else{\n            httpurl+=this.url.edit;\n             method = 'put';\n          }\n          let formData = Object.assign(this.model, values);\n          //时间格式化\n          formData.endtime = formData.endtime?formData.endtime.format('YYYY-MM-DD'):null;\n          formData.sigendtime = formData.sigendtime?formData.sigendtime.format('YYYY-MM-DD'):null;\n\n          console.log(formData)\n          httpAction(httpurl,formData,method).then((res)=>{\n            if(res.success){\n              that.$message.success(res.message);\n              that.$emit('ok');\n            }else{\n              that.$message.warning(res.message);\n            }\n          }).finally(() => {\n            that.confirmLoading = false;\n            that.close();\n          })\n\n\n\n        }\n      })\n    },\n    handleCancel () {\n      this.close()\n    },\n    // 自定义上传\n    customRequest (data) {\n      const suffix = \".\" + data.file.name.replace(/^.+\\./, '')\n      //请求token\n      httpAction(this.url.qiniuToken, {}, 'post').then((res) => {\n        if (res) {\n          let token = res.data.token\n          const file = data.file\n          const key = new Date().getTime() + suffix;\n          let domain = this.url.fileUpload\n          let config = {\n            useCdnDomain: true,\n            region: null\n          }\n          let putExtra = {\n            fname: '',\n            params: {},\n            mimeType: null\n          }\n          let observable = qiniu.upload(file, key, token, putExtra, config);\n          observable.subscribe({\n            next: (res) => {\n              this.loading = true;\n              this.percent = res.total.percent.toFixed(2)\n              this.coverimg = '';\n            },\n            error: () => {\n              this.$message.error('上传失败')\n              this.loading = false;\n              this.coverimg = this.canimg\n            },\n            complete: (response) => {\n              this.coverimg = `${domain}/${response.key}`;\n              this.loading = false;\n            }\n          })\n        }\n      })\n    },\n\n  }\n}\n",{"version":3,"sources":["AppUserInfoModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwYA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"AppUserInfoModal.vue","sourceRoot":"src/views/consumer/modules","sourcesContent":["<template>\n  <a-modal\n    :title=\"title\"\n    :width=\"800\"\n    :visible=\"visible\"\n    :confirmLoading=\"confirmLoading\"\n    @ok=\"handleOk\"\n    @cancel=\"handleCancel\"\n    cancelText=\"关闭\"\n    :footer=\"null\"\n  >\n\n    <a-spin :spinning=\"confirmLoading\">\n      <a-form :form=\"form\">\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"手机号\">\n          <a-input placeholder=\"请输入手机号\" v-decorator=\"['phone', {}]\" :readOnly=\"disableSubmit\"/>\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"V云号\">\n          <a-input-number v-decorator=\"[ 'code', {} ]\" :disabled=\"disableSubmit\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"昵称\">\n          <a-input placeholder=\"请输入昵称\" v-decorator=\"['nickName', {}]\" :readOnly=\"disableSubmit\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"头像\">\n          <a-upload\n            accept=\"image/*\"\n            listType=\"picture-card\"\n            class=\"avatar-uploader\"\n            :showUploadList=\"false\"\n            :supportServerRender=\"true\"\n            :customRequest=\"customRequest\"\n            :disabled=\"disableSubmit\"\n          >\n            <img v-if=\"coverimg\" :src=\"coverimg\" alt=\"avatar\" style=\"max-width: 150px;\" />\n            <div v-else>\n              <a-icon :type=\"loading ? 'loading' : 'plus'\" />\n              <div class=\"ant-upload-text\" v-if=\"!loading\">Upload</div>\n              <div class=\"ant-upload-text\" v-if=\"loading\">{{ percent }}%</div>\n            </div>\n          </a-upload>\n          <!-- <a-input placeholder=\"请输入头像\" v-decorator=\"['header', {}]\" :readOnly=\"disableSubmit\" />-->\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"角色\">\n          <a-select placeholder=\"清选择角色\" v-decorator=\"[ 'role', {}]\" :disabled=\"disableSubmit\">\n            <a-select-option value=\"0\">普通会员</a-select-option>\n            <a-select-option value=\"1\">VIP会员</a-select-option>\n            <a-select-option value=\"2\">大V会员</a-select-option>\n          </a-select>\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"v云大使\">\n          <a-select placeholder=\"清选择是否为v云大使\" v-decorator=\"[ 'ambassador', {}]\" :disabled=\"disableSubmit\">\n            <a-select-option :value=\"0\">否</a-select-option>\n            <a-select-option :value=\"1\">是</a-select-option>\n          </a-select>\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"V币\">\n          <a-input-number v-decorator=\"[ 'money', {}]\" :disabled=\"disableSubmit\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"V钻\">\n          <a-input-number v-decorator=\"[ 'balance', {}]\" :disabled=\"disableSubmit\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"大V值\">\n          <a-input placeholder=\"请输入大V值\" v-decorator=\"['credits', {}]\" :readOnly=\"disableSubmit\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"创建时间\">\n          <a-date-picker showTime format=\"YYYY-MM-DD HH:mm:ss\" v-decorator=\"[ 'createTime', {}]\" :disabled=\"disableSubmit\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"收费会员开始时间\">\n          <a-date-picker v-decorator=\"[ 'startTime', {}]\" :disabled=\"disableSubmit\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"收费会员结束时间\">\n          <a-date-picker v-decorator=\"[ 'endTime', {}]\" :disabled=\"disableSubmit\" />\n        </a-form-item>\n        <!-- <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"真实姓名\">\n          <a-input placeholder=\"请输入真实姓名\" v-decorator=\"['realname', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"身份证号\">\n          <a-input placeholder=\"请输入身份证号\" v-decorator=\"['idcard', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"手持身份证照片\">\n          <a-input placeholder=\"请输入手持身份证照片\" v-decorator=\"['idcardimage', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"支付密码\">\n          <a-input placeholder=\"请输入支付密码\" v-decorator=\"['paypassword', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"生日\">\n          <a-input placeholder=\"请输入生日\" v-decorator=\"['birthday', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"个性签名\">\n          <a-input placeholder=\"请输入个性签名\" v-decorator=\"['personsign', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"是否是主播（0否1是）\">\n          <a-input-number v-decorator=\"[ 'isanchor', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"冻结金额\">\n          <a-input-number v-decorator=\"[ 'frozenbalance', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"是否自动充值会员\">\n          <a-input placeholder=\"请输入是否自动充值会员\" v-decorator=\"['isauto', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"自动充值金额\">\n          <a-input-number v-decorator=\"[ 'automoney', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"收藏课程数量\">\n          <a-input-number v-decorator=\"[ 'collectcount', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"粉丝数量\">\n          <a-input-number v-decorator=\"[ 'funscount', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"关注数量\">\n          <a-input-number v-decorator=\"[ 'attentioncount', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"主播描述\">\n          <a-input placeholder=\"请输入主播描述\" v-decorator=\"['anchordescr', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"腾讯Im唯一标示(环信账号)\">\n          <a-input placeholder=\"请输入腾讯Im唯一标示(环信账号)\" v-decorator=\"['imidentifier', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"独家号\">\n          <a-input placeholder=\"请输入独家号\" v-decorator=\"['code', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"0：不是vip 1：7天vip 2：月度vip 3：季度vip 4：年费vip\">\n          <a-input-number v-decorator=\"[ 'isvip', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"邀请人id\">\n          <a-input-number v-decorator=\"[ 'inviteid', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"自身邀请码\">\n          <a-input placeholder=\"请输入自身邀请码\" v-decorator=\"['invitecode', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"邀请二维码\">\n          <a-input placeholder=\"请输入邀请二维码\" v-decorator=\"['inviteimage', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"该用户所属团队ID\">\n          <a-input-number v-decorator=\"[ 'teamid', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"邀请人数\">\n          <a-input-number v-decorator=\"[ 'invitenumber', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"是否是团队创始人（0否1是）\">\n          <a-input-number v-decorator=\"[ 'isteamcreate', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"积分（申请大V）\">\n          <a-input-number v-decorator=\"[ 'credits', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"腾讯用户签名\">\n          <a-input placeholder=\"请输入腾讯用户签名\" v-decorator=\"['imusersig', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"签名到期时间\">\n          <a-date-picker showTime format='YYYY-MM-DD HH:mm:ss' v-decorator=\"[ 'sigendtime', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"是否登陆（是否激活）\">\n          <a-input-number v-decorator=\"[ 'islogin', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"是否存在分销关系（0否1是）\">\n          <a-input-number v-decorator=\"[ 'isparent', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"临时级别id\">\n          <a-input placeholder=\"请输入临时级别id\" v-decorator=\"['fatherid', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"电话区号\">\n          <a-input placeholder=\"请输入电话区号\" v-decorator=\"['prefix', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"身份证正面照片\">\n          <a-input placeholder=\"请输入身份证正面照片\" v-decorator=\"['idcardfrontimage', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"身份证反面照片\">\n          <a-input placeholder=\"请输入身份证反面照片\" v-decorator=\"['idcardbackimage', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"自动续费天数\">\n          <a-input-number v-decorator=\"[ 'autodays', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"是否大v  0否1是\">\n          <a-input-number v-decorator=\"[ 'bigvip', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"背景图\">\n          <a-input placeholder=\"请输入背景图\" v-decorator=\"['bgimage', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"昵称拼音\">\n          <a-input placeholder=\"请输入昵称拼音\" v-decorator=\"['nicknamespell', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"现居地址\">\n          <a-input placeholder=\"请输入现居地址\" v-decorator=\"['address', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"房间号\">\n          <a-input placeholder=\"请输入房间号\" v-decorator=\"['roomid', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"阿里账号\">\n          <a-input placeholder=\"请输入阿里账号\" v-decorator=\"['aliid', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"阿里名字\">\n          <a-input placeholder=\"请输入阿里名字\" v-decorator=\"['aliname', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"v云大使 0否1是\">\n          <a-input-number v-decorator=\"[ 'ambassador', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"ambassadorcredits\">\n          <a-input-number v-decorator=\"[ 'ambassadorcredits', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"V云大使二维码\">\n          <a-input placeholder=\"请输入V云大使二维码\" v-decorator=\"['ambassadorqrcode', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"所属城市id\">\n          <a-input-number v-decorator=\"[ 'cityid', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"是否城市搭理\">\n          <a-input-number v-decorator=\"[ 'cityagent', {}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"代理城市的id\">\n          <a-input-number v-decorator=\"[ 'agentcityid', {}]\" />\n        </a-form-item> -->\n\n      </a-form>\n    </a-spin>\n  </a-modal>\n</template>\n\n<script>\n  import Vue from 'vue'\n  import { httpAction } from '@/api/manage'\n  import { ACCESS_TOKEN } from \"@/store/mutation-types\"\n  import pick from 'lodash.pick'\n  import moment from \"moment\"\n  import * as qiniu from 'qiniu-js'\n\n  export default {\n    name: \"AppUserInfoModal\",\n    data () {\n      return {\n        title:\"操作\",\n        visible: false,\n        model: {},\n        labelCol: {\n          xs: { span: 24 },\n          sm: { span: 5 },\n        },\n        wrapperCol: {\n          xs: { span: 24 },\n          sm: { span: 16 },\n        },\n        loading: false,\n        confirmLoading: false,\n        disableSubmit: false,\n        coverimg: '',\n        canimg: '',\n        percent: '',\n        headers: {},\n        form: this.$form.createForm(this),\n        validatorRules:{\n        userid:{rules: [{ required: true, message: '请输入用户ID!' }]},\n        },\n        url: {\n          add: \"/user/appUserInfo/add\",\n          edit: \"/user/appUserInfo/edit\",\n          fileUpload: window._CONFIG['domianQiNiu'],\n          qiniuToken: '/qiniuUpToken'\n        },\n      }\n    },\n    created () {\n      const token = Vue.ls.get(ACCESS_TOKEN);\n      this.headers = {\"X-Access-Token\":token};\n    },\n    computed:{\n      uploadAction:function () {\n        return this.url.fileUpload;\n      }\n    },\n    methods: {\n      add () {\n        this.edit({});\n      },\n      edit (record) {\n        this.coverimg = record.header;\n        this.canimg = record.header;\n        this.form.resetFields();\n        this.model = Object.assign({}, record);\n        this.visible = true;\n        this.$nextTick(() => {\n          this.form.setFieldsValue(pick(this.model,'code','nickName','header','credits','phone','role','money','balance','createTime','startTime','ambassador','endTime'))\n          this.form.setFieldsValue({endTime:this.model.endTime?moment(this.model.endTime):null})\n          this.form.setFieldsValue({startTime:this.model.startTime?moment(this.model.startTime):null})\n          this.form.setFieldsValue({createTime:this.model.createTime?moment(this.model.createTime):null})\n        });\n\n      },\n      close () {\n        this.$emit('close');\n        this.visible = false;\n      },\n      handleOk () {\n        const that = this;\n        // 触发表单验证\n        this.form.validateFields((err, values) => {\n          if (!err) {\n            that.confirmLoading = true;\n            let httpurl = '';\n            let method = '';\n            if(!this.model.id){\n              httpurl+=this.url.add;\n              method = 'post';\n            }else{\n              httpurl+=this.url.edit;\n               method = 'put';\n            }\n            let formData = Object.assign(this.model, values);\n            //时间格式化\n            formData.endtime = formData.endtime?formData.endtime.format('YYYY-MM-DD'):null;\n            formData.sigendtime = formData.sigendtime?formData.sigendtime.format('YYYY-MM-DD'):null;\n\n            console.log(formData)\n            httpAction(httpurl,formData,method).then((res)=>{\n              if(res.success){\n                that.$message.success(res.message);\n                that.$emit('ok');\n              }else{\n                that.$message.warning(res.message);\n              }\n            }).finally(() => {\n              that.confirmLoading = false;\n              that.close();\n            })\n\n\n\n          }\n        })\n      },\n      handleCancel () {\n        this.close()\n      },\n      // 自定义上传\n      customRequest (data) {\n        const suffix = \".\" + data.file.name.replace(/^.+\\./, '')\n        //请求token\n        httpAction(this.url.qiniuToken, {}, 'post').then((res) => {\n          if (res) {\n            let token = res.data.token\n            const file = data.file\n            const key = new Date().getTime() + suffix;\n            let domain = this.url.fileUpload\n            let config = {\n              useCdnDomain: true,\n              region: null\n            }\n            let putExtra = {\n              fname: '',\n              params: {},\n              mimeType: null\n            }\n            let observable = qiniu.upload(file, key, token, putExtra, config);\n            observable.subscribe({\n              next: (res) => {\n                this.loading = true;\n                this.percent = res.total.percent.toFixed(2)\n                this.coverimg = '';\n              },\n              error: () => {\n                this.$message.error('上传失败')\n                this.loading = false;\n                this.coverimg = this.canimg\n              },\n              complete: (response) => {\n                this.coverimg = `${domain}/${response.key}`;\n                this.loading = false;\n              }\n            })\n          }\n        })\n      },\n\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped>\n\n</style>\n"]}]}