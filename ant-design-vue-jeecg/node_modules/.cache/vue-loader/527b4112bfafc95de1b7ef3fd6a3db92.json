{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\product\\modules\\ProductAuditMoadl.vue?vue&type=style&index=0&id=b9b915ee&lang=scss&scoped=true&","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\product\\modules\\ProductAuditMoadl.vue","mtime":1591672206234},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_css-loader@1.0.1@css-loader\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_postcss-loader@3.0.0@postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_sass-loader@7.3.1@sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.avatar-uploader > .ant-upload {\n  width: 128px;\n  height: 128px;\n}\n.ant-upload-select-picture-card i {\n  font-size: 32px;\n  color: #999;\n}\n\n.ant-upload-select-picture-card .ant-upload-text {\n  margin-top: 8px;\n  color: #666;\n}\n\n",{"version":3,"sources":["ProductAuditMoadl.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"ProductAuditMoadl.vue","sourceRoot":"src/views/product/modules","sourcesContent":["<template>\r\n  <a-modal\r\n    :title=\"title\"\r\n    :width=\"1200\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    @cancel=\"handleCancel\"\r\n    :footer=\"null\"\r\n    cancelText=\"关闭\"\r\n  >\r\n    \r\n    <a-spin :spinning=\"confirmLoading\">\r\n      <a-form :form=\"form\">\r\n        <a-row class=\"form-row\" :gutter=\"16\">\r\n          <a-col :lg=\"8\">\r\n            \r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程标题\">\r\n              <a-input placeholder=\"请输入课程标题\" v-decorator=\"['title', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程分类\">\r\n              <a-input placeholder=\"请输入课程分类\" v-decorator=\"['catename', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n    \r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程作者\">\r\n              <a-input placeholder=\"请输入课程作者\" v-decorator=\"['nickname', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n    \r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程专辑\">\r\n              <a-input placeholder=\"请输入课程专辑\" v-decorator=\"['albumname', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"审核状态\">\r\n              <a-select placeholder=\"请选择审核状态\" v-decorator=\"['auditstate', {}]\" disabled>\r\n                <a-select-option :value=\"1\">审核中</a-select-option>\r\n                <a-select-option :value=\"2\">审核不通过</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"是否收费\">\r\n              <a-select placeholder=\"请选择是否收费\" v-decorator=\"['type', {}]\" disabled>\r\n                <a-select-option :value=\"3\">收费</a-select-option>\r\n                <a-select-option :value=\"1\">免费</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\" v-if=\"thisType === 3\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程价格\">\r\n              <a-input placeholder=\"请输入课程价格\" v-decorator=\"['price', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"14\" v-show=\"thisType === 3\">\r\n            <a-form-item\r\n              :labelCol=\"labelColc\"\r\n              :wrapperCol=\"wrapperColc\"\r\n              label=\"课程简介\">\r\n              <a-input placeholder=\"请输入课程简介\" v-decorator=\"['introduction', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"24\" v-show=\"thisType === 1\">\r\n            <a-form-item\r\n              :labelCol=\"labelColk\"\r\n              :wrapperCol=\"wrapperColk\"\r\n              label=\"课程简介\">\r\n              <a-input placeholder=\"请输入课程简介\" v-decorator=\"['introduction', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"24\" v-show=\"disableSubmit\">\r\n            <a-form-item\r\n              :labelCol=\"labelColk\"\r\n              :wrapperCol=\"wrapperColk\"\r\n              label=\"课程详情\">\r\n              <div v-html=\"content\" style=\"border: 1px solid #ccc;padding: 20px;border-radius: 5px;\"></div>\r\n            </a-form-item>\r\n          </a-col>\r\n          \r\n        \r\n        </a-row>\r\n        <a-form-item label=\"课程封面\" :labelCol=\"labelColk\" :wrapperCol=\"wrapperColk\">\r\n          <a-upload\r\n            listType=\"picture-card\"\r\n            class=\"avatar-uploader\"\r\n            :showUploadList=\"false\"\r\n            :supportServerRender=\"true\"\r\n            :customRequest=\"customRequest\"\r\n            :disabled=\"disableSubmit\"\r\n          >\r\n            <img v-if=\"coverimg\" :src=\"coverimg\" alt=\"avatar\" style=\"max-width: 150px;\" />\r\n            <div v-else>\r\n              <a-icon :type=\"loading ? 'loading' : 'plus'\" />\r\n              <div class=\"ant-upload-text\" v-if=\"!loading\">Upload</div>\r\n              <div class=\"ant-upload-text\" v-if=\"loading\">{{ percent }}%</div>\r\n            </div>\r\n          </a-upload>\r\n        \r\n        </a-form-item>\r\n        \r\n        <a-form-item label=\"拒绝理由\" :labelCol=\"labelColk\" :wrapperCol=\"wrapperColk\" v-if=\"refusereason\">\r\n          <a-textarea v-model=\"refusereason\" :autosize=\"{ minRows: 3, maxRows: 8 }\" :readOnly=\"true\"/>\r\n        </a-form-item>\r\n      \r\n      </a-form>\r\n    </a-spin>\r\n    <avatar-modal ref=\"modal\"></avatar-modal>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import { getAction, httpAction } from '@/api/manage'\r\n  import pick from 'lodash.pick'\r\n  import JCodeEditor from \"@/components/jeecg/JCodeEditor\"\r\n  import JEditor from \"@/components/jeecg/JEditor\"\r\n  import AvatarModal from \"@/views/account/settings/AvatarModal\";\r\n  import * as qiniu from 'qiniu-js'\r\n\r\n  export default {\r\n    name: \"ProductAuditMoadl\",\r\n    data () {\r\n      return {\r\n        title:\"操作\",\r\n        visible: false,\r\n        model: {},\r\n        labelCol: {\r\n          xs: { span: 24 },\r\n          sm: { span: 5 },\r\n        },\r\n        wrapperCol: {\r\n          xs: { span: 24 },\r\n          sm: { span: 17 },\r\n        },\r\n        labelColc: {\r\n          xs: { span: 24 },\r\n          sm: { span: 3 },\r\n        },\r\n        wrapperColc: {\r\n          xs: { span: 24 },\r\n          sm: { span: 20 },\r\n        },\r\n        labelColk: {\r\n          xs: { span: 24 },\r\n          sm: { span: 2 },\r\n        },\r\n        wrapperColk: {\r\n          xs: { span: 24 },\r\n          sm: { span: 21 },\r\n        },\r\n        loading: false,\r\n        confirmLoading: false,\r\n        form: this.$form.createForm(this),\r\n        coverimg: '',\r\n        canimg: '',\r\n        percent: '',\r\n        refusereason: '',\r\n        disableSubmit: false,\r\n        content: '',\r\n        thisType: null,\r\n        headers: {},\r\n        selectList: [],\r\n        validatorRules:{\r\n        },\r\n        url: {\r\n          getbyId: '/product/productsource/findListByProductId',\r\n          fileUpload: window._CONFIG['domianQiNiu'],\r\n          qiniuToken: '/qiniuUpToken'\r\n        },\r\n      }\r\n    },\r\n    components: {\r\n      JCodeEditor,\r\n      JEditor,\r\n      AvatarModal\r\n    },\r\n    computed:{\r\n      uploadAction:function () {\r\n        return this.url.fileUpload;\r\n      }\r\n    },\r\n    methods: {\r\n      add () {\r\n        this.coverimg = '';\r\n        this.refusereason = '';\r\n        this.content = '';\r\n        this.edit({});\r\n      },\r\n      edit (record) {\r\n        console.log(record)\r\n        this.coverimg = record.coverimg;\r\n        this.form.resetFields();\r\n        this.getNewModel (record.id);\r\n        if (record.id) {\r\n          this.thisType = record.type;\r\n        }\r\n        this.model = Object.assign({}, record);\r\n        this.visible = true;\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(pick(this.model,'id','title','introduction','albumname','nickname','coverimg', 'auditstate','catename', 'type', 'price'))\r\n        });\r\n      },\r\n      // 根据id获取具体数据\r\n      getNewModel (id) {\r\n        let html = '';\r\n        const that = this;\r\n        getAction(this.url.getbyId,{productId: id, ischeck:1}).then((res) => {\r\n          if(res.success){\r\n            let record = res.result;\r\n            html += '<div style=\"max-height: 350px;overflow-y: scroll;\">';\r\n            record.forEach(item => {\r\n              switch (item.type) {\r\n                case 'img':\r\n                  html += `<p><img src=\"${item.url}\" style=\"width:300px;\" /><br/><span style=\"color: #ccc;\">${item.title}</span></p>`;\r\n                  break;\r\n                case 'text':\r\n                  html += `<p style=\"text-indent: 2em;\"><h3 style=\"text-align: center;\">${item.title}</h3>${item.url}</p>`;\r\n                  break;\r\n                case 'video':\r\n                  html += `<p><video controls=\"controls\" width=\"300\" height=\"150\"><source src=\"${item.url}\" /></video></p>`;\r\n                  break;\r\n                case 'audio':\r\n                  html += `<p><audio src=\"${item.url}\" controls=\"controls\"></audio></p>`;\r\n                  break;\r\n                default:\r\n                  break\r\n              }\r\n            });\r\n            html += '</div>';\r\n            this.content = html;\r\n             console.log('this.content')\r\n            console.log(this.content)\r\n          }else{\r\n            that.$message.warning(res.message);\r\n          }\r\n        })\r\n      },\r\n      close () {\r\n        this.$emit('close');\r\n        this.visible = false;\r\n        this.coverimg = '';\r\n        this.disableSubmit = false;\r\n        this.content = '';\r\n      },\r\n      handleCancel () {\r\n        this.close()\r\n      },\r\n      // 自定义上传\r\n      customRequest (data) {\r\n        const suffix = \".\" + data.file.name.replace(/^.+\\./, '')\r\n        //请求token\r\n        httpAction(this.url.qiniuToken, {}, 'post').then((res) => {\r\n          if (res) {\r\n            let token = res.data.token\r\n            const file = data.file\r\n            const key = new Date().getTime() + suffix;\r\n            let domain = this.url.fileUpload\r\n            let config = {\r\n              useCdnDomain: true,\r\n              region: null\r\n            }\r\n            let putExtra = {\r\n              fname: '',\r\n              params: {},\r\n              mimeType: null\r\n            }\r\n            let observable = qiniu.upload(file, key, token, putExtra, config);\r\n            observable.subscribe({\r\n              next: (res) => {\r\n                this.loading = true;\r\n                this.percent = res.total.percent.toFixed(2)\r\n                this.coverimg = '';\r\n              },\r\n              error: () => {\r\n                this.$message.error('上传失败')\r\n                this.loading = false;\r\n                this.coverimg = this.canimg\r\n              },\r\n              complete: (response) => {\r\n                this.coverimg = `${domain}/${response.key}`;\r\n                this.loading = false;\r\n              }\r\n            })\r\n          }\r\n        })\r\n      },\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  \r\n  .avatar-uploader > .ant-upload {\r\n    width: 128px;\r\n    height: 128px;\r\n  }\r\n  .ant-upload-select-picture-card i {\r\n    font-size: 32px;\r\n    color: #999;\r\n  }\r\n  \r\n  .ant-upload-select-picture-card .ant-upload-text {\r\n    margin-top: 8px;\r\n    color: #666;\r\n  }\r\n\r\n</style>\r\n"]}]}