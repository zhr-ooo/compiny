{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\system\\modules\\AssociatedModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\system\\modules\\AssociatedModal.vue","mtime":1590406424954},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_thread-loader@2.1.3@thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getAction } from \"@api/manage\";\n\nexport default {\n  name: \"AssociatedModal\",\n  data () {\n    return {\n      appUserId: null,\n      userId: null,\n      visible: false,\n      confirmLoading: false,\n      form: this.$form.createForm(this),\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 5 },\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 16 },\n      },\n      searchParam: '',    // 搜索字段\n      selectParam: '',    //  选中作者\n      dataSource: [],     // 选择数据源\n      url: {\n        searchUrl: '/system/appuserinfo/getUserBYPhoneOrCodeOrNickName',\n        // associUrl: '/sys/user/checkuser',\n        // updateId: '/sys/user/updateSysUserToAppUserId'\n      }\n      \n    }\n  },\n  methods: {\n    show () {\n      this.form.resetFields();\n      // this.userId = id;\n      this.visible = true\n    },\n    // 表单提交\n    handleOk () {\n      // 验证用户是否已进行了关联\n      this.form.validateFields((err) => {\n        if (!err) {\n          this.confirmLoading = true;\n          let seleData = {\n            authorName: this.selectParam,\n            author: this.appUserId\n          }\n          this.$emit('ok', seleData);\n\n          this.confirmLoading = false;\n          this.handleCancel();\n          // getAction(this.url.associUrl, { appUserId: this.appUserId }).then(res => {\n          //   if(res.success) {\n          //     getAction(this.url.updateId, { appUserId: this.appUserId, userId: this.userId }).then(res => {\n          //       if (res.success) {\n          //         this.$message.success(res.message);\n          //         this.$emit('ok');\n          //       }else{\n          //         this.$message.warning(res.message);\n          //       }\n          //     }).finally(() => {\n          //\n          //     })\n          //   } else {\n          //     this.$message.warning(res.message)\n          //   }\n          // }).catch(err => {\n          //   this.$message.warning(err.message)\n          // })\n        }\n      })\n    },\n    // modal取消\n    handleCancel () {\n      this.$emit('close');\n      this.dataSource = [];\n      this.searchParam = '';\n      this.visible = false;\n    },\n  //  输入选择框\n    onSelect (value) {\n      console.log(value)\n      this.dataSource.forEach(item => {\n        if (item.userId === Number(value)) {\n          this.selectParam = item.nickName;\n          this.appUserId = value\n        }\n      })\n    },\n    handleSearch(value) {\n      this.searchParam = value\n    },\n  //  开始搜索\n    beginSearch () {\n      getAction(this.url.searchUrl, {searchParam: this.searchParam}).then(res => {\n        console.log(res)\n        if (res.success) {\n          if (res.result.length === 0) {\n            this.$message.warning('暂无数据')\n          } else {\n            this.dataSource = res.result\n          }\n        } else {\n          this.$message.warning(res.message)\n        }\n      }).catch(err => {\n        this.$message.warning(err.message)\n      })\n    }    \n  }\n}\n",null]}