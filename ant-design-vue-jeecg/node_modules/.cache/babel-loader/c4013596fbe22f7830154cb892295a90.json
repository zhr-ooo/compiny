{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js??ref--0-0!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\team\\modules\\BigTeamModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\team\\modules\\BigTeamModal.vue","mtime":1591693622135},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { httpAction, getAction } from '@/api/manage';\nimport Vue from 'vue';\nimport { ACCESS_TOKEN } from \"@/store/mutation-types\";\nimport pick from 'lodash.pick';\nimport * as qiniu from 'qiniu-js';\nexport default {\n  name: \"BigTeamModal\",\n  data: function data() {\n    return {\n      title: \"操作\",\n      visible: false,\n      headers: {},\n      loading: false,\n      coverimg: '',\n      canimg: '',\n      percent: '',\n      disableSubmit: false,\n      autoSubmit: false,\n      teamName: '',\n      model: {},\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 5\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 16\n        }\n      },\n      searchParam: '',\n      // 搜索字段\n      dataSource: [],\n      // 选择数据源\n      userId: null,\n      confirmLoading: false,\n      form: this.$form.createForm(this),\n      validatorRules: {},\n      url: {\n        add: \"/system/bigteam/add\",\n        edit: \"/system/bigteam/edit\",\n        fileUpload: window._CONFIG['domianQiNiu'],\n        qiniuToken: '/qiniuUpToken',\n        searchUrl: '/system/appuserinfo/getUserBYPhoneOrCodeOrNickName'\n      }\n    };\n  },\n  computed: {\n    uploadAction: function uploadAction() {\n      return this.url.fileUpload;\n    }\n  },\n  created: function created() {\n    var token = Vue.ls.get(ACCESS_TOKEN);\n    this.headers = {\n      \"X-Access-Token\": token\n    };\n  },\n  methods: {\n    add: function add() {\n      this.coverimg = '';\n      this.teamName = '';\n      this.edit({});\n    },\n    edit: function edit(record) {\n      var _this = this;\n\n      console.log(record.name);\n\n      if (record && record.name && record.name !== '' && record.name !== undefined) {\n        this.autoSubmit = true;\n        console.log(this.autoSubmit);\n      } else {\n        this.autoSubmit = false;\n        console.log(this.autoSubmit);\n      }\n\n      this.teamName = record.userName;\n      this.coverimg = record.image;\n      this.canimg = record.image;\n      this.form.resetFields();\n      this.model = Object.assign({}, record);\n      this.visible = true;\n      this.$nextTick(function () {\n        _this.form.setFieldsValue(pick(_this.model, 'name', 'image', 'userId', 'userName', 'teamNum', 'descr'));\n      });\n    },\n    close: function close() {\n      this.$emit('close');\n      this.visible = false;\n      this.coverimg = '';\n      this.canimg = '';\n      this.percent = '';\n      this.dataSource = [];\n      this.searchParam = '';\n      this.disableSubmit = false;\n    },\n    handleOk: function handleOk() {\n      var _this2 = this;\n\n      var that = this; // 触发表单验证\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          that.confirmLoading = true;\n          var httpurl = '';\n          var method = '';\n\n          if (!_this2.model.id) {\n            httpurl += _this2.url.add;\n            method = 'post';\n          } else {\n            httpurl += _this2.url.edit;\n            method = 'put';\n          }\n\n          var formData = Object.assign(_this2.model, values);\n          console.log('formData');\n          console.log(formData);\n          formData.image = _this2.coverimg;\n          formData.userId = _this2.userId; //时间格式化\n\n          console.log(formData);\n          httpAction(httpurl, formData, method).then(function (res) {\n            if (res.success) {\n              that.$message.success(res.message);\n              that.$emit('ok');\n            } else {\n              that.$message.warning(res.message);\n            }\n          }).finally(function () {\n            that.confirmLoading = false;\n            that.close();\n          });\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.close();\n    },\n    // 自定义上传\n    customRequest: function customRequest(data) {\n      var _this3 = this;\n\n      var suffix = \".\" + data.file.name.replace(/^.+\\./, ''); //请求token\n\n      httpAction(this.url.qiniuToken, {}, 'post').then(function (res) {\n        if (res) {\n          var token = res.data.token;\n          var file = data.file;\n          var key = new Date().getTime() + suffix;\n          var domain = _this3.url.fileUpload;\n          var config = {\n            useCdnDomain: true,\n            region: null\n          };\n          var putExtra = {\n            fname: '',\n            params: {},\n            mimeType: null\n          };\n          var observable = qiniu.upload(file, key, token, putExtra, config);\n          observable.subscribe({\n            next: function next(res) {\n              _this3.loading = true;\n              _this3.percent = res.total.percent.toFixed(2);\n              _this3.coverimg = '';\n            },\n            error: function error() {\n              _this3.$message.error('上传失败');\n\n              _this3.loading = false;\n              _this3.coverimg = _this3.canimg;\n            },\n            complete: function complete(response) {\n              _this3.coverimg = \"\".concat(domain, \"/\").concat(response.key);\n              _this3.loading = false;\n            }\n          });\n        }\n      });\n    },\n    //  输入选择框\n    onSelect: function onSelect(value) {\n      var _this4 = this;\n\n      this.dataSource.forEach(function (item) {\n        if (item.nickName === value) {\n          _this4.userId = item.userId;\n          console.log('this.userId');\n          console.log(_this4.userId);\n        }\n      });\n    },\n    handleSearch: function handleSearch(value) {\n      console.log('search', value);\n      this.searchParam = value;\n    },\n    //  开始搜索\n    beginSearch: function beginSearch() {\n      var _this5 = this;\n\n      getAction(this.url.searchUrl, {\n        searchParam: this.searchParam\n      }).then(function (res) {\n        console.log(res);\n\n        if (res.success) {\n          if (res.result.length === 0) {\n            _this5.$message.warning('暂无数据');\n          } else {\n            _this5.dataSource = res.result;\n          }\n        } else {\n          _this5.$message.warning(res.message);\n        }\n      }).catch(function (err) {\n        _this5.$message.warning(err.message);\n      });\n    }\n  }\n};",{"version":3,"sources":["BigTeamModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <a-modal\n    :title=\"title\"\n    :width=\"800\"\n    :visible=\"visible\"\n    :confirmLoading=\"confirmLoading\"\n    @ok=\"handleOk\"\n    @cancel=\"handleCancel\"\n    cancelText=\"关闭\">\n    \n    <a-spin :spinning=\"confirmLoading\">\n      <a-form :form=\"form\">\n      \n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"大V团名\">\n          <a-input placeholder=\"请输入大V团名\" v-decorator=\"['name', {rules: [{required: true, message: '请输入大V团名'}]}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"图片\">\n          <a-upload\n            listType=\"picture-card\"\n            class=\"avatar-uploader\"\n            :showUploadList=\"false\"\n            :supportServerRender=\"true\"\n            :customRequest=\"customRequest\"\n            :disabled=\"disableSubmit\"\n            v-decorator=\"['image',{ rules: [{ required: true, message: '图片不能为空' }] }]\"\n          >\n            <img v-if=\"coverimg\" :src=\"coverimg\" alt=\"avatar\" style=\"max-width: 150px;\" />\n            <div v-else>\n              <a-icon :type=\"loading ? 'loading' : 'plus'\" />\n              <div class=\"ant-upload-text\" v-if=\"!loading\">Upload</div>\n              <div class=\"ant-upload-text\" v-if=\"loading\">{{ percent }}%</div>\n            </div>\n          </a-upload>\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"团长ID\">\n\t\t  <a-input v-if=\"autoSubmit\" placeholder=\"\" :disabled=\"autoSubmit\" :value=\"teamName\" />\n          <a-auto-complete\n\t\t\tv-else\n            class=\"global-search\"\n            @select=\"onSelect\"\n            @search=\"handleSearch\"\n            optionLabelProp=\"text\"\n            v-decorator=\"['userName',{ rules: [{ required: true, message: '请输入团长id' }] }]\"\n            placeholder=\"请输入团长id\"\n\t\t\t:disabled=\"autoSubmit\"\n          >\n            <template slot=\"dataSource\">\n              <a-select-option v-for=\"item in dataSource\" :key=\"item.nickName\" :text=\"item.nickName\" class=\"selece-option\">\n                <a-avatar :src=\"item.header\" :srcSet=\"item.header\" style=\"margin-right: 15px\"></a-avatar>\n                {{ item.nickName }}\n              </a-select-option>\n            </template>\n            <a-input class=\"associate_input\">\n              <a-button slot=\"suffix\" class=\"search-btn\" type=\"primary\" size=\"large\" @click=\"beginSearch\">\n                <a-icon type=\"search\"></a-icon>\n              </a-button>\n            </a-input>\n          </a-auto-complete>\n          \n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"团队人数\">\n          <a-input-number v-decorator=\"[ 'teamNum', {rules: [{ required: true, message: '团队人数不能为空' }]}]\" />\n        </a-form-item>\n        <a-form-item\n          :labelCol=\"labelCol\"\n          :wrapperCol=\"wrapperCol\"\n          label=\"大V团权益\">\n          <a-input placeholder=\"请输入大V团权益\" v-decorator=\"['descr', {}]\" />\n        </a-form-item>\n\t\t\n      </a-form>\n    </a-spin>\n  </a-modal>\n</template>\n\n<script>\n  import { httpAction, getAction} from '@/api/manage'\n  import Vue from 'vue'\n  import { ACCESS_TOKEN } from \"@/store/mutation-types\";\n  import pick from 'lodash.pick'\n  import * as qiniu from 'qiniu-js'\n\n  export default {\n    name: \"BigTeamModal\",\n    data () {\n      return {\n        title:\"操作\",\n        visible: false,\n        headers: {},\n        loading: false,\n        coverimg: '',\n        canimg: '',\n        percent: '',\n        disableSubmit: false,\n\t\tautoSubmit: false,\n\t\tteamName: '',\n        model: {},\n        labelCol: {\n          xs: { span: 24 },\n          sm: { span: 5 },\n        },\n        wrapperCol: {\n          xs: { span: 24 },\n          sm: { span: 16 },\n        },\n        searchParam: '',    // 搜索字段\n        dataSource: [],     // 选择数据源\n        userId: null,\n        confirmLoading: false,\n        form: this.$form.createForm(this),\n        validatorRules:{\n        },\n        url: {\n          add: \"/system/bigteam/add\",\n          edit: \"/system/bigteam/edit\",\n          fileUpload: window._CONFIG['domianQiNiu'],\n          qiniuToken: '/qiniuUpToken',\n          searchUrl: '/system/appuserinfo/getUserBYPhoneOrCodeOrNickName'\n        },\n      }\n    },\n    computed:{\n      uploadAction:function () {\n        return this.url.fileUpload;\n      }\n    },\n    created () {\n      const token = Vue.ls.get(ACCESS_TOKEN);\n      this.headers = {\"X-Access-Token\":token};\n    },\n    methods: {\n      add () {\n        this.coverimg = '';\n\t\tthis.teamName = '';\n        this.edit({});\n      },\n      edit (record) {\n        console.log(record.name)\n\t\tif(record && record.name && record.name !== '' && record.name !== undefined) {\n\t\t\tthis.autoSubmit = true;\n\t\t\tconsole.log(this.autoSubmit)\n\t\t} else {\n\t\t\tthis.autoSubmit = false;\n\t\t\tconsole.log(this.autoSubmit);\n\t\t}\n\t\tthis.teamName = record.userName\n        this.coverimg = record.image;\n        this.canimg = record.image;\n        this.form.resetFields();\n        this.model = Object.assign({}, record);\n        this.visible = true;\n        this.$nextTick(() => {\n          this.form.setFieldsValue(pick(this.model,'name','image','userId','userName','teamNum','descr'))\n        });\n\n      },\n      close () {\n        this.$emit('close');\n        this.visible = false;\n        this.coverimg = '';\n        this.canimg = '';\n        this.percent = '';\n        this.dataSource = [];\n        this.searchParam = '';\n        this.disableSubmit = false;\n      },\n      handleOk () {\n        const that = this;\n        // 触发表单验证\n        this.form.validateFields((err, values) => {\n          if (!err) {\n            that.confirmLoading = true;\n            let httpurl = '';\n            let method = '';\n            if(!this.model.id){\n              httpurl+=this.url.add;\n              method = 'post';\n            }else{\n              httpurl+=this.url.edit;\n               method = 'put';\n            }\n            let formData = Object.assign(this.model, values);\n               console.log('formData')\n          console.log(formData)\n            formData.image = this.coverimg;\n            formData.userId = this.userId;\n            //时间格式化\n            \n            console.log(formData)\n            httpAction(httpurl,formData,method).then((res)=>{\n              if(res.success){\n                that.$message.success(res.message);\n                that.$emit('ok');\n              }else{\n                that.$message.warning(res.message);\n              }\n            }).finally(() => {\n              that.confirmLoading = false;\n              that.close();\n            })\n\n\n\n          }\n        })\n      },\n      handleCancel () {\n        this.close()\n      },\n      // 自定义上传\n      customRequest (data) {\n        const suffix = \".\" + data.file.name.replace(/^.+\\./, '')\n        //请求token\n        httpAction(this.url.qiniuToken, {}, 'post').then((res) => {\n          if (res) {\n            let token = res.data.token\n            const file = data.file\n            const key = new Date().getTime() + suffix;\n            let domain = this.url.fileUpload\n            let config = {\n              useCdnDomain: true,\n              region: null\n            }\n            let putExtra = {\n              fname: '',\n              params: {},\n              mimeType: null\n            }\n            let observable = qiniu.upload(file, key, token, putExtra, config);\n            observable.subscribe({\n              next: (res) => {\n                this.loading = true;\n                this.percent = res.total.percent.toFixed(2)\n                this.coverimg = '';\n              },\n              error: () => {\n                this.$message.error('上传失败')\n                this.loading = false;\n                this.coverimg = this.canimg\n              },\n              complete: (response) => {\n                this.coverimg = `${domain}/${response.key}`;\n                this.loading = false;\n              }\n            })\n          }\n        })\n      },\n      //  输入选择框\n      onSelect (value) {\n        this.dataSource.forEach(item => {\n          if (item.nickName === value) {\n            this.userId = item.userId\n              console.log('this.userId')\n          console.log(this.userId)\n          }\n        })\n      },\n      handleSearch(value) {\n        console.log('search', value)\n        this.searchParam = value\n      },\n      //  开始搜索\n      beginSearch () {\n        getAction(this.url.searchUrl, {searchParam: this.searchParam}).then(res => {\n          console.log(res)\n          if (res.success) {\n            if (res.result.length === 0) {\n              this.$message.warning('暂无数据')\n            } else {\n              this.dataSource = res.result\n            }\n          } else {\n            this.$message.warning(res.message)\n          }\n        }).catch(err => {\n          this.$message.warning(err.message)\n        })\n      }\n    }\n  }\n</script>\n\n<style lang=\"less\">\n  .global-search .associate_input .ant-input-suffix {\n    right: 0 !important;\n  }\n  .global-search .ant-input-suffix .ant-btn-lg {\n    height: 32px;\n  }\n  .global-search .ant-input-affix-wrapper .ant-input:not(:last-child) {\n    padding: 0 50px 0 12px;\n  }\n  \n  .global-search.ant-select-auto-complete .ant-input-affix-wrapper .ant-input-suffix button {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n  }\n  .selece-option {\n    padding: 10px 10px;\n    display: flex;\n    align-items: center;\n  }\n</style>"],"sourceRoot":"src/views/team/modules"}]}