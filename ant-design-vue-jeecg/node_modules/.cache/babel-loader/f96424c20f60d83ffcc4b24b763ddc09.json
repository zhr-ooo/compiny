{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js??ref--13-0!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\utils\\authFilter.js","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\utils\\authFilter.js","mtime":1588673568147},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es7.array.includes\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport { USER_AUTH, SYS_BUTTON_AUTH } from \"@/store/mutation-types\";\nexport function disabledAuthFilter(code, formData) {\n  if (nodeDisabledAuth(code, formData)) {\n    return true;\n  } else {\n    return globalDisabledAuth(code);\n  }\n}\n\nfunction nodeDisabledAuth(code, formData) {\n  console.log(\"页面权限禁用--NODE--开始\");\n  var permissionList = [];\n\n  try {\n    var obj = formData; //console.log(\"页面权限禁用--NODE--开始\",obj);\n\n    if (obj) {\n      var bpmList = obj.permissionList;\n\n      var _iterator = _createForOfIteratorHelper(bpmList),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var bpm = _step.value;\n\n          if (bpm.type == '2') {\n            permissionList.push(bpm);\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  } catch (e) {//console.log(\"页面权限异常----\", e);\n  }\n\n  if (permissionList === null || permissionList === \"\" || permissionList === undefined || permissionList.length <= 0) {\n    return false;\n  }\n\n  var permissions = [];\n\n  for (var _i = 0, _permissionList = permissionList; _i < _permissionList.length; _i++) {\n    var item = _permissionList[_i];\n\n    if (item.type == '2') {\n      permissions.push(item.action);\n    }\n  } //console.log(\"页面权限----\"+code);\n\n\n  if (!permissions.includes(code)) {\n    return false;\n  } else {\n    var _iterator2 = _createForOfIteratorHelper(permissionList),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var item2 = _step2.value;\n\n        if (code === item2.action) {\n          console.log(\"页面权限禁用--NODE--生效\");\n          return true;\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n  }\n\n  return false;\n}\n\nfunction globalDisabledAuth(code) {\n  console.log(\"页面禁用权限--Global--开始\");\n  var permissionList = [];\n  var allPermissionList = []; //let authList = Vue.ls.get(USER_AUTH);\n\n  var authList = JSON.parse(sessionStorage.getItem(USER_AUTH) || \"[]\");\n\n  var _iterator3 = _createForOfIteratorHelper(authList),\n      _step3;\n\n  try {\n    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n      var auth = _step3.value;\n\n      if (auth.type == '2') {\n        permissionList.push(auth);\n      }\n    } //console.log(\"页面禁用权限--Global--\",sessionStorage.getItem(SYS_BUTTON_AUTH));\n\n  } catch (err) {\n    _iterator3.e(err);\n  } finally {\n    _iterator3.f();\n  }\n\n  var allAuthList = JSON.parse(sessionStorage.getItem(SYS_BUTTON_AUTH) || \"[]\");\n\n  var _iterator4 = _createForOfIteratorHelper(allAuthList),\n      _step4;\n\n  try {\n    for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n      var gauth = _step4.value;\n\n      if (gauth.type == '2') {\n        allPermissionList.push(gauth);\n      }\n    } //设置全局配置是否有命中\n\n  } catch (err) {\n    _iterator4.e(err);\n  } finally {\n    _iterator4.f();\n  }\n\n  var gFlag = false; //禁用命中\n\n  var invalidFlag = false; //无效命中\n\n  if (allPermissionList != null && allPermissionList != \"\" && allPermissionList != undefined && allPermissionList.length > 0) {\n    var _iterator5 = _createForOfIteratorHelper(allPermissionList),\n        _step5;\n\n    try {\n      for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n        var itemG = _step5.value;\n\n        if (code === itemG.action) {\n          if (itemG.status == '0') {\n            invalidFlag = true;\n            break;\n          } else {\n            gFlag = true;\n            break;\n          }\n        }\n      }\n    } catch (err) {\n      _iterator5.e(err);\n    } finally {\n      _iterator5.f();\n    }\n  }\n\n  if (invalidFlag) {\n    return false;\n  }\n\n  if (permissionList === null || permissionList === \"\" || permissionList === undefined || permissionList.length <= 0) {\n    return gFlag;\n  }\n\n  var permissions = [];\n\n  for (var _i2 = 0, _permissionList2 = permissionList; _i2 < _permissionList2.length; _i2++) {\n    var item = _permissionList2[_i2];\n\n    if (item.type == '2') {\n      permissions.push(item.action);\n    }\n  } //console.log(\"页面禁用权限----\"+code);\n\n\n  if (!permissions.includes(code)) {\n    return gFlag;\n  } else {\n    var _iterator6 = _createForOfIteratorHelper(permissionList),\n        _step6;\n\n    try {\n      for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n        var item2 = _step6.value;\n\n        if (code === item2.action) {\n          console.log(\"页面权限解除禁用--Global--生效\");\n          gFlag = false;\n        }\n      }\n    } catch (err) {\n      _iterator6.e(err);\n    } finally {\n      _iterator6.f();\n    }\n\n    return gFlag;\n  }\n}\n\nexport function colAuthFilter(columns, pre) {\n  var authList = getNoAuthCols(pre);\n  var cols = columns.filter(function (item) {\n    if (hasColoum(item, authList)) {\n      return true;\n    }\n\n    return false;\n  });\n  return cols;\n}\n\nfunction hasColoum(item, authList) {\n  if (authList.includes(item.dataIndex)) {\n    return false;\n  }\n\n  return true;\n} //权限无效时不做控制，有效时控制，只能控制 显示不显示\n//根据授权码前缀获取未授权的列信息\n\n\nfunction getNoAuthCols(pre) {\n  var permissionList = [];\n  var allPermissionList = []; //let authList = Vue.ls.get(USER_AUTH);\n\n  var authList = JSON.parse(sessionStorage.getItem(USER_AUTH) || \"[]\");\n\n  var _iterator7 = _createForOfIteratorHelper(authList),\n      _step7;\n\n  try {\n    for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n      var auth = _step7.value;\n\n      //显示策略，有效状态\n      if (auth.type == '1' && startWith(auth.action, pre)) {\n        permissionList.push(substrPre(auth.action, pre));\n      }\n    } //console.log(\"页面禁用权限--Global--\",sessionStorage.getItem(SYS_BUTTON_AUTH));\n\n  } catch (err) {\n    _iterator7.e(err);\n  } finally {\n    _iterator7.f();\n  }\n\n  var allAuthList = JSON.parse(sessionStorage.getItem(SYS_BUTTON_AUTH) || \"[]\");\n\n  var _iterator8 = _createForOfIteratorHelper(allAuthList),\n      _step8;\n\n  try {\n    for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n      var gauth = _step8.value;\n\n      //显示策略，有效状态\n      if (gauth.type == '1' && gauth.status == '1' && startWith(gauth.action, pre)) {\n        allPermissionList.push(substrPre(gauth.action, pre));\n      }\n    }\n  } catch (err) {\n    _iterator8.e(err);\n  } finally {\n    _iterator8.f();\n  }\n\n  var cols = allPermissionList.filter(function (item) {\n    if (permissionList.includes(item)) {\n      return false;\n    }\n\n    return true;\n  });\n  return cols;\n}\n\nfunction startWith(str, pre) {\n  if (pre == null || pre == \"\" || str == null || str == \"\" || str.length == 0 || pre.length > str.length) return false;\n  if (str.substr(0, pre.length) == pre) return true;else return false;\n}\n\nfunction substrPre(str, pre) {\n  return str.substr(pre.length);\n}",{"version":3,"sources":["E:/gitweb/vcloudsapce_web/ant-design-vue-jeecg/src/utils/authFilter.js"],"names":["USER_AUTH","SYS_BUTTON_AUTH","disabledAuthFilter","code","formData","nodeDisabledAuth","globalDisabledAuth","console","log","permissionList","obj","bpmList","bpm","type","push","e","undefined","length","permissions","item","action","includes","item2","allPermissionList","authList","JSON","parse","sessionStorage","getItem","auth","allAuthList","gauth","gFlag","invalidFlag","itemG","status","colAuthFilter","columns","pre","getNoAuthCols","cols","filter","hasColoum","dataIndex","startWith","substrPre","str","substr"],"mappings":"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","sourcesContent":["\nimport { USER_AUTH,SYS_BUTTON_AUTH } from \"@/store/mutation-types\"\n\nexport function disabledAuthFilter(code,formData) {\n  if(nodeDisabledAuth(code,formData)){\n    return true;\n  }else{\n    return globalDisabledAuth(code);\n  }\n}\n\nfunction nodeDisabledAuth(code,formData){\n  console.log(\"页面权限禁用--NODE--开始\");\n  var permissionList = [];\n  try {\n    var obj = formData;\n    //console.log(\"页面权限禁用--NODE--开始\",obj);\n    if (obj) {\n      let bpmList = obj.permissionList;\n      for (var bpm of bpmList) {\n        if(bpm.type == '2') {\n          permissionList.push(bpm);\n        }\n      }\n    }\n  } catch (e) {\n    //console.log(\"页面权限异常----\", e);\n  }\n  if (permissionList === null || permissionList === \"\" || permissionList === undefined||permissionList.length<=0) {\n    return false;\n  }\n  let permissions = [];\n  for (var item of permissionList) {\n    if(item.type == '2') {\n      permissions.push(item.action);\n    }\n  }\n  //console.log(\"页面权限----\"+code);\n  if (!permissions.includes(code)) {\n    return false;\n  }else{\n    for (var item2 of permissionList) {\n      if(code === item2.action){\n        console.log(\"页面权限禁用--NODE--生效\");\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction globalDisabledAuth(code){\n  console.log(\"页面禁用权限--Global--开始\");\n\n  var permissionList = [];\n  var allPermissionList = [];\n\n  //let authList = Vue.ls.get(USER_AUTH);\n  let authList = JSON.parse(sessionStorage.getItem(USER_AUTH) || \"[]\");\n  for (var auth of authList) {\n    if(auth.type == '2') {\n      permissionList.push(auth);\n    }\n  }\n  //console.log(\"页面禁用权限--Global--\",sessionStorage.getItem(SYS_BUTTON_AUTH));\n  let allAuthList = JSON.parse(sessionStorage.getItem(SYS_BUTTON_AUTH) || \"[]\");\n  for (var gauth of allAuthList) {\n    if(gauth.type == '2') {\n      allPermissionList.push(gauth);\n    }\n  }\n  //设置全局配置是否有命中\n  var  gFlag = false;//禁用命中\n  var invalidFlag = false;//无效命中\n  if(allPermissionList != null && allPermissionList != \"\" && allPermissionList != undefined && allPermissionList.length > 0){\n    for (var itemG of allPermissionList) {\n      if(code === itemG.action){\n        if(itemG.status == '0'){\n          invalidFlag = true;\n          break;\n        }else{\n          gFlag = true;\n          break;\n        }\n      }\n    }\n  }\n  if(invalidFlag){\n    return false;\n  }\n  if (permissionList === null || permissionList === \"\" || permissionList === undefined||permissionList.length<=0) {\n    return gFlag;\n  }\n  let permissions = [];\n  for (var item of permissionList) {\n    if(item.type == '2') {\n      permissions.push(item.action);\n    }\n  }\n  //console.log(\"页面禁用权限----\"+code);\n  if (!permissions.includes(code)) {\n    return gFlag;\n  }else{\n    for (var item2 of permissionList) {\n      if(code === item2.action){\n        console.log(\"页面权限解除禁用--Global--生效\");\n        gFlag = false;\n      }\n    }\n    return gFlag;\n  }\n}\n\n\n\nexport function colAuthFilter(columns,pre) {\n  var authList = getNoAuthCols(pre);\n  const cols = columns.filter(item => {\n    if (hasColoum(item,authList)) {\n      return true\n    }\n    return false\n  })\n  return cols\n}\n\nfunction hasColoum(item,authList){\n  if (authList.includes(item.dataIndex)) {\n    return false\n  }\n  return true\n}\n\n//权限无效时不做控制，有效时控制，只能控制 显示不显示\n//根据授权码前缀获取未授权的列信息\nfunction getNoAuthCols(pre){\n  var permissionList = [];\n  var allPermissionList = [];\n\n  //let authList = Vue.ls.get(USER_AUTH);\n  let authList = JSON.parse(sessionStorage.getItem(USER_AUTH) || \"[]\");\n  for (var auth of authList) {\n    //显示策略，有效状态\n    if(auth.type == '1'&&startWith(auth.action,pre)) {\n      permissionList.push(substrPre(auth.action,pre));\n    }\n  }\n  //console.log(\"页面禁用权限--Global--\",sessionStorage.getItem(SYS_BUTTON_AUTH));\n  let allAuthList = JSON.parse(sessionStorage.getItem(SYS_BUTTON_AUTH) || \"[]\");\n  for (var gauth of allAuthList) {\n    //显示策略，有效状态\n    if(gauth.type == '1'&&gauth.status == '1'&&startWith(gauth.action,pre)) {\n      allPermissionList.push(substrPre(gauth.action,pre));\n    }\n  }\n  const cols = allPermissionList.filter(item => {\n    if (permissionList.includes(item)) {\n      return false;\n    }\n    return true;\n  })\n  return cols;\n}\n\nfunction startWith(str,pre) {\n  if (pre == null || pre == \"\" || str==null|| str==\"\"|| str.length == 0 || pre.length > str.length)\n    return false;\n  if (str.substr(0, pre.length) == pre)\n    return true;\n  else\n    return false;\n}\n\nfunction substrPre(str,pre) {\n  return str.substr(pre.length);\n}"]}]}