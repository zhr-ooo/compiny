{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js??ref--13-0!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\utils\\plugin.js","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\utils\\plugin.js","mtime":1588673568152},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport _typeof from \"E:/gitweb/vcloudsapce_web/ant-design-vue-jeecg/node_modules/@babel/runtime/helpers/esm/typeof\";\nimport \"core-js/modules/es6.object.freeze\";\n\n/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.0.7 (2019-06-05)\n */\n(function () {\n  var image = function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function noop() {};\n\n    var constant = function constant(value) {\n      return function () {\n        return value;\n      };\n    };\n\n    var identity = function identity(x) {\n      return x;\n    };\n\n    var die = function die(msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n\n    var never = constant(false);\n    var always = constant(true);\n    var never$1 = never;\n    var always$1 = always;\n\n    var none = function none() {\n      return NONE;\n    };\n\n    var NONE = function () {\n      var eq = function eq(o) {\n        return o.isNone();\n      };\n\n      var call = function call(thunk) {\n        return thunk();\n      };\n\n      var id = function id(n) {\n        return n;\n      };\n\n      var noop = function noop() {};\n\n      var nul = function nul() {\n        return null;\n      };\n\n      var undef = function undef() {\n        return undefined;\n      };\n\n      var me = {\n        fold: function fold(n, s) {\n          return n();\n        },\n        is: never$1,\n        isSome: never$1,\n        isNone: always$1,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function getOrDie(msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: nul,\n        getOrUndefined: undef,\n        or: id,\n        orThunk: call,\n        map: none,\n        ap: none,\n        each: noop,\n        bind: none,\n        flatten: none,\n        exists: never$1,\n        forall: always$1,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function toArray() {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze) Object.freeze(me);\n      return me;\n    }();\n\n    var some = function some(a) {\n      var constant_a = function constant_a() {\n        return a;\n      };\n\n      var self = function self() {\n        return me;\n      };\n\n      var map = function map(f) {\n        return some(f(a));\n      };\n\n      var bind = function bind(f) {\n        return f(a);\n      };\n\n      var me = {\n        fold: function fold(n, s) {\n          return s(a);\n        },\n        is: function is(v) {\n          return a === v;\n        },\n        isSome: always$1,\n        isNone: never$1,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: map,\n        ap: function ap(optfab) {\n          return optfab.fold(none, function (fab) {\n            return some(fab(a));\n          });\n        },\n        each: function each(f) {\n          f(a);\n        },\n        bind: bind,\n        flatten: constant_a,\n        exists: bind,\n        forall: bind,\n        filter: function filter(f) {\n          return f(a) ? me : NONE;\n        },\n        equals: function equals(o) {\n          return o.is(a);\n        },\n        equals_: function equals_(o, elementEq) {\n          return o.fold(never$1, function (b) {\n            return elementEq(a, b);\n          });\n        },\n        toArray: function toArray() {\n          return [a];\n        },\n        toString: function toString() {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n\n    var from = function from(value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function typeOf(x) {\n      if (x === null) return 'null';\n\n      var t = _typeof(x);\n\n      if (t === 'object' && Array.prototype.isPrototypeOf(x)) return 'array';\n      if (t === 'object' && String.prototype.isPrototypeOf(x)) return 'string';\n      return t;\n    };\n\n    var isType = function isType(type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n    var slice = Array.prototype.slice;\n\n    var each = function each(xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i, xs);\n      }\n    };\n\n    var find = function find(xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n\n        if (pred(x, i, xs)) {\n          return Option.some(x);\n        }\n      }\n\n      return Option.none();\n    };\n\n    var push = Array.prototype.push;\n\n    var flatten = function flatten(xs) {\n      var r = [];\n\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!Array.prototype.isPrototypeOf(xs[i])) throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        push.apply(r, xs[i]);\n      }\n\n      return r;\n    };\n\n    var head = function head(xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return slice.call(x);\n    };\n\n    var _assign = function __assign() {\n      _assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n\n          for (var p in s) {\n            if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n          }\n        }\n\n        return t;\n      };\n\n      return _assign.apply(this, arguments);\n    };\n\n    var nu = function nu(baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n\n      var map = function map(f) {\n        return nu(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n\n      var get = function get(nCallback) {\n        if (isReady()) call(nCallback);else callbacks.push(nCallback);\n      };\n\n      var set = function set(x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n\n      var isReady = function isReady() {\n        return data.isSome();\n      };\n\n      var run = function run(cbs) {\n        each(cbs, call);\n      };\n\n      var call = function call(cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n\n    var pure = function pure(a) {\n      return nu(function (callback) {\n        callback(a);\n      });\n    };\n\n    var LazyValue = {\n      nu: nu,\n      pure: pure\n    };\n\n    var bounce = function bounce(f) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var me = this;\n        domGlobals.setTimeout(function () {\n          f.apply(me, args);\n        }, 0);\n      };\n    };\n\n    var nu$1 = function nu$1(baseFn) {\n      var get = function get(callback) {\n        baseFn(bounce(callback));\n      };\n\n      var map = function map(fab) {\n        return nu$1(function (callback) {\n          get(function (a) {\n            var value = fab(a);\n            callback(value);\n          });\n        });\n      };\n\n      var bind = function bind(aFutureB) {\n        return nu$1(function (callback) {\n          get(function (a) {\n            aFutureB(a).get(callback);\n          });\n        });\n      };\n\n      var anonBind = function anonBind(futureB) {\n        return nu$1(function (callback) {\n          get(function (a) {\n            futureB.get(callback);\n          });\n        });\n      };\n\n      var toLazy = function toLazy() {\n        return LazyValue.nu(get);\n      };\n\n      var toCached = function toCached() {\n        var cache = null;\n        return nu$1(function (callback) {\n          if (cache === null) {\n            cache = toLazy();\n          }\n\n          cache.get(callback);\n        });\n      };\n\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        get: get\n      };\n    };\n\n    var pure$1 = function pure$1(a) {\n      return nu$1(function (callback) {\n        callback(a);\n      });\n    };\n\n    var Future = {\n      nu: nu$1,\n      pure: pure$1\n    };\n\n    var value = function value(o) {\n      var is = function is(v) {\n        return o === v;\n      };\n\n      var or = function or(opt) {\n        return value(o);\n      };\n\n      var orThunk = function orThunk(f) {\n        return value(o);\n      };\n\n      var map = function map(f) {\n        return value(f(o));\n      };\n\n      var mapError = function mapError(f) {\n        return value(o);\n      };\n\n      var each = function each(f) {\n        f(o);\n      };\n\n      var bind = function bind(f) {\n        return f(o);\n      };\n\n      var fold = function fold(_, onValue) {\n        return onValue(o);\n      };\n\n      var exists = function exists(f) {\n        return f(o);\n      };\n\n      var forall = function forall(f) {\n        return f(o);\n      };\n\n      var toOption = function toOption() {\n        return Option.some(o);\n      };\n\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n\n    var error = function error(message) {\n      var getOrThunk = function getOrThunk(f) {\n        return f();\n      };\n\n      var getOrDie = function getOrDie() {\n        return die(String(message))();\n      };\n\n      var or = function or(opt) {\n        return opt;\n      };\n\n      var orThunk = function orThunk(f) {\n        return f();\n      };\n\n      var map = function map(f) {\n        return error(message);\n      };\n\n      var mapError = function mapError(f) {\n        return error(f(message));\n      };\n\n      var bind = function bind(f) {\n        return error(message);\n      };\n\n      var fold = function fold(onError, _) {\n        return onError(message);\n      };\n\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n\n    var fromOption = function fromOption(opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var wrap = function wrap(delegate) {\n      var toCached = function toCached() {\n        return wrap(delegate.toCached());\n      };\n\n      var bindFuture = function bindFuture(f) {\n        return wrap(delegate.bind(function (resA) {\n          return resA.fold(function (err) {\n            return Future.pure(Result.error(err));\n          }, function (a) {\n            return f(a);\n          });\n        }));\n      };\n\n      var bindResult = function bindResult(f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.bind(f);\n        }));\n      };\n\n      var mapResult = function mapResult(f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.map(f);\n        }));\n      };\n\n      var mapError = function mapError(f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.mapError(f);\n        }));\n      };\n\n      var foldResult = function foldResult(whenError, whenValue) {\n        return delegate.map(function (res) {\n          return res.fold(whenError, whenValue);\n        });\n      };\n\n      var withTimeout = function withTimeout(timeout, errorThunk) {\n        return wrap(Future.nu(function (callback) {\n          var timedOut = false;\n          var timer = domGlobals.setTimeout(function () {\n            timedOut = true;\n            callback(Result.error(errorThunk()));\n          }, timeout);\n          delegate.get(function (result) {\n            if (!timedOut) {\n              domGlobals.clearTimeout(timer);\n              callback(result);\n            }\n          });\n        }));\n      };\n\n      return _assign({}, delegate, {\n        toCached: toCached,\n        bindFuture: bindFuture,\n        bindResult: bindResult,\n        mapResult: mapResult,\n        mapError: mapError,\n        foldResult: foldResult,\n        withTimeout: withTimeout\n      });\n    };\n\n    var nu$2 = function nu$2(worker) {\n      return wrap(Future.nu(worker));\n    };\n\n    var value$1 = function value$1(value) {\n      return wrap(Future.pure(Result.value(value)));\n    };\n\n    var error$1 = function error$1(error) {\n      return wrap(Future.pure(Result.error(error)));\n    };\n\n    var fromResult = function fromResult(result) {\n      return wrap(Future.pure(result));\n    };\n\n    var fromFuture = function fromFuture(future) {\n      return wrap(future.map(Result.value));\n    };\n\n    var fromPromise = function fromPromise(promise) {\n      return nu$2(function (completer) {\n        promise.then(function (value) {\n          completer(Result.value(value));\n        }, function (error) {\n          completer(Result.error(error));\n        });\n      });\n    };\n\n    var FutureResult = {\n      nu: nu$2,\n      wrap: wrap,\n      pure: value$1,\n      value: value$1,\n      error: error$1,\n      fromResult: fromResult,\n      fromFuture: fromFuture,\n      fromPromise: fromPromise\n    };\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n    var shallow = function shallow(old, nu) {\n      return nu;\n    };\n\n    var deep = function deep(old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n\n    var baseMerge = function baseMerge(merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n\n        if (objects.length === 0) throw new Error('Can\\'t merge zero objects');\n        var ret = {};\n\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n\n          for (var key in curObject) {\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n\n        return ret;\n      };\n    };\n\n    var deepMerge = baseMerge(deep);\n    var merge = baseMerge(shallow);\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var path = function path(parts, scope) {\n      var o = scope !== undefined && scope !== null ? scope : Global;\n\n      for (var i = 0; i < parts.length && o !== undefined && o !== null; ++i) {\n        o = o[parts[i]];\n      }\n\n      return o;\n    };\n\n    var resolve = function resolve(p, scope) {\n      var parts = p.split('.');\n      return path(parts, scope);\n    };\n\n    var unsafe = function unsafe(name, scope) {\n      return resolve(name, scope);\n    };\n\n    var getOrDie = function getOrDie(name, scope) {\n      var actual = unsafe(name, scope);\n      if (actual === undefined || actual === null) throw name + ' not available on this browser';\n      return actual;\n    };\n\n    var Global$1 = {\n      getOrDie: getOrDie\n    };\n\n    var url = function url() {\n      return Global$1.getOrDie('URL');\n    };\n\n    var createObjectURL = function createObjectURL(blob) {\n      return url().createObjectURL(blob);\n    };\n\n    var revokeObjectURL = function revokeObjectURL(u) {\n      url().revokeObjectURL(u);\n    };\n\n    var URL = {\n      createObjectURL: createObjectURL,\n      revokeObjectURL: revokeObjectURL\n    };\n\n    var makeItems = function makeItems(info) {\n      var imageUrl = {\n        name: 'src',\n        type: 'urlinput',\n        filetype: 'image',\n        label: 'Source'\n      };\n      var imageList = info.imageList.map(function (items) {\n        return {\n          name: 'images',\n          type: 'selectbox',\n          label: 'Image list',\n          items: items\n        };\n      });\n      var imageDescription = {\n        name: 'alt',\n        type: 'input',\n        label: 'Image description'\n      };\n      var imageTitle = {\n        name: 'title',\n        type: 'input',\n        label: 'Image title'\n      };\n      var imageDimensions = {\n        name: 'dimensions',\n        type: 'sizeinput'\n      };\n      var classList = info.classList.map(function (items) {\n        return {\n          name: 'classes',\n          type: 'selectbox',\n          label: 'Class',\n          items: items\n        };\n      });\n      var caption = {\n        type: 'label',\n        label: 'Caption',\n        items: [{\n          type: 'checkbox',\n          name: 'caption',\n          label: 'Show caption'\n        }]\n      };\n      return flatten([[imageUrl], imageList.toArray(), info.hasDescription ? [imageDescription] : [], info.hasImageTitle ? [imageTitle] : [], info.hasDimensions ? [imageDimensions] : [], [{\n        type: 'grid',\n        columns: 2,\n        items: flatten([classList.toArray(), info.hasImageCaption ? [caption] : []])\n      }]]);\n    };\n\n    var makeTab = function makeTab(info) {\n      return {\n        title: 'General',\n        name: 'general',\n        items: makeItems(info)\n      };\n    };\n\n    var MainTab = {\n      makeTab: makeTab,\n      makeItems: makeItems\n    };\n\n    function FileReader() {\n      var f = Global$1.getOrDie('FileReader');\n      return new f();\n    }\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var hasDimensions = function hasDimensions(editor) {\n      return editor.getParam('image_dimensions', true, 'boolean');\n    };\n\n    var hasAdvTab = function hasAdvTab(editor) {\n      return editor.getParam('image_advtab', false, 'boolean');\n    };\n\n    var hasUploadTab = function hasUploadTab(editor) {\n      return editor.getParam('image_uploadtab', true, 'boolean');\n    };\n\n    var getPrependUrl = function getPrependUrl(editor) {\n      return editor.getParam('image_prepend_url', '', 'string');\n    };\n\n    var getClassList = function getClassList(editor) {\n      return editor.getParam('image_class_list');\n    };\n\n    var hasDescription = function hasDescription(editor) {\n      return editor.getParam('image_description', true, 'boolean');\n    };\n\n    var hasImageTitle = function hasImageTitle(editor) {\n      return editor.getParam('image_title', false, 'boolean');\n    };\n\n    var hasImageCaption = function hasImageCaption(editor) {\n      return editor.getParam('image_caption', false, 'boolean');\n    };\n\n    var getImageList = function getImageList(editor) {\n      return editor.getParam('image_list', false);\n    };\n\n    var hasUploadUrl = function hasUploadUrl(editor) {\n      return !!getUploadUrl(editor);\n    };\n\n    var hasUploadHandler = function hasUploadHandler(editor) {\n      return !!getUploadHandler(editor);\n    };\n\n    var getUploadUrl = function getUploadUrl(editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n\n    var getUploadHandler = function getUploadHandler(editor) {\n      return editor.getParam('images_upload_handler', undefined, 'function');\n    };\n\n    var getUploadBasePath = function getUploadBasePath(editor) {\n      return editor.getParam('images_upload_base_path', undefined, 'string');\n    };\n\n    var getUploadCredentials = function getUploadCredentials(editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n\n    var Settings = {\n      hasDimensions: hasDimensions,\n      hasUploadTab: hasUploadTab,\n      hasAdvTab: hasAdvTab,\n      getPrependUrl: getPrependUrl,\n      getClassList: getClassList,\n      hasDescription: hasDescription,\n      hasImageTitle: hasImageTitle,\n      hasImageCaption: hasImageCaption,\n      getImageList: getImageList,\n      hasUploadUrl: hasUploadUrl,\n      hasUploadHandler: hasUploadHandler,\n      getUploadUrl: getUploadUrl,\n      getUploadHandler: getUploadHandler,\n      getUploadBasePath: getUploadBasePath,\n      getUploadCredentials: getUploadCredentials\n    };\n\n    var parseIntAndGetMax = function parseIntAndGetMax(val1, val2) {\n      return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n    };\n\n    var parseIntAndGetMin = function parseIntAndGetMin(val1, val2) {\n      return Math.min(parseInt(val1, 10), parseInt(val2, 10));\n    };\n\n    var getImageSize = function getImageSize(url, callback) {\n      var img = domGlobals.document.createElement('img');\n\n      var done = function done(dimensions) {\n        if (img.parentNode) {\n          img.parentNode.removeChild(img);\n        }\n\n        callback(dimensions);\n      };\n\n      img.onload = function () {\n        var width = 0;\n        var height = 0;\n        var pwidth = parseIntAndGetMax(img.width, img.clientWidth);\n        var pheight = parseIntAndGetMax(img.height, img.clientHeight);\n        var bili = pwidth / pheight;\n\n        if (pwidth > 800) {\n          width = parseIntAndGetMin(pwidth, 500);\n          height = width / bili;\n        } else {\n          width = pwidth;\n          height = pheight;\n        }\n\n        var dimensions = {\n          width: width,\n          height: height\n        };\n        done(Result.value(dimensions));\n      };\n\n      img.onerror = function () {\n        done(Result.error('Failed to get image dimensions for: ' + url));\n      };\n\n      var style = img.style;\n      style.visibility = 'hidden';\n      style.position = 'fixed';\n      style.bottom = style.left = '0px';\n      style.width = style.height = 'auto';\n      domGlobals.document.body.appendChild(img);\n      img.src = url;\n    };\n\n    var removePixelSuffix = function removePixelSuffix(value) {\n      if (value) {\n        value = value.replace(/px$/, '');\n      }\n\n      return value;\n    };\n\n    var addPixelSuffix = function addPixelSuffix(value) {\n      if (value.length > 0 && /^[0-9]+$/.test(value)) {\n        value += 'px';\n      }\n\n      return value;\n    };\n\n    var mergeMargins = function mergeMargins(css) {\n      if (css.margin) {\n        var splitMargin = String(css.margin).split(' ');\n\n        switch (splitMargin.length) {\n          case 1:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[0];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n            css['margin-left'] = css['margin-left'] || splitMargin[0];\n            break;\n\n          case 2:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[1];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n            css['margin-left'] = css['margin-left'] || splitMargin[1];\n            break;\n\n          case 3:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[1];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n            css['margin-left'] = css['margin-left'] || splitMargin[1];\n            break;\n\n          case 4:\n            css['margin-top'] = css['margin-top'] || splitMargin[0];\n            css['margin-right'] = css['margin-right'] || splitMargin[1];\n            css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n            css['margin-left'] = css['margin-left'] || splitMargin[3];\n        }\n\n        delete css.margin;\n      }\n\n      return css;\n    };\n\n    var createImageList = function createImageList(editor, callback) {\n      var imageList = Settings.getImageList(editor);\n\n      if (typeof imageList === 'string') {\n        global$2.send({\n          url: imageList,\n          success: function success(text) {\n            callback(JSON.parse(text));\n          }\n        });\n      } else if (typeof imageList === 'function') {\n        imageList(callback);\n      } else {\n        callback(imageList);\n      }\n    };\n\n    var waitLoadImage = function waitLoadImage(editor, data, imgElm) {\n      var selectImage = function selectImage() {\n        imgElm.onload = imgElm.onerror = null;\n\n        if (editor.selection) {\n          editor.selection.select(imgElm);\n          editor.nodeChanged();\n        }\n      };\n\n      imgElm.onload = function () {\n        if (!data.width && !data.height && Settings.hasDimensions(editor)) {\n          editor.dom.setAttribs(imgElm, {\n            width: String(imgElm.clientWidth),\n            height: String(imgElm.clientHeight)\n          });\n        }\n\n        selectImage();\n      };\n\n      imgElm.onerror = selectImage;\n    };\n\n    var blobToDataUri = function blobToDataUri(blob) {\n      return new global$1(function (resolve, reject) {\n        var reader = FileReader();\n\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n\n        reader.onerror = function () {\n          reject(reader.error.message);\n        };\n\n        reader.readAsDataURL(blob);\n      });\n    };\n\n    var isPlaceholderImage = function isPlaceholderImage(imgElm) {\n      return imgElm.nodeName === 'IMG' && (imgElm.hasAttribute('data-mce-object') || imgElm.hasAttribute('data-mce-placeholder'));\n    };\n\n    var Utils = {\n      getImageSize: getImageSize,\n      removePixelSuffix: removePixelSuffix,\n      addPixelSuffix: addPixelSuffix,\n      mergeMargins: mergeMargins,\n      createImageList: createImageList,\n      waitLoadImage: waitLoadImage,\n      blobToDataUri: blobToDataUri,\n      isPlaceholderImage: isPlaceholderImage\n    };\n    var global$3 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n    var DOM = global$3.DOM;\n\n    var getHspace = function getHspace(image) {\n      if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n        return Utils.removePixelSuffix(image.style.marginLeft);\n      } else {\n        return '';\n      }\n    };\n\n    var getVspace = function getVspace(image) {\n      if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n        return Utils.removePixelSuffix(image.style.marginTop);\n      } else {\n        return '';\n      }\n    };\n\n    var getBorder = function getBorder(image) {\n      if (image.style.borderWidth) {\n        return Utils.removePixelSuffix(image.style.borderWidth);\n      } else {\n        return '';\n      }\n    };\n\n    var getAttrib = function getAttrib(image, name) {\n      if (image.hasAttribute(name)) {\n        return image.getAttribute(name);\n      } else {\n        return '';\n      }\n    };\n\n    var getStyle = function getStyle(image, name) {\n      return image.style[name] ? image.style[name] : '';\n    };\n\n    var hasCaption = function hasCaption(image) {\n      return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n    };\n\n    var setAttrib = function setAttrib(image, name, value) {\n      image.setAttribute(name, value);\n    };\n\n    var wrapInFigure = function wrapInFigure(image) {\n      var figureElm = DOM.create('figure', {\n        class: 'image'\n      });\n      DOM.insertAfter(figureElm, image);\n      figureElm.appendChild(image);\n      figureElm.appendChild(DOM.create('figcaption', {\n        contentEditable: 'true'\n      }, 'Caption'));\n      figureElm.contentEditable = 'false';\n    };\n\n    var removeFigure = function removeFigure(image) {\n      var figureElm = image.parentNode;\n      DOM.insertAfter(image, figureElm);\n      DOM.remove(figureElm);\n    };\n\n    var toggleCaption = function toggleCaption(image) {\n      if (hasCaption(image)) {\n        removeFigure(image);\n      } else {\n        wrapInFigure(image);\n      }\n    };\n\n    var normalizeStyle = function normalizeStyle(image, normalizeCss) {\n      var attrValue = image.getAttribute('style');\n      var value = normalizeCss(attrValue !== null ? attrValue : '');\n\n      if (value.length > 0) {\n        image.setAttribute('style', value);\n        image.setAttribute('data-mce-style', value);\n      } else {\n        image.removeAttribute('style');\n      }\n    };\n\n    var setSize = function setSize(name, normalizeCss) {\n      return function (image, name, value) {\n        if (image.style[name]) {\n          image.style[name] = Utils.addPixelSuffix(value);\n          normalizeStyle(image, normalizeCss);\n        } else {\n          setAttrib(image, name, value);\n        }\n      };\n    };\n\n    var getSize = function getSize(image, name) {\n      if (image.style[name]) {\n        return Utils.removePixelSuffix(image.style[name]);\n      } else {\n        return getAttrib(image, name);\n      }\n    };\n\n    var setHspace = function setHspace(image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginLeft = pxValue;\n      image.style.marginRight = pxValue;\n    };\n\n    var setVspace = function setVspace(image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginTop = pxValue;\n      image.style.marginBottom = pxValue;\n    };\n\n    var setBorder = function setBorder(image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.borderWidth = pxValue;\n    };\n\n    var setBorderStyle = function setBorderStyle(image, value) {\n      image.style.borderStyle = value;\n    };\n\n    var getBorderStyle = function getBorderStyle(image) {\n      return getStyle(image, 'borderStyle');\n    };\n\n    var isFigure = function isFigure(elm) {\n      return elm.nodeName === 'FIGURE';\n    };\n\n    var isImage = function isImage(elm) {\n      return elm.nodeName === 'IMG';\n    };\n\n    var defaultData = function defaultData() {\n      return {\n        src: '',\n        alt: '',\n        title: '',\n        width: '',\n        height: '',\n        class: '',\n        style: '',\n        caption: false,\n        hspace: '',\n        vspace: '',\n        border: '',\n        borderStyle: ''\n      };\n    };\n\n    var getStyleValue = function getStyleValue(normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      setAttrib(image, 'style', data.style);\n\n      if (getHspace(image) || data.hspace !== '') {\n        setHspace(image, data.hspace);\n      }\n\n      if (getVspace(image) || data.vspace !== '') {\n        setVspace(image, data.vspace);\n      }\n\n      if (getBorder(image) || data.border !== '') {\n        setBorder(image, data.border);\n      }\n\n      if (getBorderStyle(image) || data.borderStyle !== '') {\n        setBorderStyle(image, data.borderStyle);\n      }\n\n      return normalizeCss(image.getAttribute('style'));\n    };\n\n    var create = function create(normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      write(normalizeCss, merge(data, {\n        caption: false\n      }), image);\n      setAttrib(image, 'alt', data.alt);\n\n      if (data.caption) {\n        var figure = DOM.create('figure', {\n          class: 'image'\n        });\n        figure.appendChild(image);\n        figure.appendChild(DOM.create('figcaption', {\n          contentEditable: 'true'\n        }, 'Caption'));\n        figure.contentEditable = 'false';\n        return figure;\n      } else {\n        return image;\n      }\n    };\n\n    var read = function read(normalizeCss, image) {\n      return {\n        src: getAttrib(image, 'src'),\n        alt: getAttrib(image, 'alt'),\n        title: getAttrib(image, 'title'),\n        width: getSize(image, 'width'),\n        height: getSize(image, 'height'),\n        class: getAttrib(image, 'class'),\n        style: normalizeCss(getAttrib(image, 'style')),\n        caption: hasCaption(image),\n        hspace: getHspace(image),\n        vspace: getVspace(image),\n        border: getBorder(image),\n        borderStyle: getStyle(image, 'borderStyle')\n      };\n    };\n\n    var updateProp = function updateProp(image, oldData, newData, name, set) {\n      if (newData[name] !== oldData[name]) {\n        set(image, name, newData[name]);\n      }\n    };\n\n    var normalized = function normalized(set, normalizeCss) {\n      return function (image, name, value) {\n        set(image, value);\n        normalizeStyle(image, normalizeCss);\n      };\n    };\n\n    var write = function write(normalizeCss, newData, image) {\n      var oldData = read(normalizeCss, image);\n      updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n        return toggleCaption(image);\n      });\n      updateProp(image, oldData, newData, 'src', setAttrib);\n      updateProp(image, oldData, newData, 'alt', setAttrib);\n      updateProp(image, oldData, newData, 'title', setAttrib);\n      updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n      updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n      updateProp(image, oldData, newData, 'class', setAttrib);\n      updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n        return setAttrib(image, 'style', value);\n      }, normalizeCss));\n      updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n      updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n      updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n      updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n    };\n\n    var normalizeCss = function normalizeCss(editor, cssText) {\n      var css = editor.dom.styles.parse(cssText);\n      var mergedCss = Utils.mergeMargins(css);\n      var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n      return editor.dom.styles.serialize(compressed);\n    };\n\n    var getSelectedImage = function getSelectedImage(editor) {\n      var imgElm = editor.selection.getNode();\n      var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n\n      if (figureElm) {\n        return editor.dom.select('img', figureElm)[0];\n      }\n\n      if (imgElm && (imgElm.nodeName !== 'IMG' || Utils.isPlaceholderImage(imgElm))) {\n        return null;\n      }\n\n      return imgElm;\n    };\n\n    var splitTextBlock = function splitTextBlock(editor, figure) {\n      var dom = editor.dom;\n      var textBlock = dom.getParent(figure.parentNode, function (node) {\n        return editor.schema.getTextBlockElements()[node.nodeName];\n      }, editor.getBody());\n\n      if (textBlock) {\n        return dom.split(textBlock, figure);\n      } else {\n        return figure;\n      }\n    };\n\n    var readImageDataFromSelection = function readImageDataFromSelection(editor) {\n      var image = getSelectedImage(editor);\n      return image ? read(function (css) {\n        return normalizeCss(editor, css);\n      }, image) : defaultData();\n    };\n\n    var insertImageAtCaret = function insertImageAtCaret(editor, data) {\n      var elm = create(function (css) {\n        return normalizeCss(editor, css);\n      }, data);\n      editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n      editor.focus();\n      editor.selection.setContent(elm.outerHTML);\n      var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n      editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n\n      if (isFigure(insertedElm)) {\n        var figure = splitTextBlock(editor, insertedElm);\n        editor.selection.select(figure);\n      } else {\n        editor.selection.select(insertedElm);\n      }\n    };\n\n    var syncSrcAttr = function syncSrcAttr(editor, image) {\n      editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n    };\n\n    var deleteImage = function deleteImage(editor, image) {\n      if (image) {\n        var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n        editor.dom.remove(elm);\n        editor.focus();\n        editor.nodeChanged();\n\n        if (editor.dom.isEmpty(editor.getBody())) {\n          editor.setContent('');\n          editor.selection.setCursorLocation();\n        }\n      }\n    };\n\n    var writeImageDataToSelection = function writeImageDataToSelection(editor, data) {\n      var image = getSelectedImage(editor);\n      write(function (css) {\n        return normalizeCss(editor, css);\n      }, data, image);\n      syncSrcAttr(editor, image);\n\n      if (isFigure(image.parentNode)) {\n        var figure = image.parentNode;\n        splitTextBlock(editor, figure);\n        editor.selection.select(image.parentNode);\n      } else {\n        editor.selection.select(image);\n        Utils.waitLoadImage(editor, data, image);\n      }\n    };\n\n    var insertOrUpdateImage = function insertOrUpdateImage(editor, data) {\n      var image = getSelectedImage(editor);\n\n      if (image) {\n        if (data.src) {\n          writeImageDataToSelection(editor, data);\n        } else {\n          deleteImage(editor, image);\n        }\n      } else if (data.src) {\n        insertImageAtCaret(editor, data);\n      }\n    };\n\n    var findMap = function findMap(arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n\n        if (r.isSome()) {\n          return r;\n        }\n      }\n\n      return Option.none();\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getValue = function getValue(item) {\n      return isString(item.value) ? item.value : '';\n    };\n\n    var sanitizeList = function sanitizeList(list, extractValue) {\n      var out = [];\n      global$4.each(list, function (item) {\n        var text = isString(item.text) ? item.text : isString(item.title) ? item.title : '';\n\n        if (item.menu !== undefined) {\n          var items = sanitizeList(item.menu, extractValue);\n          out.push({\n            text: text,\n            items: items\n          });\n        } else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n\n    var sanitizer = function sanitizer(extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n\n      return function (list) {\n        if (list) {\n          return Option.from(list).map(function (list) {\n            return sanitizeList(list, extracter);\n          });\n        } else {\n          return Option.none();\n        }\n      };\n    };\n\n    var sanitize = function sanitize(list) {\n      return sanitizer(getValue)(list);\n    };\n\n    var isGroup = function isGroup(item) {\n      return Object.prototype.hasOwnProperty.call(item, 'items');\n    };\n\n    var findEntryDelegate = function findEntryDelegate(list, value) {\n      return findMap(list, function (item) {\n        if (isGroup(item)) {\n          return findEntryDelegate(item.items, value);\n        } else if (item.value === value) {\n          return Option.some(item);\n        } else {\n          return Option.none();\n        }\n      });\n    };\n\n    var findEntry = function findEntry(optList, value) {\n      return optList.bind(function (list) {\n        return findEntryDelegate(list, value);\n      });\n    };\n\n    var ListUtils = {\n      sanitizer: sanitizer,\n      sanitize: sanitize,\n      findEntry: findEntry\n    };\n\n    function XMLHttpRequest() {\n      var f = Global$1.getOrDie('XMLHttpRequest');\n      return new f();\n    }\n\n    var pathJoin = function pathJoin(path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n\n      return path2;\n    };\n\n    function Uploader(settings) {\n      var defaultHandler = function defaultHandler(blobInfo, success, failure, progress) {\n        var xhr, formData;\n        xhr = XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n\n        xhr.onload = function () {\n          var json;\n\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n\n          json = JSON.parse(xhr.responseText);\n\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n\n          success(pathJoin(settings.basePath, json.location));\n        };\n\n        formData = new domGlobals.FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n\n      var uploadBlob = function uploadBlob(blobInfo, handler) {\n        return new global$1(function (resolve, reject) {\n          try {\n            handler(blobInfo, resolve, reject, noop);\n          } catch (ex) {\n            reject(ex.message);\n          }\n        });\n      };\n\n      var isDefaultHandler = function isDefaultHandler(handler) {\n        return handler === defaultHandler;\n      };\n\n      var upload = function upload(blobInfo) {\n        return !settings.url && isDefaultHandler(settings.handler) ? global$1.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n      };\n\n      settings = global$4.extend({\n        credentials: false,\n        handler: defaultHandler\n      }, settings);\n      return {\n        upload: upload\n      };\n    }\n\n    var makeTab$1 = function makeTab$1(info) {\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: [{\n          type: 'input',\n          label: 'Style',\n          name: 'style'\n        }, {\n          type: 'grid',\n          columns: 2,\n          items: [{\n            type: 'input',\n            label: 'Vertical space',\n            name: 'vspace'\n          }, {\n            type: 'input',\n            label: 'Horizontal space',\n            name: 'hspace'\n          }, {\n            type: 'input',\n            label: 'Border width',\n            name: 'border'\n          }, {\n            type: 'selectbox',\n            name: 'borderstyle',\n            label: 'Border style',\n            items: [{\n              text: 'Select...',\n              value: ''\n            }, {\n              text: 'Solid',\n              value: 'solid'\n            }, {\n              text: 'Dotted',\n              value: 'dotted'\n            }, {\n              text: 'Dashed',\n              value: 'dashed'\n            }, {\n              text: 'Double',\n              value: 'double'\n            }, {\n              text: 'Groove',\n              value: 'groove'\n            }, {\n              text: 'Ridge',\n              value: 'ridge'\n            }, {\n              text: 'Inset',\n              value: 'inset'\n            }, {\n              text: 'Outset',\n              value: 'outset'\n            }, {\n              text: 'None',\n              value: 'none'\n            }, {\n              text: 'Hidden',\n              value: 'hidden'\n            }]\n          }]\n        }]\n      };\n    };\n\n    var AdvTab = {\n      makeTab: makeTab$1\n    };\n\n    var collect = function collect(editor) {\n      var urlListSanitizer = ListUtils.sanitizer(function (item) {\n        return editor.convertURL(item.value || item.url, 'src');\n      });\n      var futureImageList = Future.nu(function (completer) {\n        Utils.createImageList(editor, function (imageList) {\n          completer(urlListSanitizer(imageList).map(function (items) {\n            return flatten([[{\n              text: 'None',\n              value: ''\n            }], items]);\n          }));\n        });\n      });\n      var classList = ListUtils.sanitize(Settings.getClassList(editor));\n      var hasAdvTab = Settings.hasAdvTab(editor);\n      var hasUploadTab = Settings.hasUploadTab(editor);\n      var hasUploadUrl = Settings.hasUploadUrl(editor);\n      var hasUploadHandler = Settings.hasUploadHandler(editor);\n      var image = readImageDataFromSelection(editor);\n      var hasDescription = Settings.hasDescription(editor);\n      var hasImageTitle = Settings.hasImageTitle(editor);\n      var hasDimensions = Settings.hasDimensions(editor);\n      var hasImageCaption = Settings.hasImageCaption(editor);\n      var url = Settings.getUploadUrl(editor);\n      var basePath = Settings.getUploadBasePath(editor);\n      var credentials = Settings.getUploadCredentials(editor);\n      var handler = Settings.getUploadHandler(editor);\n      var prependURL = Option.some(Settings.getPrependUrl(editor)).filter(function (preUrl) {\n        return isString(preUrl) && preUrl.length > 0;\n      });\n      return futureImageList.map(function (imageList) {\n        return {\n          image: image,\n          imageList: imageList,\n          classList: classList,\n          hasAdvTab: hasAdvTab,\n          hasUploadTab: hasUploadTab,\n          hasUploadUrl: hasUploadUrl,\n          hasUploadHandler: hasUploadHandler,\n          hasDescription: hasDescription,\n          hasImageTitle: hasImageTitle,\n          hasDimensions: hasDimensions,\n          hasImageCaption: hasImageCaption,\n          url: url,\n          basePath: basePath,\n          credentials: credentials,\n          handler: handler,\n          prependURL: prependURL\n        };\n      });\n    };\n\n    var makeTab$2 = function makeTab$2(info) {\n      var items = [{\n        type: 'dropzone',\n        name: 'fileinput'\n      }];\n      return {\n        title: 'Upload',\n        name: 'upload',\n        items: items\n      };\n    };\n\n    var UploadTab = {\n      makeTab: makeTab$2\n    };\n\n    var createState = function createState(info) {\n      return {\n        prevImage: ListUtils.findEntry(info.imageList, info.image.src),\n        prevAlt: info.image.alt,\n        open: true\n      };\n    };\n\n    var fromImageData = function fromImageData(image) {\n      return {\n        src: {\n          value: image.src,\n          meta: {}\n        },\n        images: image.src,\n        alt: image.alt,\n        title: image.title,\n        dimensions: {\n          width: image.width,\n          height: image.height\n        },\n        classes: image.class,\n        caption: image.caption,\n        style: image.style,\n        vspace: image.vspace,\n        border: image.border,\n        hspace: image.hspace,\n        borderstyle: image.borderStyle,\n        fileinput: []\n      };\n    };\n\n    var toImageData = function toImageData(data) {\n      return {\n        src: data.src.value,\n        alt: data.alt,\n        title: data.title,\n        width: data.dimensions.width,\n        height: data.dimensions.height,\n        class: data.classes,\n        style: data.style,\n        caption: data.caption,\n        hspace: data.hspace,\n        vspace: data.vspace,\n        border: data.border,\n        borderStyle: data.borderstyle\n      };\n    };\n\n    var addPrependUrl2 = function addPrependUrl2(info, srcURL) {\n      if (!/^(?:[a-zA-Z]+:)?\\/\\//.test(srcURL)) {\n        return info.prependURL.bind(function (prependUrl) {\n          if (srcURL.substring(0, prependUrl.length) !== prependUrl) {\n            return Option.some(prependUrl + srcURL);\n          }\n\n          return Option.none();\n        });\n      }\n\n      return Option.none();\n    };\n\n    var addPrependUrl = function addPrependUrl(info, api) {\n      var data = api.getData();\n      addPrependUrl2(info, data.src.value).each(function (srcURL) {\n        api.setData({\n          src: {\n            value: srcURL,\n            meta: data.src.meta\n          }\n        });\n      });\n    };\n\n    var formFillFromMeta2 = function formFillFromMeta2(info, data, meta) {\n      if (info.hasDescription && isString(meta.alt)) {\n        data.alt = meta.alt;\n      }\n\n      if (info.hasImageTitle && isString(meta.title)) {\n        data.title = meta.title;\n      }\n\n      if (info.hasDimensions) {\n        if (isString(meta.width)) {\n          data.dimensions.width = meta.width;\n        }\n\n        if (isString(meta.height)) {\n          data.dimensions.height = meta.height;\n        }\n      }\n\n      if (isString(meta.class)) {\n        ListUtils.findEntry(info.classList, meta.class).each(function (entry) {\n          data.classes = entry.value;\n        });\n      }\n\n      if (info.hasImageCaption) {\n        if (isBoolean(meta.caption)) {\n          data.caption = meta.caption;\n        }\n      }\n\n      if (info.hasAdvTab) {\n        if (isString(meta.vspace)) {\n          data.vspace = meta.vspace;\n        }\n\n        if (isString(meta.border)) {\n          data.border = meta.border;\n        }\n\n        if (isString(meta.hspace)) {\n          data.hspace = meta.hspace;\n        }\n\n        if (isString(meta.borderstyle)) {\n          data.borderstyle = meta.borderstyle;\n        }\n      }\n    };\n\n    var formFillFromMeta = function formFillFromMeta(info, api) {\n      var data = api.getData();\n      var meta = data.src.meta;\n\n      if (meta !== undefined) {\n        var newData = deepMerge({}, data);\n        formFillFromMeta2(info, newData, meta);\n        api.setData(newData);\n      }\n    };\n\n    var calculateImageSize = function calculateImageSize(helpers, info, state, api) {\n      var data = api.getData();\n      var url = data.src.value;\n      var meta = data.src.meta || {};\n\n      if (!meta.width && !meta.height && info.hasDimensions) {\n        helpers.imageSize(url).get(function (result) {\n          result.each(function (size) {\n            if (state.open) {\n              api.setData({\n                dimensions: size\n              });\n            }\n          });\n        });\n      }\n    };\n\n    var updateImagesDropdown = function updateImagesDropdown(info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.src.value);\n      state.prevImage = image;\n      api.setData({\n        images: image.map(function (entry) {\n          return entry.value;\n        }).getOr('')\n      });\n    };\n\n    var changeSrc = function changeSrc(helpers, info, state, api) {\n      addPrependUrl(info, api);\n      formFillFromMeta(info, api);\n      calculateImageSize(helpers, info, state, api);\n      updateImagesDropdown(info, state, api);\n    };\n\n    var changeImages = function changeImages(helpers, info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.images);\n      image.each(function (img) {\n        var updateAlt = data.alt === '' || state.prevImage.map(function (image) {\n          return image.text === data.alt;\n        }).getOr(false);\n\n        if (updateAlt) {\n          if (img.value === '') {\n            api.setData({\n              src: img,\n              alt: state.prevAlt\n            });\n          } else {\n            api.setData({\n              src: img,\n              alt: img.text\n            });\n          }\n        } else {\n          api.setData({\n            src: img\n          });\n        }\n      });\n      state.prevImage = image;\n      changeSrc(helpers, info, state, api);\n    };\n\n    var calcVSpace = function calcVSpace(css) {\n      var matchingTopBottom = css['margin-top'] && css['margin-bottom'] && css['margin-top'] === css['margin-bottom'];\n      return matchingTopBottom ? Utils.removePixelSuffix(String(css['margin-top'])) : '';\n    };\n\n    var calcHSpace = function calcHSpace(css) {\n      var matchingLeftRight = css['margin-right'] && css['margin-left'] && css['margin-right'] === css['margin-left'];\n      return matchingLeftRight ? Utils.removePixelSuffix(String(css['margin-right'])) : '';\n    };\n\n    var calcBorderWidth = function calcBorderWidth(css) {\n      return css['border-width'] ? Utils.removePixelSuffix(String(css['border-width'])) : '';\n    };\n\n    var calcBorderStyle = function calcBorderStyle(css) {\n      return css['border-style'] ? String(css['border-style']) : '';\n    };\n\n    var calcStyle = function calcStyle(parseStyle, serializeStyle, css) {\n      return serializeStyle(parseStyle(serializeStyle(css)));\n    };\n\n    var changeStyle2 = function changeStyle2(parseStyle, serializeStyle, data) {\n      var css = Utils.mergeMargins(parseStyle(data.style));\n      var dataCopy = deepMerge({}, data);\n      dataCopy.vspace = calcVSpace(css);\n      dataCopy.hspace = calcHSpace(css);\n      dataCopy.border = calcBorderWidth(css);\n      dataCopy.borderstyle = calcBorderStyle(css);\n      dataCopy.style = calcStyle(parseStyle, serializeStyle, css);\n      return dataCopy;\n    };\n\n    var changeStyle = function changeStyle(helpers, api) {\n      var data = api.getData();\n      var newData = changeStyle2(helpers.parseStyle, helpers.serializeStyle, data);\n      api.setData(newData);\n    };\n\n    var changeAStyle = function changeAStyle(helpers, info, api) {\n      var data = deepMerge(fromImageData(info.image), api.getData());\n      var style = getStyleValue(helpers.normalizeCss, toImageData(data));\n      api.setData({\n        style: style\n      });\n    };\n\n    var changeFileInput = function changeFileInput(helpers, info, state, api) {\n      var data = api.getData();\n      api.block('Uploading image');\n      head(data.fileinput).fold(function () {\n        api.unblock();\n      }, function (file) {\n        var blobUri = URL.createObjectURL(file);\n        var uploader = Uploader({\n          url: info.url,\n          basePath: info.basePath,\n          credentials: info.credentials,\n          handler: info.handler\n        });\n\n        var finalize = function finalize() {\n          api.unblock();\n          URL.revokeObjectURL(blobUri);\n        };\n\n        Utils.blobToDataUri(file).then(function (dataUrl) {\n          var blobInfo = helpers.createBlobCache(file, blobUri, dataUrl);\n          uploader.upload(blobInfo).then(function (url) {\n            api.setData({\n              src: {\n                value: url,\n                meta: {}\n              }\n            });\n            api.showTab('general');\n            changeSrc(helpers, info, state, api);\n            finalize();\n          }).catch(function (err) {\n            finalize();\n            helpers.alertErr(api, err);\n          });\n        });\n      });\n    };\n\n    var changeHandler = function changeHandler(helpers, info, state) {\n      return function (api, evt) {\n        if (evt.name === 'src') {\n          changeSrc(helpers, info, state, api);\n        } else if (evt.name === 'images') {\n          changeImages(helpers, info, state, api);\n        } else if (evt.name === 'alt') {\n          state.prevAlt = api.getData().alt;\n        } else if (evt.name === 'style') {\n          changeStyle(helpers, api);\n        } else if (evt.name === 'vspace' || evt.name === 'hspace' || evt.name === 'border' || evt.name === 'borderstyle') {\n          changeAStyle(helpers, info, api);\n        } else if (evt.name === 'fileinput') {\n          changeFileInput(helpers, info, state, api);\n        }\n      };\n    };\n\n    var closeHandler = function closeHandler(state) {\n      return function () {\n        state.open = false;\n      };\n    };\n\n    var makeDialogBody = function makeDialogBody(info) {\n      if (info.hasAdvTab || info.hasUploadUrl || info.hasUploadHandler) {\n        var tabPanel = {\n          type: 'tabpanel',\n          tabs: flatten([[MainTab.makeTab(info)], info.hasAdvTab ? [AdvTab.makeTab(info)] : [], info.hasUploadTab && (info.hasUploadUrl || info.hasUploadHandler) ? [UploadTab.makeTab(info)] : []])\n        };\n        return tabPanel;\n      } else {\n        var panel = {\n          type: 'panel',\n          items: MainTab.makeItems(info)\n        };\n        return panel;\n      }\n    };\n\n    var makeDialog = function makeDialog(helpers) {\n      return function (info) {\n        var state = createState(info);\n        return {\n          title: 'Insert/Edit Image',\n          size: 'normal',\n          body: makeDialogBody(info),\n          buttons: [{\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          }, {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }],\n          initialData: fromImageData(info.image),\n          onSubmit: helpers.onSubmit(info),\n          onChange: changeHandler(helpers, info, state),\n          onClose: closeHandler(state)\n        };\n      };\n    };\n\n    var submitHandler = function submitHandler(editor) {\n      return function (info) {\n        return function (api) {\n          var data = deepMerge(fromImageData(info.image), api.getData());\n          editor.undoManager.transact(function () {\n            insertOrUpdateImage(editor, toImageData(data));\n          });\n          editor.editorUpload.uploadImagesAuto();\n          api.close();\n        };\n      };\n    };\n\n    var imageSize = function imageSize(editor) {\n      return function (url) {\n        return FutureResult.nu(function (completer) {\n          Utils.getImageSize(editor.documentBaseURI.toAbsolute(url), function (data) {\n            var result = data.map(function (dimensions) {\n              return {\n                width: String(dimensions.width),\n                height: String(dimensions.height)\n              };\n            });\n            completer(result);\n          });\n        });\n      };\n    };\n\n    var createBlobCache = function createBlobCache(editor) {\n      return function (file, blobUri, dataUrl) {\n        return editor.editorUpload.blobCache.create({\n          blob: file,\n          blobUri: blobUri,\n          name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n          base64: dataUrl.split(',')[1]\n        });\n      };\n    };\n\n    var alertErr = function alertErr(editor) {\n      return function (api, message) {\n        editor.windowManager.alert(message, api.close);\n      };\n    };\n\n    var normalizeCss$1 = function normalizeCss$1(editor) {\n      return function (cssText) {\n        return normalizeCss(editor, cssText);\n      };\n    };\n\n    var parseStyle = function parseStyle(editor) {\n      return function (cssText) {\n        return editor.dom.parseStyle(cssText);\n      };\n    };\n\n    var serializeStyle = function serializeStyle(editor) {\n      return function (stylesArg, name) {\n        return editor.dom.serializeStyle(stylesArg, name);\n      };\n    };\n\n    var Dialog = function Dialog(editor) {\n      var helpers = {\n        onSubmit: submitHandler(editor),\n        imageSize: imageSize(editor),\n        createBlobCache: createBlobCache(editor),\n        alertErr: alertErr(editor),\n        normalizeCss: normalizeCss$1(editor),\n        parseStyle: parseStyle(editor),\n        serializeStyle: serializeStyle(editor)\n      };\n\n      var open = function open() {\n        return collect(editor).map(makeDialog(helpers)).get(function (spec) {\n          editor.windowManager.open(spec);\n        });\n      };\n\n      return {\n        open: open\n      };\n    };\n\n    var register = function register(editor) {\n      editor.addCommand('mceImage', Dialog(editor).open);\n    };\n\n    var Commands = {\n      register: register\n    };\n\n    var hasImageClass = function hasImageClass(node) {\n      var className = node.attr('class');\n      return className && /\\bimage\\b/.test(className);\n    };\n\n    var toggleContentEditableState = function toggleContentEditableState(state) {\n      return function (nodes) {\n        var i = nodes.length;\n\n        var toggleContentEditable = function toggleContentEditable(node) {\n          node.attr('contenteditable', state ? 'true' : null);\n        };\n\n        while (i--) {\n          var node = nodes[i];\n\n          if (hasImageClass(node)) {\n            node.attr('contenteditable', state ? 'false' : null);\n            global$4.each(node.getAll('figcaption'), toggleContentEditable);\n          }\n        }\n      };\n    };\n\n    var setup = function setup(editor) {\n      editor.on('PreInit', function () {\n        editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n        editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n      });\n    };\n\n    var FilterContent = {\n      setup: setup\n    };\n\n    var fromHtml = function fromHtml(html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n\n      return fromDom(div.childNodes[0]);\n    };\n\n    var fromTag = function fromTag(tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n\n    var fromText = function fromText(text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n\n    var fromDom = function fromDom(node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n\n      return {\n        dom: constant(node)\n      };\n    };\n\n    var fromPoint = function fromPoint(docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var name = function name(element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n\n    var Immutable = function Immutable() {\n      var fields = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n\n      return function () {\n        var values = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var node = function node() {\n      var f = Global$1.getOrDie('Node');\n      return f;\n    };\n\n    var compareDocumentPosition = function compareDocumentPosition(a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n\n    var documentPositionPreceding = function documentPositionPreceding(a, b) {\n      return compareDocumentPosition(a, b, node().DOCUMENT_POSITION_PRECEDING);\n    };\n\n    var documentPositionContainedBy = function documentPositionContainedBy(a, b) {\n      return compareDocumentPosition(a, b, node().DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var cached = function cached(f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n\n        return r;\n      };\n    };\n\n    var firstMatch = function firstMatch(regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) return x;\n      }\n\n      return undefined;\n    };\n\n    var find$1 = function find$1(regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) return {\n        major: 0,\n        minor: 0\n      };\n\n      var group = function group(i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n\n      return nu$3(group(1), group(2));\n    };\n\n    var detect = function detect(versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) return unknown();\n      return find$1(versionRegexes, cleanedAgent);\n    };\n\n    var unknown = function unknown() {\n      return nu$3(0, 0);\n    };\n\n    var nu$3 = function nu$3(major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n\n    var Version = {\n      nu: nu$3,\n      detect: detect,\n      unknown: unknown\n    };\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n\n    var isBrowser = function isBrowser(name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    var unknown$1 = function unknown$1() {\n      return nu$4({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n\n    var nu$4 = function nu$4(info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$4,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n\n    var isOS = function isOS(name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    var unknown$2 = function unknown$2() {\n      return nu$5({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n\n    var nu$5 = function nu$5(info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$5,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function DeviceType(os, browser, userAgent) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isAndroid3 = os.isAndroid() && os.version.major === 3;\n      var isAndroid4 = os.isAndroid() && os.version.major === 4;\n      var isTablet = isiPad || isAndroid3 || isAndroid4 && /mobile/i.test(userAgent) === true;\n      var isTouch = os.isiOS() || os.isAndroid();\n      var isPhone = isTouch && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview)\n      };\n    };\n\n    var detect$1 = function detect$1(candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n\n    var detectBrowser = function detectBrowser(browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n\n    var detectOs = function detectOs(oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var contains = function contains(str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n    var checkContains = function checkContains(target) {\n      return function (uastring) {\n        return contains(uastring, target);\n      };\n    };\n\n    var browsers = [{\n      name: 'Edge',\n      versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n      search: function search(uastring) {\n        var monstrosity = contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n        return monstrosity;\n      }\n    }, {\n      name: 'Chrome',\n      versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n      search: function search(uastring) {\n        return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n      }\n    }, {\n      name: 'IE',\n      versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n      search: function search(uastring) {\n        return contains(uastring, 'msie') || contains(uastring, 'trident');\n      }\n    }, {\n      name: 'Opera',\n      versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n      search: checkContains('opera')\n    }, {\n      name: 'Firefox',\n      versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n      search: checkContains('firefox')\n    }, {\n      name: 'Safari',\n      versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n      search: function search(uastring) {\n        return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n      }\n    }];\n    var oses = [{\n      name: 'Windows',\n      search: checkContains('win'),\n      versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n    }, {\n      name: 'iOS',\n      search: function search(uastring) {\n        return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n      },\n      versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n    }, {\n      name: 'Android',\n      search: checkContains('android'),\n      versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n    }, {\n      name: 'OSX',\n      search: checkContains('os x'),\n      versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n    }, {\n      name: 'Linux',\n      search: checkContains('linux'),\n      versionRegexes: []\n    }, {\n      name: 'Solaris',\n      search: checkContains('sunos'),\n      versionRegexes: []\n    }, {\n      name: 'FreeBSD',\n      search: checkContains('freebsd'),\n      versionRegexes: []\n    }];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function detect$2(userAgent) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n\n    var PlatformDetection = {\n      detect: detect$2\n    };\n    var detect$3 = cached(function () {\n      var userAgent = domGlobals.navigator.userAgent;\n      return PlatformDetection.detect(userAgent);\n    });\n    var PlatformDetection$1 = {\n      detect: detect$3\n    };\n\n    var regularContains = function regularContains(e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n\n    var ieContains = function ieContains(e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n\n    var browser = PlatformDetection$1.detect().browser;\n    var contains$1 = browser.isIE() ? ieContains : regularContains;\n\n    var parent = function parent(element) {\n      var dom = element.dom();\n      return Option.from(dom.parentNode).map(Element.fromDom);\n    };\n\n    var spot = Immutable('element', 'offset');\n\n    var getRootElement = function getRootElement(elm) {\n      return parent(elm).filter(function (parentElm) {\n        return name(parentElm) === 'figure';\n      }).getOr(elm);\n    };\n\n    var register$1 = function register$1(editor) {\n      var makeContextMenuItem = function makeContextMenuItem(node) {\n        return {\n          text: 'Image',\n          icon: 'image',\n          onAction: function onAction() {\n            var rootElm = getRootElement(Element.fromDom(node));\n            editor.selection.select(rootElm.dom());\n            Dialog(editor).open();\n          }\n        };\n      };\n\n      editor.ui.registry.addToggleButton('image', {\n        icon: 'image',\n        tooltip: 'Insert/edit image',\n        onAction: Dialog(editor).open,\n        onSetup: function onSetup(buttonApi) {\n          return editor.selection.selectorChangedWithUnbind('img:not([data-mce-object],[data-mce-placeholder]),figure.image', buttonApi.setActive).unbind;\n        }\n      });\n      editor.ui.registry.addMenuItem('image', {\n        icon: 'image',\n        text: 'Image...',\n        onAction: Dialog(editor).open\n      });\n      editor.ui.registry.addContextMenu('image', {\n        update: function update(element) {\n          return isFigure(element) || isImage(element) && !Utils.isPlaceholderImage(element) ? [makeContextMenuItem(element)] : [];\n        }\n      });\n    };\n\n    var Buttons = {\n      register: register$1\n    };\n    global.add('image', function (editor) {\n      FilterContent.setup(editor);\n      Buttons.register(editor);\n      Commands.register(editor);\n    });\n\n    function Plugin() {}\n\n    return Plugin;\n  }(window);\n})();",{"version":3,"sources":["E:/gitweb/vcloudsapce_web/ant-design-vue-jeecg/src/utils/plugin.js"],"names":["image","domGlobals","global","tinymce","util","Tools","resolve","noop","constant","value","identity","x","die","msg","Error","never","always","never$1","always$1","none","NONE","eq","o","isNone","call","thunk","id","n","nul","undef","undefined","me","fold","s","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","or","orThunk","map","ap","each","bind","flatten","exists","forall","filter","equals","equals_","toArray","toString","Object","freeze","some","a","constant_a","self","f","v","optfab","fab","elementEq","b","from","Option","typeOf","t","Array","prototype","isPrototypeOf","String","isType","type","isString","isObject","isBoolean","isFunction","slice","xs","i","len","length","find","pred","push","r","apply","head","from$1","__assign","assign","arguments","p","hasOwnProperty","nu","baseFn","data","callbacks","nCallback","get","isReady","set","run","cbs","cb","setTimeout","pure","callback","LazyValue","bounce","args","_i","nu$1","aFutureB","anonBind","futureB","toLazy","toCached","cache","pure$1","Future","opt","mapError","_","onValue","toOption","isValue","isError","error","message","onError","fromOption","err","Result","wrap","delegate","bindFuture","resA","bindResult","mapResult","foldResult","whenError","whenValue","res","withTimeout","timeout","errorThunk","timedOut","timer","result","clearTimeout","nu$2","worker","value$1","error$1","fromResult","fromFuture","future","fromPromise","promise","completer","then","FutureResult","shallow","old","deep","bothObjects","deepMerge","baseMerge","merger","objects","ret","j","curObject","key","merge","Global","window","Function","path","parts","scope","split","unsafe","name","actual","Global$1","url","createObjectURL","blob","revokeObjectURL","u","URL","makeItems","info","imageUrl","filetype","label","imageList","items","imageDescription","imageTitle","imageDimensions","classList","caption","hasDescription","hasImageTitle","hasDimensions","columns","hasImageCaption","makeTab","title","MainTab","FileReader","global$1","global$2","editor","getParam","hasAdvTab","hasUploadTab","getPrependUrl","getClassList","getImageList","hasUploadUrl","getUploadUrl","hasUploadHandler","getUploadHandler","getUploadBasePath","getUploadCredentials","Settings","parseIntAndGetMax","val1","val2","Math","max","parseInt","parseIntAndGetMin","min","getImageSize","img","document","createElement","done","dimensions","parentNode","removeChild","onload","width","height","pwidth","clientWidth","pheight","clientHeight","bili","onerror","style","visibility","position","bottom","left","body","appendChild","src","removePixelSuffix","replace","addPixelSuffix","test","mergeMargins","css","margin","splitMargin","createImageList","send","success","text","JSON","parse","waitLoadImage","imgElm","selectImage","selection","select","nodeChanged","dom","setAttribs","blobToDataUri","reject","reader","readAsDataURL","isPlaceholderImage","nodeName","hasAttribute","Utils","global$3","DOM","getHspace","marginLeft","marginRight","getVspace","marginTop","marginBottom","getBorder","borderWidth","getAttrib","getAttribute","getStyle","hasCaption","setAttrib","setAttribute","wrapInFigure","figureElm","create","class","insertAfter","contentEditable","removeFigure","remove","toggleCaption","normalizeStyle","normalizeCss","attrValue","removeAttribute","setSize","getSize","setHspace","pxValue","setVspace","setBorder","setBorderStyle","borderStyle","getBorderStyle","isFigure","elm","isImage","defaultData","alt","hspace","vspace","border","getStyleValue","write","figure","read","updateProp","oldData","newData","normalized","_name","_value","cssText","styles","mergedCss","compressed","serialize","getSelectedImage","getNode","getParent","splitTextBlock","textBlock","node","schema","getTextBlockElements","getBody","readImageDataFromSelection","insertImageAtCaret","focus","setContent","outerHTML","insertedElm","syncSrcAttr","deleteImage","isEmpty","setCursorLocation","writeImageDataToSelection","insertOrUpdateImage","findMap","arr","global$4","getValue","item","sanitizeList","list","extractValue","out","menu","sanitizer","extracter","sanitize","isGroup","findEntryDelegate","findEntry","optList","ListUtils","XMLHttpRequest","pathJoin","path1","path2","Uploader","settings","defaultHandler","blobInfo","failure","progress","xhr","formData","open","withCredentials","credentials","upload","onprogress","e","loaded","total","status","json","responseText","location","basePath","FormData","append","filename","uploadBlob","handler","ex","isDefaultHandler","extend","makeTab$1","AdvTab","collect","urlListSanitizer","convertURL","futureImageList","prependURL","preUrl","makeTab$2","UploadTab","createState","prevImage","prevAlt","fromImageData","meta","images","classes","borderstyle","fileinput","toImageData","addPrependUrl2","srcURL","prependUrl","substring","addPrependUrl","api","getData","setData","formFillFromMeta2","entry","formFillFromMeta","calculateImageSize","helpers","state","imageSize","size","updateImagesDropdown","changeSrc","changeImages","updateAlt","calcVSpace","matchingTopBottom","calcHSpace","matchingLeftRight","calcBorderWidth","calcBorderStyle","calcStyle","parseStyle","serializeStyle","changeStyle2","dataCopy","changeStyle","changeAStyle","changeFileInput","block","unblock","file","blobUri","uploader","finalize","dataUrl","createBlobCache","showTab","catch","alertErr","changeHandler","evt","closeHandler","makeDialogBody","tabPanel","tabs","panel","makeDialog","buttons","primary","initialData","onSubmit","onChange","onClose","submitHandler","undoManager","transact","editorUpload","uploadImagesAuto","close","documentBaseURI","toAbsolute","blobCache","base64","windowManager","alert","normalizeCss$1","stylesArg","Dialog","spec","register","addCommand","Commands","hasImageClass","className","attr","toggleContentEditableState","nodes","toggleContentEditable","getAll","setup","on","parser","addNodeFilter","serializer","FilterContent","fromHtml","html","doc","div","innerHTML","hasChildNodes","childNodes","console","fromDom","fromTag","tag","fromText","createTextNode","fromPoint","docElm","y","elementFromPoint","Element","ATTRIBUTE","Node","ATTRIBUTE_NODE","CDATA_SECTION","CDATA_SECTION_NODE","COMMENT","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","DOCUMENT_TYPE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT","DOCUMENT_FRAGMENT_NODE","ELEMENT","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE","ENTITY_REFERENCE_NODE","ENTITY","ENTITY_NODE","NOTATION","NOTATION_NODE","element","toLowerCase","Immutable","fields","values","struct","compareDocumentPosition","match","documentPositionPreceding","DOCUMENT_POSITION_PRECEDING","documentPositionContainedBy","DOCUMENT_POSITION_CONTAINED_BY","cached","called","firstMatch","regexes","find$1","agent","major","minor","group","Number","nu$3","detect","versionRegexes","cleanedAgent","unknown","Version","edge","chrome","ie","opera","firefox","safari","isBrowser","current","unknown$1","nu$4","version","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","windows","ios","android","linux","osx","solaris","freebsd","isOS","unknown$2","nu$5","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","DeviceType","os","browser","userAgent","isiPad","isiPhone","isAndroid3","isAndroid4","isTablet","isTouch","isPhone","iOSwebview","isWebView","detect$1","candidates","candidate","search","detectBrowser","browsers","detectOs","oses","UaString","contains","str","substr","indexOf","normalVersionRegex","checkContains","target","uastring","monstrosity","PlatformInfo","detect$2","deviceType","PlatformDetection","detect$3","navigator","PlatformDetection$1","regularContains","e1","e2","d1","d2","ieContains","contains$1","parent","spot","getRootElement","parentElm","register$1","makeContextMenuItem","icon","onAction","rootElm","ui","registry","addToggleButton","tooltip","onSetup","buttonApi","selectorChangedWithUnbind","setActive","unbind","addMenuItem","addContextMenu","update","Buttons","add","Plugin"],"mappings":";;;;;;;;;;AAAA;;;;;;;;AAQA,CAAC,YAAY;AACb,MAAIA,KAAK,GAAI,UAAUC,UAAV,EAAsB;AAC/B;;AAEA,QAAIC,MAAM,GAAGC,OAAO,CAACC,IAAR,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,uBAA3B,CAAb;;AAEA,QAAIC,IAAI,GAAG,SAAPA,IAAO,GAAY,CACtB,CADD;;AAEA,QAAIC,QAAQ,GAAG,SAAXA,QAAW,CAAUC,KAAV,EAAiB;AAC9B,aAAO,YAAY;AACjB,eAAOA,KAAP;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIC,QAAQ,GAAG,SAAXA,QAAW,CAAUC,CAAV,EAAa;AAC1B,aAAOA,CAAP;AACD,KAFD;;AAGA,QAAIC,GAAG,GAAG,SAANA,GAAM,CAAUC,GAAV,EAAe;AACvB,aAAO,YAAY;AACjB,cAAM,IAAIC,KAAJ,CAAUD,GAAV,CAAN;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIE,KAAK,GAAGP,QAAQ,CAAC,KAAD,CAApB;AACA,QAAIQ,MAAM,GAAGR,QAAQ,CAAC,IAAD,CAArB;AAEA,QAAIS,OAAO,GAAGF,KAAd;AACA,QAAIG,QAAQ,GAAGF,MAAf;;AACA,QAAIG,IAAI,GAAG,SAAPA,IAAO,GAAY;AACrB,aAAOC,IAAP;AACD,KAFD;;AAGA,QAAIA,IAAI,GAAG,YAAY;AACrB,UAAIC,EAAE,GAAG,SAALA,EAAK,CAAUC,CAAV,EAAa;AACpB,eAAOA,CAAC,CAACC,MAAF,EAAP;AACD,OAFD;;AAGA,UAAIC,IAAI,GAAG,SAAPA,IAAO,CAAUC,KAAV,EAAiB;AAC1B,eAAOA,KAAK,EAAZ;AACD,OAFD;;AAGA,UAAIC,EAAE,GAAG,SAALA,EAAK,CAAUC,CAAV,EAAa;AACpB,eAAOA,CAAP;AACD,OAFD;;AAGA,UAAIpB,IAAI,GAAG,SAAPA,IAAO,GAAY,CACtB,CADD;;AAEA,UAAIqB,GAAG,GAAG,SAANA,GAAM,GAAY;AACpB,eAAO,IAAP;AACD,OAFD;;AAGA,UAAIC,KAAK,GAAG,SAARA,KAAQ,GAAY;AACtB,eAAOC,SAAP;AACD,OAFD;;AAGA,UAAIC,EAAE,GAAG;AACPC,QAAAA,IAAI,EAAE,cAAUL,CAAV,EAAaM,CAAb,EAAgB;AACpB,iBAAON,CAAC,EAAR;AACD,SAHM;AAIPO,QAAAA,EAAE,EAAEjB,OAJG;AAKPkB,QAAAA,MAAM,EAAElB,OALD;AAMPM,QAAAA,MAAM,EAAEL,QAND;AAOPkB,QAAAA,KAAK,EAAEV,EAPA;AAQPW,QAAAA,UAAU,EAAEb,IARL;AASPc,QAAAA,QAAQ,EAAE,kBAAUzB,GAAV,EAAe;AACvB,gBAAM,IAAIC,KAAJ,CAAUD,GAAG,IAAI,iCAAjB,CAAN;AACD,SAXM;AAYP0B,QAAAA,SAAS,EAAEX,GAZJ;AAaPY,QAAAA,cAAc,EAAEX,KAbT;AAcPY,QAAAA,EAAE,EAAEf,EAdG;AAePgB,QAAAA,OAAO,EAAElB,IAfF;AAgBPmB,QAAAA,GAAG,EAAExB,IAhBE;AAiBPyB,QAAAA,EAAE,EAAEzB,IAjBG;AAkBP0B,QAAAA,IAAI,EAAEtC,IAlBC;AAmBPuC,QAAAA,IAAI,EAAE3B,IAnBC;AAoBP4B,QAAAA,OAAO,EAAE5B,IApBF;AAqBP6B,QAAAA,MAAM,EAAE/B,OArBD;AAsBPgC,QAAAA,MAAM,EAAE/B,QAtBD;AAuBPgC,QAAAA,MAAM,EAAE/B,IAvBD;AAwBPgC,QAAAA,MAAM,EAAE9B,EAxBD;AAyBP+B,QAAAA,OAAO,EAAE/B,EAzBF;AA0BPgC,QAAAA,OAAO,EAAE,mBAAY;AACnB,iBAAO,EAAP;AACD,SA5BM;AA6BPC,QAAAA,QAAQ,EAAE9C,QAAQ,CAAC,QAAD;AA7BX,OAAT;AA+BA,UAAI+C,MAAM,CAACC,MAAX,EACED,MAAM,CAACC,MAAP,CAAczB,EAAd;AACF,aAAOA,EAAP;AACD,KApDU,EAAX;;AAqDA,QAAI0B,IAAI,GAAG,SAAPA,IAAO,CAAUC,CAAV,EAAa;AACtB,UAAIC,UAAU,GAAG,SAAbA,UAAa,GAAY;AAC3B,eAAOD,CAAP;AACD,OAFD;;AAGA,UAAIE,IAAI,GAAG,SAAPA,IAAO,GAAY;AACrB,eAAO7B,EAAP;AACD,OAFD;;AAGA,UAAIY,GAAG,GAAG,SAANA,GAAM,CAAUkB,CAAV,EAAa;AACrB,eAAOJ,IAAI,CAACI,CAAC,CAACH,CAAD,CAAF,CAAX;AACD,OAFD;;AAGA,UAAIZ,IAAI,GAAG,SAAPA,IAAO,CAAUe,CAAV,EAAa;AACtB,eAAOA,CAAC,CAACH,CAAD,CAAR;AACD,OAFD;;AAGA,UAAI3B,EAAE,GAAG;AACPC,QAAAA,IAAI,EAAE,cAAUL,CAAV,EAAaM,CAAb,EAAgB;AACpB,iBAAOA,CAAC,CAACyB,CAAD,CAAR;AACD,SAHM;AAIPxB,QAAAA,EAAE,EAAE,YAAU4B,CAAV,EAAa;AACf,iBAAOJ,CAAC,KAAKI,CAAb;AACD,SANM;AAOP3B,QAAAA,MAAM,EAAEjB,QAPD;AAQPK,QAAAA,MAAM,EAAEN,OARD;AASPmB,QAAAA,KAAK,EAAEuB,UATA;AAUPtB,QAAAA,UAAU,EAAEsB,UAVL;AAWPrB,QAAAA,QAAQ,EAAEqB,UAXH;AAYPpB,QAAAA,SAAS,EAAEoB,UAZJ;AAaPnB,QAAAA,cAAc,EAAEmB,UAbT;AAcPlB,QAAAA,EAAE,EAAEmB,IAdG;AAePlB,QAAAA,OAAO,EAAEkB,IAfF;AAgBPjB,QAAAA,GAAG,EAAEA,GAhBE;AAiBPC,QAAAA,EAAE,EAAE,YAAUmB,MAAV,EAAkB;AACpB,iBAAOA,MAAM,CAAC/B,IAAP,CAAYb,IAAZ,EAAkB,UAAU6C,GAAV,EAAe;AACtC,mBAAOP,IAAI,CAACO,GAAG,CAACN,CAAD,CAAJ,CAAX;AACD,WAFM,CAAP;AAGD,SArBM;AAsBPb,QAAAA,IAAI,EAAE,cAAUgB,CAAV,EAAa;AACjBA,UAAAA,CAAC,CAACH,CAAD,CAAD;AACD,SAxBM;AAyBPZ,QAAAA,IAAI,EAAEA,IAzBC;AA0BPC,QAAAA,OAAO,EAAEY,UA1BF;AA2BPX,QAAAA,MAAM,EAAEF,IA3BD;AA4BPG,QAAAA,MAAM,EAAEH,IA5BD;AA6BPI,QAAAA,MAAM,EAAE,gBAAUW,CAAV,EAAa;AACnB,iBAAOA,CAAC,CAACH,CAAD,CAAD,GAAO3B,EAAP,GAAYX,IAAnB;AACD,SA/BM;AAgCP+B,QAAAA,MAAM,EAAE,gBAAU7B,CAAV,EAAa;AACnB,iBAAOA,CAAC,CAACY,EAAF,CAAKwB,CAAL,CAAP;AACD,SAlCM;AAmCPN,QAAAA,OAAO,EAAE,iBAAU9B,CAAV,EAAa2C,SAAb,EAAwB;AAC/B,iBAAO3C,CAAC,CAACU,IAAF,CAAOf,OAAP,EAAgB,UAAUiD,CAAV,EAAa;AAClC,mBAAOD,SAAS,CAACP,CAAD,EAAIQ,CAAJ,CAAhB;AACD,WAFM,CAAP;AAGD,SAvCM;AAwCPb,QAAAA,OAAO,EAAE,mBAAY;AACnB,iBAAO,CAACK,CAAD,CAAP;AACD,SA1CM;AA2CPJ,QAAAA,QAAQ,EAAE,oBAAY;AACpB,iBAAO,UAAUI,CAAV,GAAc,GAArB;AACD;AA7CM,OAAT;AA+CA,aAAO3B,EAAP;AACD,KA7DD;;AA8DA,QAAIoC,IAAI,GAAG,SAAPA,IAAO,CAAU1D,KAAV,EAAiB;AAC1B,aAAOA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKqB,SAA5B,GAAwCV,IAAxC,GAA+CqC,IAAI,CAAChD,KAAD,CAA1D;AACD,KAFD;;AAGA,QAAI2D,MAAM,GAAG;AACXX,MAAAA,IAAI,EAAEA,IADK;AAEXtC,MAAAA,IAAI,EAAEA,IAFK;AAGXgD,MAAAA,IAAI,EAAEA;AAHK,KAAb;;AAMA,QAAIE,MAAM,GAAG,SAATA,MAAS,CAAU1D,CAAV,EAAa;AACxB,UAAIA,CAAC,KAAK,IAAV,EACE,OAAO,MAAP;;AACF,UAAI2D,CAAC,WAAU3D,CAAV,CAAL;;AACA,UAAI2D,CAAC,KAAK,QAAN,IAAkBC,KAAK,CAACC,SAAN,CAAgBC,aAAhB,CAA8B9D,CAA9B,CAAtB,EACE,OAAO,OAAP;AACF,UAAI2D,CAAC,KAAK,QAAN,IAAkBI,MAAM,CAACF,SAAP,CAAiBC,aAAjB,CAA+B9D,CAA/B,CAAtB,EACE,OAAO,QAAP;AACF,aAAO2D,CAAP;AACD,KATD;;AAUA,QAAIK,MAAM,GAAG,SAATA,MAAS,CAAUC,IAAV,EAAgB;AAC3B,aAAO,UAAUnE,KAAV,EAAiB;AACtB,eAAO4D,MAAM,CAAC5D,KAAD,CAAN,KAAkBmE,IAAzB;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIC,QAAQ,GAAGF,MAAM,CAAC,QAAD,CAArB;AACA,QAAIG,QAAQ,GAAGH,MAAM,CAAC,QAAD,CAArB;AACA,QAAII,SAAS,GAAGJ,MAAM,CAAC,SAAD,CAAtB;AACA,QAAIK,UAAU,GAAGL,MAAM,CAAC,UAAD,CAAvB;AAEA,QAAIM,KAAK,GAAGV,KAAK,CAACC,SAAN,CAAgBS,KAA5B;;AACA,QAAIpC,IAAI,GAAG,SAAPA,IAAO,CAAUqC,EAAV,EAAcrB,CAAd,EAAiB;AAC1B,WAAK,IAAIsB,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGF,EAAE,CAACG,MAAzB,EAAiCF,CAAC,GAAGC,GAArC,EAA0CD,CAAC,EAA3C,EAA+C;AAC7C,YAAIxE,CAAC,GAAGuE,EAAE,CAACC,CAAD,CAAV;AACAtB,QAAAA,CAAC,CAAClD,CAAD,EAAIwE,CAAJ,EAAOD,EAAP,CAAD;AACD;AACF,KALD;;AAMA,QAAII,IAAI,GAAG,SAAPA,IAAO,CAAUJ,EAAV,EAAcK,IAAd,EAAoB;AAC7B,WAAK,IAAIJ,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGF,EAAE,CAACG,MAAzB,EAAiCF,CAAC,GAAGC,GAArC,EAA0CD,CAAC,EAA3C,EAA+C;AAC7C,YAAIxE,CAAC,GAAGuE,EAAE,CAACC,CAAD,CAAV;;AACA,YAAII,IAAI,CAAC5E,CAAD,EAAIwE,CAAJ,EAAOD,EAAP,CAAR,EAAoB;AAClB,iBAAOd,MAAM,CAACX,IAAP,CAAY9C,CAAZ,CAAP;AACD;AACF;;AACD,aAAOyD,MAAM,CAACjD,IAAP,EAAP;AACD,KARD;;AASA,QAAIqE,IAAI,GAAGjB,KAAK,CAACC,SAAN,CAAgBgB,IAA3B;;AACA,QAAIzC,OAAO,GAAG,SAAVA,OAAU,CAAUmC,EAAV,EAAc;AAC1B,UAAIO,CAAC,GAAG,EAAR;;AACA,WAAK,IAAIN,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGF,EAAE,CAACG,MAAzB,EAAiCF,CAAC,GAAGC,GAArC,EAA0C,EAAED,CAA5C,EAA+C;AAC7C,YAAI,CAACZ,KAAK,CAACC,SAAN,CAAgBC,aAAhB,CAA8BS,EAAE,CAACC,CAAD,CAAhC,CAAL,EACE,MAAM,IAAIrE,KAAJ,CAAU,sBAAsBqE,CAAtB,GAA0B,4BAA1B,GAAyDD,EAAnE,CAAN;AACFM,QAAAA,IAAI,CAACE,KAAL,CAAWD,CAAX,EAAcP,EAAE,CAACC,CAAD,CAAhB;AACD;;AACD,aAAOM,CAAP;AACD,KARD;;AASA,QAAIE,IAAI,GAAG,SAAPA,IAAO,CAAUT,EAAV,EAAc;AACvB,aAAOA,EAAE,CAACG,MAAH,KAAc,CAAd,GAAkBjB,MAAM,CAACjD,IAAP,EAAlB,GAAkCiD,MAAM,CAACX,IAAP,CAAYyB,EAAE,CAAC,CAAD,CAAd,CAAzC;AACD,KAFD;;AAGA,QAAIU,MAAM,GAAGZ,UAAU,CAACT,KAAK,CAACJ,IAAP,CAAV,GAAyBI,KAAK,CAACJ,IAA/B,GAAsC,UAAUxD,CAAV,EAAa;AAC9D,aAAOsE,KAAK,CAACzD,IAAN,CAAWb,CAAX,CAAP;AACD,KAFD;;AAIA,QAAIkF,OAAQ,GAAG,oBAAY;AACzBA,MAAAA,OAAQ,GAAGtC,MAAM,CAACuC,MAAP,IAAiB,SAASD,QAAT,CAAkBvB,CAAlB,EAAqB;AAC/C,aAAK,IAAIrC,CAAJ,EAAOkD,CAAC,GAAG,CAAX,EAAcxD,CAAC,GAAGoE,SAAS,CAACV,MAAjC,EAAyCF,CAAC,GAAGxD,CAA7C,EAAgDwD,CAAC,EAAjD,EAAqD;AACnDlD,UAAAA,CAAC,GAAG8D,SAAS,CAACZ,CAAD,CAAb;;AACA,eAAK,IAAIa,CAAT,IAAc/D,CAAd;AACE,gBAAIsB,MAAM,CAACiB,SAAP,CAAiByB,cAAjB,CAAgCzE,IAAhC,CAAqCS,CAArC,EAAwC+D,CAAxC,CAAJ,EACE1B,CAAC,CAAC0B,CAAD,CAAD,GAAO/D,CAAC,CAAC+D,CAAD,CAAR;AAFJ;AAGD;;AACD,eAAO1B,CAAP;AACD,OARD;;AASA,aAAOuB,OAAQ,CAACH,KAAT,CAAe,IAAf,EAAqBK,SAArB,CAAP;AACD,KAXD;;AAaA,QAAIG,EAAE,GAAG,SAALA,EAAK,CAAUC,MAAV,EAAkB;AACzB,UAAIC,IAAI,GAAGhC,MAAM,CAACjD,IAAP,EAAX;AACA,UAAIkF,SAAS,GAAG,EAAhB;;AACA,UAAI1D,GAAG,GAAG,SAANA,GAAM,CAAUkB,CAAV,EAAa;AACrB,eAAOqC,EAAE,CAAC,UAAUI,SAAV,EAAqB;AAC7BC,UAAAA,GAAG,CAAC,UAAUH,IAAV,EAAgB;AAClBE,YAAAA,SAAS,CAACzC,CAAC,CAACuC,IAAD,CAAF,CAAT;AACD,WAFE,CAAH;AAGD,SAJQ,CAAT;AAKD,OAND;;AAOA,UAAIG,GAAG,GAAG,SAANA,GAAM,CAAUD,SAAV,EAAqB;AAC7B,YAAIE,OAAO,EAAX,EACEhF,IAAI,CAAC8E,SAAD,CAAJ,CADF,KAGED,SAAS,CAACb,IAAV,CAAec,SAAf;AACH,OALD;;AAMA,UAAIG,GAAG,GAAG,SAANA,GAAM,CAAU9F,CAAV,EAAa;AACrByF,QAAAA,IAAI,GAAGhC,MAAM,CAACX,IAAP,CAAY9C,CAAZ,CAAP;AACA+F,QAAAA,GAAG,CAACL,SAAD,CAAH;AACAA,QAAAA,SAAS,GAAG,EAAZ;AACD,OAJD;;AAKA,UAAIG,OAAO,GAAG,SAAVA,OAAU,GAAY;AACxB,eAAOJ,IAAI,CAACjE,MAAL,EAAP;AACD,OAFD;;AAGA,UAAIuE,GAAG,GAAG,SAANA,GAAM,CAAUC,GAAV,EAAe;AACvB9D,QAAAA,IAAI,CAAC8D,GAAD,EAAMnF,IAAN,CAAJ;AACD,OAFD;;AAGA,UAAIA,IAAI,GAAG,SAAPA,IAAO,CAAUoF,EAAV,EAAc;AACvBR,QAAAA,IAAI,CAACvD,IAAL,CAAU,UAAUlC,CAAV,EAAa;AACrBV,UAAAA,UAAU,CAAC4G,UAAX,CAAsB,YAAY;AAChCD,YAAAA,EAAE,CAACjG,CAAD,CAAF;AACD,WAFD,EAEG,CAFH;AAGD,SAJD;AAKD,OAND;;AAOAwF,MAAAA,MAAM,CAACM,GAAD,CAAN;AACA,aAAO;AACLF,QAAAA,GAAG,EAAEA,GADA;AAEL5D,QAAAA,GAAG,EAAEA,GAFA;AAGL6D,QAAAA,OAAO,EAAEA;AAHJ,OAAP;AAKD,KAxCD;;AAyCA,QAAIM,IAAI,GAAG,SAAPA,IAAO,CAAUpD,CAAV,EAAa;AACtB,aAAOwC,EAAE,CAAC,UAAUa,QAAV,EAAoB;AAC5BA,QAAAA,QAAQ,CAACrD,CAAD,CAAR;AACD,OAFQ,CAAT;AAGD,KAJD;;AAKA,QAAIsD,SAAS,GAAG;AACdd,MAAAA,EAAE,EAAEA,EADU;AAEdY,MAAAA,IAAI,EAAEA;AAFQ,KAAhB;;AAKA,QAAIG,MAAM,GAAG,SAATA,MAAS,CAAUpD,CAAV,EAAa;AACxB,aAAO,YAAY;AACjB,YAAIqD,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGpB,SAAS,CAACV,MAAhC,EAAwC8B,EAAE,EAA1C,EAA8C;AAC5CD,UAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWpB,SAAS,CAACoB,EAAD,CAApB;AACD;;AACD,YAAIpF,EAAE,GAAG,IAAT;AACA9B,QAAAA,UAAU,CAAC4G,UAAX,CAAsB,YAAY;AAChChD,UAAAA,CAAC,CAAC6B,KAAF,CAAQ3D,EAAR,EAAYmF,IAAZ;AACD,SAFD,EAEG,CAFH;AAGD,OATD;AAUD,KAXD;;AAaA,QAAIE,IAAI,GAAG,SAAPA,IAAO,CAAUjB,MAAV,EAAkB;AAC3B,UAAII,GAAG,GAAG,SAANA,GAAM,CAAUQ,QAAV,EAAoB;AAC5BZ,QAAAA,MAAM,CAACc,MAAM,CAACF,QAAD,CAAP,CAAN;AACD,OAFD;;AAGA,UAAIpE,GAAG,GAAG,SAANA,GAAM,CAAUqB,GAAV,EAAe;AACvB,eAAOoD,IAAI,CAAC,UAAUL,QAAV,EAAoB;AAC9BR,UAAAA,GAAG,CAAC,UAAU7C,CAAV,EAAa;AACf,gBAAIjD,KAAK,GAAGuD,GAAG,CAACN,CAAD,CAAf;AACAqD,YAAAA,QAAQ,CAACtG,KAAD,CAAR;AACD,WAHE,CAAH;AAID,SALU,CAAX;AAMD,OAPD;;AAQA,UAAIqC,IAAI,GAAG,SAAPA,IAAO,CAAUuE,QAAV,EAAoB;AAC7B,eAAOD,IAAI,CAAC,UAAUL,QAAV,EAAoB;AAC9BR,UAAAA,GAAG,CAAC,UAAU7C,CAAV,EAAa;AACf2D,YAAAA,QAAQ,CAAC3D,CAAD,CAAR,CAAY6C,GAAZ,CAAgBQ,QAAhB;AACD,WAFE,CAAH;AAGD,SAJU,CAAX;AAKD,OAND;;AAOA,UAAIO,QAAQ,GAAG,SAAXA,QAAW,CAAUC,OAAV,EAAmB;AAChC,eAAOH,IAAI,CAAC,UAAUL,QAAV,EAAoB;AAC9BR,UAAAA,GAAG,CAAC,UAAU7C,CAAV,EAAa;AACf6D,YAAAA,OAAO,CAAChB,GAAR,CAAYQ,QAAZ;AACD,WAFE,CAAH;AAGD,SAJU,CAAX;AAKD,OAND;;AAOA,UAAIS,MAAM,GAAG,SAATA,MAAS,GAAY;AACvB,eAAOR,SAAS,CAACd,EAAV,CAAaK,GAAb,CAAP;AACD,OAFD;;AAGA,UAAIkB,QAAQ,GAAG,SAAXA,QAAW,GAAY;AACzB,YAAIC,KAAK,GAAG,IAAZ;AACA,eAAON,IAAI,CAAC,UAAUL,QAAV,EAAoB;AAC9B,cAAIW,KAAK,KAAK,IAAd,EAAoB;AAClBA,YAAAA,KAAK,GAAGF,MAAM,EAAd;AACD;;AACDE,UAAAA,KAAK,CAACnB,GAAN,CAAUQ,QAAV;AACD,SALU,CAAX;AAMD,OARD;;AASA,aAAO;AACLpE,QAAAA,GAAG,EAAEA,GADA;AAELG,QAAAA,IAAI,EAAEA,IAFD;AAGLwE,QAAAA,QAAQ,EAAEA,QAHL;AAILE,QAAAA,MAAM,EAAEA,MAJH;AAKLC,QAAAA,QAAQ,EAAEA,QALL;AAMLlB,QAAAA,GAAG,EAAEA;AANA,OAAP;AAQD,KA9CD;;AA+CA,QAAIoB,MAAM,GAAG,SAATA,MAAS,CAAUjE,CAAV,EAAa;AACxB,aAAO0D,IAAI,CAAC,UAAUL,QAAV,EAAoB;AAC9BA,QAAAA,QAAQ,CAACrD,CAAD,CAAR;AACD,OAFU,CAAX;AAGD,KAJD;;AAKA,QAAIkE,MAAM,GAAG;AACX1B,MAAAA,EAAE,EAAEkB,IADO;AAEXN,MAAAA,IAAI,EAAEa;AAFK,KAAb;;AAKA,QAAIlH,KAAK,GAAG,SAARA,KAAQ,CAAUa,CAAV,EAAa;AACvB,UAAIY,EAAE,GAAG,SAALA,EAAK,CAAU4B,CAAV,EAAa;AACpB,eAAOxC,CAAC,KAAKwC,CAAb;AACD,OAFD;;AAGA,UAAIrB,EAAE,GAAG,SAALA,EAAK,CAAUoF,GAAV,EAAe;AACtB,eAAOpH,KAAK,CAACa,CAAD,CAAZ;AACD,OAFD;;AAGA,UAAIoB,OAAO,GAAG,SAAVA,OAAU,CAAUmB,CAAV,EAAa;AACzB,eAAOpD,KAAK,CAACa,CAAD,CAAZ;AACD,OAFD;;AAGA,UAAIqB,GAAG,GAAG,SAANA,GAAM,CAAUkB,CAAV,EAAa;AACrB,eAAOpD,KAAK,CAACoD,CAAC,CAACvC,CAAD,CAAF,CAAZ;AACD,OAFD;;AAGA,UAAIwG,QAAQ,GAAG,SAAXA,QAAW,CAAUjE,CAAV,EAAa;AAC1B,eAAOpD,KAAK,CAACa,CAAD,CAAZ;AACD,OAFD;;AAGA,UAAIuB,IAAI,GAAG,SAAPA,IAAO,CAAUgB,CAAV,EAAa;AACtBA,QAAAA,CAAC,CAACvC,CAAD,CAAD;AACD,OAFD;;AAGA,UAAIwB,IAAI,GAAG,SAAPA,IAAO,CAAUe,CAAV,EAAa;AACtB,eAAOA,CAAC,CAACvC,CAAD,CAAR;AACD,OAFD;;AAGA,UAAIU,IAAI,GAAG,SAAPA,IAAO,CAAU+F,CAAV,EAAaC,OAAb,EAAsB;AAC/B,eAAOA,OAAO,CAAC1G,CAAD,CAAd;AACD,OAFD;;AAGA,UAAI0B,MAAM,GAAG,SAATA,MAAS,CAAUa,CAAV,EAAa;AACxB,eAAOA,CAAC,CAACvC,CAAD,CAAR;AACD,OAFD;;AAGA,UAAI2B,MAAM,GAAG,SAATA,MAAS,CAAUY,CAAV,EAAa;AACxB,eAAOA,CAAC,CAACvC,CAAD,CAAR;AACD,OAFD;;AAGA,UAAI2G,QAAQ,GAAG,SAAXA,QAAW,GAAY;AACzB,eAAO7D,MAAM,CAACX,IAAP,CAAYnC,CAAZ,CAAP;AACD,OAFD;;AAGA,aAAO;AACLY,QAAAA,EAAE,EAAEA,EADC;AAELgG,QAAAA,OAAO,EAAElH,MAFJ;AAGLmH,QAAAA,OAAO,EAAEpH,KAHJ;AAILqB,QAAAA,KAAK,EAAE5B,QAAQ,CAACc,CAAD,CAJV;AAKLe,QAAAA,UAAU,EAAE7B,QAAQ,CAACc,CAAD,CALf;AAMLgB,QAAAA,QAAQ,EAAE9B,QAAQ,CAACc,CAAD,CANb;AAOLmB,QAAAA,EAAE,EAAEA,EAPC;AAQLC,QAAAA,OAAO,EAAEA,OARJ;AASLV,QAAAA,IAAI,EAAEA,IATD;AAULW,QAAAA,GAAG,EAAEA,GAVA;AAWLmF,QAAAA,QAAQ,EAAEA,QAXL;AAYLjF,QAAAA,IAAI,EAAEA,IAZD;AAaLC,QAAAA,IAAI,EAAEA,IAbD;AAcLE,QAAAA,MAAM,EAAEA,MAdH;AAeLC,QAAAA,MAAM,EAAEA,MAfH;AAgBLgF,QAAAA,QAAQ,EAAEA;AAhBL,OAAP;AAkBD,KApDD;;AAqDA,QAAIG,KAAK,GAAG,SAARA,KAAQ,CAAUC,OAAV,EAAmB;AAC7B,UAAIhG,UAAU,GAAG,SAAbA,UAAa,CAAUwB,CAAV,EAAa;AAC5B,eAAOA,CAAC,EAAR;AACD,OAFD;;AAGA,UAAIvB,QAAQ,GAAG,SAAXA,QAAW,GAAY;AACzB,eAAO1B,GAAG,CAAC8D,MAAM,CAAC2D,OAAD,CAAP,CAAH,EAAP;AACD,OAFD;;AAGA,UAAI5F,EAAE,GAAG,SAALA,EAAK,CAAUoF,GAAV,EAAe;AACtB,eAAOA,GAAP;AACD,OAFD;;AAGA,UAAInF,OAAO,GAAG,SAAVA,OAAU,CAAUmB,CAAV,EAAa;AACzB,eAAOA,CAAC,EAAR;AACD,OAFD;;AAGA,UAAIlB,GAAG,GAAG,SAANA,GAAM,CAAUkB,CAAV,EAAa;AACrB,eAAOuE,KAAK,CAACC,OAAD,CAAZ;AACD,OAFD;;AAGA,UAAIP,QAAQ,GAAG,SAAXA,QAAW,CAAUjE,CAAV,EAAa;AAC1B,eAAOuE,KAAK,CAACvE,CAAC,CAACwE,OAAD,CAAF,CAAZ;AACD,OAFD;;AAGA,UAAIvF,IAAI,GAAG,SAAPA,IAAO,CAAUe,CAAV,EAAa;AACtB,eAAOuE,KAAK,CAACC,OAAD,CAAZ;AACD,OAFD;;AAGA,UAAIrG,IAAI,GAAG,SAAPA,IAAO,CAAUsG,OAAV,EAAmBP,CAAnB,EAAsB;AAC/B,eAAOO,OAAO,CAACD,OAAD,CAAd;AACD,OAFD;;AAGA,aAAO;AACLnG,QAAAA,EAAE,EAAEnB,KADC;AAELmH,QAAAA,OAAO,EAAEnH,KAFJ;AAGLoH,QAAAA,OAAO,EAAEnH,MAHJ;AAILoB,QAAAA,KAAK,EAAE1B,QAJF;AAKL2B,QAAAA,UAAU,EAAEA,UALP;AAMLC,QAAAA,QAAQ,EAAEA,QANL;AAOLG,QAAAA,EAAE,EAAEA,EAPC;AAQLC,QAAAA,OAAO,EAAEA,OARJ;AASLV,QAAAA,IAAI,EAAEA,IATD;AAULW,QAAAA,GAAG,EAAEA,GAVA;AAWLmF,QAAAA,QAAQ,EAAEA,QAXL;AAYLjF,QAAAA,IAAI,EAAEtC,IAZD;AAaLuC,QAAAA,IAAI,EAAEA,IAbD;AAcLE,QAAAA,MAAM,EAAEjC,KAdH;AAeLkC,QAAAA,MAAM,EAAEjC,MAfH;AAgBLiH,QAAAA,QAAQ,EAAE7D,MAAM,CAACjD;AAhBZ,OAAP;AAkBD,KA3CD;;AA4CA,QAAIoH,UAAU,GAAG,SAAbA,UAAa,CAAUV,GAAV,EAAeW,GAAf,EAAoB;AACnC,aAAOX,GAAG,CAAC7F,IAAJ,CAAS,YAAY;AAC1B,eAAOoG,KAAK,CAACI,GAAD,CAAZ;AACD,OAFM,EAEJ/H,KAFI,CAAP;AAGD,KAJD;;AAKA,QAAIgI,MAAM,GAAG;AACXhI,MAAAA,KAAK,EAAEA,KADI;AAEX2H,MAAAA,KAAK,EAAEA,KAFI;AAGXG,MAAAA,UAAU,EAAEA;AAHD,KAAb;;AAMA,QAAIG,IAAI,GAAG,SAAPA,IAAO,CAAUC,QAAV,EAAoB;AAC7B,UAAIlB,QAAQ,GAAG,SAAXA,QAAW,GAAY;AACzB,eAAOiB,IAAI,CAACC,QAAQ,CAAClB,QAAT,EAAD,CAAX;AACD,OAFD;;AAGA,UAAImB,UAAU,GAAG,SAAbA,UAAa,CAAU/E,CAAV,EAAa;AAC5B,eAAO6E,IAAI,CAACC,QAAQ,CAAC7F,IAAT,CAAc,UAAU+F,IAAV,EAAgB;AACxC,iBAAOA,IAAI,CAAC7G,IAAL,CAAU,UAAUwG,GAAV,EAAe;AAC9B,mBAAOZ,MAAM,CAACd,IAAP,CAAY2B,MAAM,CAACL,KAAP,CAAaI,GAAb,CAAZ,CAAP;AACD,WAFM,EAEJ,UAAU9E,CAAV,EAAa;AACd,mBAAOG,CAAC,CAACH,CAAD,CAAR;AACD,WAJM,CAAP;AAKD,SANW,CAAD,CAAX;AAOD,OARD;;AASA,UAAIoF,UAAU,GAAG,SAAbA,UAAa,CAAUjF,CAAV,EAAa;AAC5B,eAAO6E,IAAI,CAACC,QAAQ,CAAChG,GAAT,CAAa,UAAUkG,IAAV,EAAgB;AACvC,iBAAOA,IAAI,CAAC/F,IAAL,CAAUe,CAAV,CAAP;AACD,SAFW,CAAD,CAAX;AAGD,OAJD;;AAKA,UAAIkF,SAAS,GAAG,SAAZA,SAAY,CAAUlF,CAAV,EAAa;AAC3B,eAAO6E,IAAI,CAACC,QAAQ,CAAChG,GAAT,CAAa,UAAUkG,IAAV,EAAgB;AACvC,iBAAOA,IAAI,CAAClG,GAAL,CAASkB,CAAT,CAAP;AACD,SAFW,CAAD,CAAX;AAGD,OAJD;;AAKA,UAAIiE,QAAQ,GAAG,SAAXA,QAAW,CAAUjE,CAAV,EAAa;AAC1B,eAAO6E,IAAI,CAACC,QAAQ,CAAChG,GAAT,CAAa,UAAUkG,IAAV,EAAgB;AACvC,iBAAOA,IAAI,CAACf,QAAL,CAAcjE,CAAd,CAAP;AACD,SAFW,CAAD,CAAX;AAGD,OAJD;;AAKA,UAAImF,UAAU,GAAG,SAAbA,UAAa,CAAUC,SAAV,EAAqBC,SAArB,EAAgC;AAC/C,eAAOP,QAAQ,CAAChG,GAAT,CAAa,UAAUwG,GAAV,EAAe;AACjC,iBAAOA,GAAG,CAACnH,IAAJ,CAASiH,SAAT,EAAoBC,SAApB,CAAP;AACD,SAFM,CAAP;AAGD,OAJD;;AAKA,UAAIE,WAAW,GAAG,SAAdA,WAAc,CAAUC,OAAV,EAAmBC,UAAnB,EAA+B;AAC/C,eAAOZ,IAAI,CAACd,MAAM,CAAC1B,EAAP,CAAU,UAAUa,QAAV,EAAoB;AACxC,cAAIwC,QAAQ,GAAG,KAAf;AACA,cAAIC,KAAK,GAAGvJ,UAAU,CAAC4G,UAAX,CAAsB,YAAY;AAC5C0C,YAAAA,QAAQ,GAAG,IAAX;AACAxC,YAAAA,QAAQ,CAAC0B,MAAM,CAACL,KAAP,CAAakB,UAAU,EAAvB,CAAD,CAAR;AACD,WAHW,EAGTD,OAHS,CAAZ;AAIAV,UAAAA,QAAQ,CAACpC,GAAT,CAAa,UAAUkD,MAAV,EAAkB;AAC7B,gBAAI,CAACF,QAAL,EAAe;AACbtJ,cAAAA,UAAU,CAACyJ,YAAX,CAAwBF,KAAxB;AACAzC,cAAAA,QAAQ,CAAC0C,MAAD,CAAR;AACD;AACF,WALD;AAMD,SAZW,CAAD,CAAX;AAaD,OAdD;;AAeA,aAAO5D,OAAQ,CAAC,EAAD,EAAK8C,QAAL,EAAe;AAC5BlB,QAAAA,QAAQ,EAAEA,QADkB;AAE5BmB,QAAAA,UAAU,EAAEA,UAFgB;AAG5BE,QAAAA,UAAU,EAAEA,UAHgB;AAI5BC,QAAAA,SAAS,EAAEA,SAJiB;AAK5BjB,QAAAA,QAAQ,EAAEA,QALkB;AAM5BkB,QAAAA,UAAU,EAAEA,UANgB;AAO5BI,QAAAA,WAAW,EAAEA;AAPe,OAAf,CAAf;AASD,KAzDD;;AA0DA,QAAIO,IAAI,GAAG,SAAPA,IAAO,CAAUC,MAAV,EAAkB;AAC3B,aAAOlB,IAAI,CAACd,MAAM,CAAC1B,EAAP,CAAU0D,MAAV,CAAD,CAAX;AACD,KAFD;;AAGA,QAAIC,OAAO,GAAG,SAAVA,OAAU,CAAUpJ,KAAV,EAAiB;AAC7B,aAAOiI,IAAI,CAACd,MAAM,CAACd,IAAP,CAAY2B,MAAM,CAAChI,KAAP,CAAaA,KAAb,CAAZ,CAAD,CAAX;AACD,KAFD;;AAGA,QAAIqJ,OAAO,GAAG,SAAVA,OAAU,CAAU1B,KAAV,EAAiB;AAC7B,aAAOM,IAAI,CAACd,MAAM,CAACd,IAAP,CAAY2B,MAAM,CAACL,KAAP,CAAaA,KAAb,CAAZ,CAAD,CAAX;AACD,KAFD;;AAGA,QAAI2B,UAAU,GAAG,SAAbA,UAAa,CAAUN,MAAV,EAAkB;AACjC,aAAOf,IAAI,CAACd,MAAM,CAACd,IAAP,CAAY2C,MAAZ,CAAD,CAAX;AACD,KAFD;;AAGA,QAAIO,UAAU,GAAG,SAAbA,UAAa,CAAUC,MAAV,EAAkB;AACjC,aAAOvB,IAAI,CAACuB,MAAM,CAACtH,GAAP,CAAW8F,MAAM,CAAChI,KAAlB,CAAD,CAAX;AACD,KAFD;;AAGA,QAAIyJ,WAAW,GAAG,SAAdA,WAAc,CAAUC,OAAV,EAAmB;AACnC,aAAOR,IAAI,CAAC,UAAUS,SAAV,EAAqB;AAC/BD,QAAAA,OAAO,CAACE,IAAR,CAAa,UAAU5J,KAAV,EAAiB;AAC5B2J,UAAAA,SAAS,CAAC3B,MAAM,CAAChI,KAAP,CAAaA,KAAb,CAAD,CAAT;AACD,SAFD,EAEG,UAAU2H,KAAV,EAAiB;AAClBgC,UAAAA,SAAS,CAAC3B,MAAM,CAACL,KAAP,CAAaA,KAAb,CAAD,CAAT;AACD,SAJD;AAKD,OANU,CAAX;AAOD,KARD;;AASA,QAAIkC,YAAY,GAAG;AACjBpE,MAAAA,EAAE,EAAEyD,IADa;AAEjBjB,MAAAA,IAAI,EAAEA,IAFW;AAGjB5B,MAAAA,IAAI,EAAE+C,OAHW;AAIjBpJ,MAAAA,KAAK,EAAEoJ,OAJU;AAKjBzB,MAAAA,KAAK,EAAE0B,OALU;AAMjBC,MAAAA,UAAU,EAAEA,UANK;AAOjBC,MAAAA,UAAU,EAAEA,UAPK;AAQjBE,MAAAA,WAAW,EAAEA;AARI,KAAnB;AAWA,QAAIjE,cAAc,GAAG1C,MAAM,CAACiB,SAAP,CAAiByB,cAAtC;;AACA,QAAIsE,OAAO,GAAG,SAAVA,OAAU,CAAUC,GAAV,EAAetE,EAAf,EAAmB;AAC/B,aAAOA,EAAP;AACD,KAFD;;AAGA,QAAIuE,IAAI,GAAG,SAAPA,IAAO,CAAUD,GAAV,EAAetE,EAAf,EAAmB;AAC5B,UAAIwE,WAAW,GAAG5F,QAAQ,CAAC0F,GAAD,CAAR,IAAiB1F,QAAQ,CAACoB,EAAD,CAA3C;AACA,aAAOwE,WAAW,GAAGC,SAAS,CAACH,GAAD,EAAMtE,EAAN,CAAZ,GAAwBA,EAA1C;AACD,KAHD;;AAIA,QAAI0E,SAAS,GAAG,SAAZA,SAAY,CAAUC,MAAV,EAAkB;AAChC,aAAO,YAAY;AACjB,YAAIC,OAAO,GAAG,IAAIvG,KAAJ,CAAUwB,SAAS,CAACV,MAApB,CAAd;;AACA,aAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2F,OAAO,CAACzF,MAA5B,EAAoCF,CAAC,EAArC;AACE2F,UAAAA,OAAO,CAAC3F,CAAD,CAAP,GAAaY,SAAS,CAACZ,CAAD,CAAtB;AADF;;AAEA,YAAI2F,OAAO,CAACzF,MAAR,KAAmB,CAAvB,EACE,MAAM,IAAIvE,KAAJ,CAAU,2BAAV,CAAN;AACF,YAAIiK,GAAG,GAAG,EAAV;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,OAAO,CAACzF,MAA5B,EAAoC2F,CAAC,EAArC,EAAyC;AACvC,cAAIC,SAAS,GAAGH,OAAO,CAACE,CAAD,CAAvB;;AACA,eAAK,IAAIE,GAAT,IAAgBD,SAAhB;AACE,gBAAIhF,cAAc,CAACzE,IAAf,CAAoByJ,SAApB,EAA+BC,GAA/B,CAAJ,EAAyC;AACvCH,cAAAA,GAAG,CAACG,GAAD,CAAH,GAAWL,MAAM,CAACE,GAAG,CAACG,GAAD,CAAJ,EAAWD,SAAS,CAACC,GAAD,CAApB,CAAjB;AACD;AAHH;AAID;;AACD,eAAOH,GAAP;AACD,OAfD;AAgBD,KAjBD;;AAkBA,QAAIJ,SAAS,GAAGC,SAAS,CAACH,IAAD,CAAzB;AACA,QAAIU,KAAK,GAAGP,SAAS,CAACL,OAAD,CAArB;AAEA,QAAIa,MAAM,GAAG,OAAOnL,UAAU,CAACoL,MAAlB,KAA6B,WAA7B,GAA2CpL,UAAU,CAACoL,MAAtD,GAA+DC,QAAQ,CAAC,cAAD,CAAR,EAA5E;;AAEA,QAAIC,IAAI,GAAG,SAAPA,IAAO,CAAUC,KAAV,EAAiBC,KAAjB,EAAwB;AACjC,UAAInK,CAAC,GAAGmK,KAAK,KAAK3J,SAAV,IAAuB2J,KAAK,KAAK,IAAjC,GAAwCA,KAAxC,GAAgDL,MAAxD;;AACA,WAAK,IAAIjG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqG,KAAK,CAACnG,MAAV,IAAoB/D,CAAC,KAAKQ,SAA1B,IAAuCR,CAAC,KAAK,IAA7D,EAAmE,EAAE6D,CAArE;AACE7D,QAAAA,CAAC,GAAGA,CAAC,CAACkK,KAAK,CAACrG,CAAD,CAAN,CAAL;AADF;;AAEA,aAAO7D,CAAP;AACD,KALD;;AAMA,QAAIhB,OAAO,GAAG,SAAVA,OAAU,CAAU0F,CAAV,EAAayF,KAAb,EAAoB;AAChC,UAAID,KAAK,GAAGxF,CAAC,CAAC0F,KAAF,CAAQ,GAAR,CAAZ;AACA,aAAOH,IAAI,CAACC,KAAD,EAAQC,KAAR,CAAX;AACD,KAHD;;AAKA,QAAIE,MAAM,GAAG,SAATA,MAAS,CAAUC,IAAV,EAAgBH,KAAhB,EAAuB;AAClC,aAAOnL,OAAO,CAACsL,IAAD,EAAOH,KAAP,CAAd;AACD,KAFD;;AAGA,QAAInJ,QAAQ,GAAG,SAAXA,QAAW,CAAUsJ,IAAV,EAAgBH,KAAhB,EAAuB;AACpC,UAAII,MAAM,GAAGF,MAAM,CAACC,IAAD,EAAOH,KAAP,CAAnB;AACA,UAAII,MAAM,KAAK/J,SAAX,IAAwB+J,MAAM,KAAK,IAAvC,EACE,MAAMD,IAAI,GAAG,gCAAb;AACF,aAAOC,MAAP;AACD,KALD;;AAMA,QAAIC,QAAQ,GAAG;AAAExJ,MAAAA,QAAQ,EAAEA;AAAZ,KAAf;;AAEA,QAAIyJ,GAAG,GAAG,SAANA,GAAM,GAAY;AACpB,aAAOD,QAAQ,CAACxJ,QAAT,CAAkB,KAAlB,CAAP;AACD,KAFD;;AAGA,QAAI0J,eAAe,GAAG,SAAlBA,eAAkB,CAAUC,IAAV,EAAgB;AACpC,aAAOF,GAAG,GAAGC,eAAN,CAAsBC,IAAtB,CAAP;AACD,KAFD;;AAGA,QAAIC,eAAe,GAAG,SAAlBA,eAAkB,CAAUC,CAAV,EAAa;AACjCJ,MAAAA,GAAG,GAAGG,eAAN,CAAsBC,CAAtB;AACD,KAFD;;AAGA,QAAIC,GAAG,GAAG;AACRJ,MAAAA,eAAe,EAAEA,eADT;AAERE,MAAAA,eAAe,EAAEA;AAFT,KAAV;;AAKA,QAAIG,SAAS,GAAG,SAAZA,SAAY,CAAUC,IAAV,EAAgB;AAC9B,UAAIC,QAAQ,GAAG;AACbX,QAAAA,IAAI,EAAE,KADO;AAEbhH,QAAAA,IAAI,EAAE,UAFO;AAGb4H,QAAAA,QAAQ,EAAE,OAHG;AAIbC,QAAAA,KAAK,EAAE;AAJM,OAAf;AAMA,UAAIC,SAAS,GAAGJ,IAAI,CAACI,SAAL,CAAe/J,GAAf,CAAmB,UAAUgK,KAAV,EAAiB;AAClD,eAAO;AACLf,UAAAA,IAAI,EAAE,QADD;AAELhH,UAAAA,IAAI,EAAE,WAFD;AAGL6H,UAAAA,KAAK,EAAE,YAHF;AAILE,UAAAA,KAAK,EAAEA;AAJF,SAAP;AAMD,OAPe,CAAhB;AAQA,UAAIC,gBAAgB,GAAG;AACrBhB,QAAAA,IAAI,EAAE,KADe;AAErBhH,QAAAA,IAAI,EAAE,OAFe;AAGrB6H,QAAAA,KAAK,EAAE;AAHc,OAAvB;AAKA,UAAII,UAAU,GAAG;AACfjB,QAAAA,IAAI,EAAE,OADS;AAEfhH,QAAAA,IAAI,EAAE,OAFS;AAGf6H,QAAAA,KAAK,EAAE;AAHQ,OAAjB;AAKA,UAAIK,eAAe,GAAG;AACpBlB,QAAAA,IAAI,EAAE,YADc;AAEpBhH,QAAAA,IAAI,EAAE;AAFc,OAAtB;AAIA,UAAImI,SAAS,GAAGT,IAAI,CAACS,SAAL,CAAepK,GAAf,CAAmB,UAAUgK,KAAV,EAAiB;AAClD,eAAO;AACLf,UAAAA,IAAI,EAAE,SADD;AAELhH,UAAAA,IAAI,EAAE,WAFD;AAGL6H,UAAAA,KAAK,EAAE,OAHF;AAILE,UAAAA,KAAK,EAAEA;AAJF,SAAP;AAMD,OAPe,CAAhB;AAQA,UAAIK,OAAO,GAAG;AACZpI,QAAAA,IAAI,EAAE,OADM;AAEZ6H,QAAAA,KAAK,EAAE,SAFK;AAGZE,QAAAA,KAAK,EAAE,CAAC;AACJ/H,UAAAA,IAAI,EAAE,UADF;AAEJgH,UAAAA,IAAI,EAAE,SAFF;AAGJa,UAAAA,KAAK,EAAE;AAHH,SAAD;AAHK,OAAd;AASA,aAAO1J,OAAO,CAAC,CACb,CAACwJ,QAAD,CADa,EAEbG,SAAS,CAACrJ,OAAV,EAFa,EAGbiJ,IAAI,CAACW,cAAL,GAAsB,CAACL,gBAAD,CAAtB,GAA2C,EAH9B,EAIbN,IAAI,CAACY,aAAL,GAAqB,CAACL,UAAD,CAArB,GAAoC,EAJvB,EAKbP,IAAI,CAACa,aAAL,GAAqB,CAACL,eAAD,CAArB,GAAyC,EAL5B,EAMb,CAAC;AACGlI,QAAAA,IAAI,EAAE,MADT;AAEGwI,QAAAA,OAAO,EAAE,CAFZ;AAGGT,QAAAA,KAAK,EAAE5J,OAAO,CAAC,CACbgK,SAAS,CAAC1J,OAAV,EADa,EAEbiJ,IAAI,CAACe,eAAL,GAAuB,CAACL,OAAD,CAAvB,GAAmC,EAFtB,CAAD;AAHjB,OAAD,CANa,CAAD,CAAd;AAeD,KA7DD;;AA8DA,QAAIM,OAAO,GAAG,SAAVA,OAAU,CAAUhB,IAAV,EAAgB;AAC5B,aAAO;AACLiB,QAAAA,KAAK,EAAE,SADF;AAEL3B,QAAAA,IAAI,EAAE,SAFD;AAGLe,QAAAA,KAAK,EAAEN,SAAS,CAACC,IAAD;AAHX,OAAP;AAKD,KAND;;AAOA,QAAIkB,OAAO,GAAG;AACZF,MAAAA,OAAO,EAAEA,OADG;AAEZjB,MAAAA,SAAS,EAAEA;AAFC,KAAd;;AAKA,aAASoB,UAAT,GAAuB;AACrB,UAAI5J,CAAC,GAAGiI,QAAQ,CAACxJ,QAAT,CAAkB,YAAlB,CAAR;AACA,aAAO,IAAIuB,CAAJ,EAAP;AACD;;AAED,QAAI6J,QAAQ,GAAGvN,OAAO,CAACC,IAAR,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,sBAA3B,CAAf;AAEA,QAAIqN,QAAQ,GAAGxN,OAAO,CAACC,IAAR,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,kBAA3B,CAAf;;AAEA,QAAI6M,aAAa,GAAG,SAAhBA,aAAgB,CAAUS,MAAV,EAAkB;AACpC,aAAOA,MAAM,CAACC,QAAP,CAAgB,kBAAhB,EAAoC,IAApC,EAA0C,SAA1C,CAAP;AACD,KAFD;;AAGA,QAAIC,SAAS,GAAG,SAAZA,SAAY,CAAUF,MAAV,EAAkB;AAChC,aAAOA,MAAM,CAACC,QAAP,CAAgB,cAAhB,EAAgC,KAAhC,EAAuC,SAAvC,CAAP;AACD,KAFD;;AAGA,QAAIE,YAAY,GAAG,SAAfA,YAAe,CAAUH,MAAV,EAAkB;AACnC,aAAOA,MAAM,CAACC,QAAP,CAAgB,iBAAhB,EAAmC,IAAnC,EAAyC,SAAzC,CAAP;AACD,KAFD;;AAGA,QAAIG,aAAa,GAAG,SAAhBA,aAAgB,CAAUJ,MAAV,EAAkB;AACpC,aAAOA,MAAM,CAACC,QAAP,CAAgB,mBAAhB,EAAqC,EAArC,EAAyC,QAAzC,CAAP;AACD,KAFD;;AAGA,QAAII,YAAY,GAAG,SAAfA,YAAe,CAAUL,MAAV,EAAkB;AACnC,aAAOA,MAAM,CAACC,QAAP,CAAgB,kBAAhB,CAAP;AACD,KAFD;;AAGA,QAAIZ,cAAc,GAAG,SAAjBA,cAAiB,CAAUW,MAAV,EAAkB;AACrC,aAAOA,MAAM,CAACC,QAAP,CAAgB,mBAAhB,EAAqC,IAArC,EAA2C,SAA3C,CAAP;AACD,KAFD;;AAGA,QAAIX,aAAa,GAAG,SAAhBA,aAAgB,CAAUU,MAAV,EAAkB;AACpC,aAAOA,MAAM,CAACC,QAAP,CAAgB,aAAhB,EAA+B,KAA/B,EAAsC,SAAtC,CAAP;AACD,KAFD;;AAGA,QAAIR,eAAe,GAAG,SAAlBA,eAAkB,CAAUO,MAAV,EAAkB;AACtC,aAAOA,MAAM,CAACC,QAAP,CAAgB,eAAhB,EAAiC,KAAjC,EAAwC,SAAxC,CAAP;AACD,KAFD;;AAGA,QAAIK,YAAY,GAAG,SAAfA,YAAe,CAAUN,MAAV,EAAkB;AACnC,aAAOA,MAAM,CAACC,QAAP,CAAgB,YAAhB,EAA8B,KAA9B,CAAP;AACD,KAFD;;AAGA,QAAIM,YAAY,GAAG,SAAfA,YAAe,CAAUP,MAAV,EAAkB;AACnC,aAAO,CAAC,CAACQ,YAAY,CAACR,MAAD,CAArB;AACD,KAFD;;AAGA,QAAIS,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUT,MAAV,EAAkB;AACvC,aAAO,CAAC,CAACU,gBAAgB,CAACV,MAAD,CAAzB;AACD,KAFD;;AAGA,QAAIQ,YAAY,GAAG,SAAfA,YAAe,CAAUR,MAAV,EAAkB;AACnC,aAAOA,MAAM,CAACC,QAAP,CAAgB,mBAAhB,EAAqC,EAArC,EAAyC,QAAzC,CAAP;AACD,KAFD;;AAGA,QAAIS,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUV,MAAV,EAAkB;AACvC,aAAOA,MAAM,CAACC,QAAP,CAAgB,uBAAhB,EAAyC/L,SAAzC,EAAoD,UAApD,CAAP;AACD,KAFD;;AAGA,QAAIyM,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUX,MAAV,EAAkB;AACxC,aAAOA,MAAM,CAACC,QAAP,CAAgB,yBAAhB,EAA2C/L,SAA3C,EAAsD,QAAtD,CAAP;AACD,KAFD;;AAGA,QAAI0M,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAUZ,MAAV,EAAkB;AAC3C,aAAOA,MAAM,CAACC,QAAP,CAAgB,2BAAhB,EAA6C,KAA7C,EAAoD,SAApD,CAAP;AACD,KAFD;;AAGA,QAAIY,QAAQ,GAAG;AACbtB,MAAAA,aAAa,EAAEA,aADF;AAEbY,MAAAA,YAAY,EAAEA,YAFD;AAGbD,MAAAA,SAAS,EAAEA,SAHE;AAIbE,MAAAA,aAAa,EAAEA,aAJF;AAKbC,MAAAA,YAAY,EAAEA,YALD;AAMbhB,MAAAA,cAAc,EAAEA,cANH;AAObC,MAAAA,aAAa,EAAEA,aAPF;AAQbG,MAAAA,eAAe,EAAEA,eARJ;AASba,MAAAA,YAAY,EAAEA,YATD;AAUbC,MAAAA,YAAY,EAAEA,YAVD;AAWbE,MAAAA,gBAAgB,EAAEA,gBAXL;AAYbD,MAAAA,YAAY,EAAEA,YAZD;AAabE,MAAAA,gBAAgB,EAAEA,gBAbL;AAcbC,MAAAA,iBAAiB,EAAEA,iBAdN;AAebC,MAAAA,oBAAoB,EAAEA;AAfT,KAAf;;AAkBA,QAAIE,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUC,IAAV,EAAgBC,IAAhB,EAAsB;AAC5C,aAAOC,IAAI,CAACC,GAAL,CAASC,QAAQ,CAACJ,IAAD,EAAO,EAAP,CAAjB,EAA6BI,QAAQ,CAACH,IAAD,EAAO,EAAP,CAArC,CAAP;AACD,KAFD;;AAGH,QAAII,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUL,IAAV,EAAgBC,IAAhB,EAAsB;AAC5C,aAAOC,IAAI,CAACI,GAAL,CAASF,QAAQ,CAACJ,IAAD,EAAO,EAAP,CAAjB,EAA6BI,QAAQ,CAACH,IAAD,EAAO,EAAP,CAArC,CAAP;AACD,KAFD;;AAGG,QAAIM,YAAY,GAAG,SAAfA,YAAe,CAAUnD,GAAV,EAAehF,QAAf,EAAyB;AAC1C,UAAIoI,GAAG,GAAGlP,UAAU,CAACmP,QAAX,CAAoBC,aAApB,CAAkC,KAAlC,CAAV;;AACA,UAAIC,IAAI,GAAG,SAAPA,IAAO,CAAUC,UAAV,EAAsB;AAC/B,YAAIJ,GAAG,CAACK,UAAR,EAAoB;AAClBL,UAAAA,GAAG,CAACK,UAAJ,CAAeC,WAAf,CAA2BN,GAA3B;AACD;;AACDpI,QAAAA,QAAQ,CAACwI,UAAD,CAAR;AACD,OALD;;AAMAJ,MAAAA,GAAG,CAACO,MAAJ,GAAa,YAAY;AAC7B,YAAIC,KAAK,GAAG,CAAZ;AACA,YAAIC,MAAM,GAAG,CAAb;AACM,YAAIC,MAAM,GAAGnB,iBAAiB,CAACS,GAAG,CAACQ,KAAL,EAAYR,GAAG,CAACW,WAAhB,CAA9B;AACA,YAAIC,OAAO,GAAGrB,iBAAiB,CAACS,GAAG,CAACS,MAAL,EAAaT,GAAG,CAACa,YAAjB,CAA/B;AACN,YAAIC,IAAI,GAAGJ,MAAM,GAACE,OAAlB;;AACA,YAAGF,MAAM,GAAC,GAAV,EAAe;AACdF,UAAAA,KAAK,GAAGX,iBAAiB,CAACa,MAAD,EAAS,GAAT,CAAzB;AACAD,UAAAA,MAAM,GAAGD,KAAK,GAACM,IAAf;AACA,SAHD,MAGK;AACJN,UAAAA,KAAK,GAAGE,MAAR;AACAD,UAAAA,MAAM,GAAGG,OAAT;AACA;;AACK,YAAIR,UAAU,GAAG;AACfI,UAAAA,KAAK,EAAEA,KADQ;AAEfC,UAAAA,MAAM,EAAEA;AAFO,SAAjB;AAIAN,QAAAA,IAAI,CAAC7G,MAAM,CAAChI,KAAP,CAAa8O,UAAb,CAAD,CAAJ;AACD,OAlBD;;AAmBAJ,MAAAA,GAAG,CAACe,OAAJ,GAAc,YAAY;AACxBZ,QAAAA,IAAI,CAAC7G,MAAM,CAACL,KAAP,CAAa,yCAAyC2D,GAAtD,CAAD,CAAJ;AACD,OAFD;;AAGA,UAAIoE,KAAK,GAAGhB,GAAG,CAACgB,KAAhB;AACAA,MAAAA,KAAK,CAACC,UAAN,GAAmB,QAAnB;AACAD,MAAAA,KAAK,CAACE,QAAN,GAAiB,OAAjB;AACAF,MAAAA,KAAK,CAACG,MAAN,GAAeH,KAAK,CAACI,IAAN,GAAa,KAA5B;AACAJ,MAAAA,KAAK,CAACR,KAAN,GAAcQ,KAAK,CAACP,MAAN,GAAe,MAA7B;AACA3P,MAAAA,UAAU,CAACmP,QAAX,CAAoBoB,IAApB,CAAyBC,WAAzB,CAAqCtB,GAArC;AACAA,MAAAA,GAAG,CAACuB,GAAJ,GAAU3E,GAAV;AACD,KArCD;;AAsCA,QAAI4E,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUlQ,KAAV,EAAiB;AACvC,UAAIA,KAAJ,EAAW;AACTA,QAAAA,KAAK,GAAGA,KAAK,CAACmQ,OAAN,CAAc,KAAd,EAAqB,EAArB,CAAR;AACD;;AACD,aAAOnQ,KAAP;AACD,KALD;;AAMA,QAAIoQ,cAAc,GAAG,SAAjBA,cAAiB,CAAUpQ,KAAV,EAAiB;AACpC,UAAIA,KAAK,CAAC4E,MAAN,GAAe,CAAf,IAAoB,WAAWyL,IAAX,CAAgBrQ,KAAhB,CAAxB,EAAgD;AAC9CA,QAAAA,KAAK,IAAI,IAAT;AACD;;AACD,aAAOA,KAAP;AACD,KALD;;AAMA,QAAIsQ,YAAY,GAAG,SAAfA,YAAe,CAAUC,GAAV,EAAe;AAChC,UAAIA,GAAG,CAACC,MAAR,EAAgB;AACd,YAAIC,WAAW,GAAGxM,MAAM,CAACsM,GAAG,CAACC,MAAL,CAAN,CAAmBvF,KAAnB,CAAyB,GAAzB,CAAlB;;AACA,gBAAQwF,WAAW,CAAC7L,MAApB;AACA,eAAK,CAAL;AACE2L,YAAAA,GAAG,CAAC,YAAD,CAAH,GAAoBA,GAAG,CAAC,YAAD,CAAH,IAAqBE,WAAW,CAAC,CAAD,CAApD;AACAF,YAAAA,GAAG,CAAC,cAAD,CAAH,GAAsBA,GAAG,CAAC,cAAD,CAAH,IAAuBE,WAAW,CAAC,CAAD,CAAxD;AACAF,YAAAA,GAAG,CAAC,eAAD,CAAH,GAAuBA,GAAG,CAAC,eAAD,CAAH,IAAwBE,WAAW,CAAC,CAAD,CAA1D;AACAF,YAAAA,GAAG,CAAC,aAAD,CAAH,GAAqBA,GAAG,CAAC,aAAD,CAAH,IAAsBE,WAAW,CAAC,CAAD,CAAtD;AACA;;AACF,eAAK,CAAL;AACEF,YAAAA,GAAG,CAAC,YAAD,CAAH,GAAoBA,GAAG,CAAC,YAAD,CAAH,IAAqBE,WAAW,CAAC,CAAD,CAApD;AACAF,YAAAA,GAAG,CAAC,cAAD,CAAH,GAAsBA,GAAG,CAAC,cAAD,CAAH,IAAuBE,WAAW,CAAC,CAAD,CAAxD;AACAF,YAAAA,GAAG,CAAC,eAAD,CAAH,GAAuBA,GAAG,CAAC,eAAD,CAAH,IAAwBE,WAAW,CAAC,CAAD,CAA1D;AACAF,YAAAA,GAAG,CAAC,aAAD,CAAH,GAAqBA,GAAG,CAAC,aAAD,CAAH,IAAsBE,WAAW,CAAC,CAAD,CAAtD;AACA;;AACF,eAAK,CAAL;AACEF,YAAAA,GAAG,CAAC,YAAD,CAAH,GAAoBA,GAAG,CAAC,YAAD,CAAH,IAAqBE,WAAW,CAAC,CAAD,CAApD;AACAF,YAAAA,GAAG,CAAC,cAAD,CAAH,GAAsBA,GAAG,CAAC,cAAD,CAAH,IAAuBE,WAAW,CAAC,CAAD,CAAxD;AACAF,YAAAA,GAAG,CAAC,eAAD,CAAH,GAAuBA,GAAG,CAAC,eAAD,CAAH,IAAwBE,WAAW,CAAC,CAAD,CAA1D;AACAF,YAAAA,GAAG,CAAC,aAAD,CAAH,GAAqBA,GAAG,CAAC,aAAD,CAAH,IAAsBE,WAAW,CAAC,CAAD,CAAtD;AACA;;AACF,eAAK,CAAL;AACEF,YAAAA,GAAG,CAAC,YAAD,CAAH,GAAoBA,GAAG,CAAC,YAAD,CAAH,IAAqBE,WAAW,CAAC,CAAD,CAApD;AACAF,YAAAA,GAAG,CAAC,cAAD,CAAH,GAAsBA,GAAG,CAAC,cAAD,CAAH,IAAuBE,WAAW,CAAC,CAAD,CAAxD;AACAF,YAAAA,GAAG,CAAC,eAAD,CAAH,GAAuBA,GAAG,CAAC,eAAD,CAAH,IAAwBE,WAAW,CAAC,CAAD,CAA1D;AACAF,YAAAA,GAAG,CAAC,aAAD,CAAH,GAAqBA,GAAG,CAAC,aAAD,CAAH,IAAsBE,WAAW,CAAC,CAAD,CAAtD;AAvBF;;AAyBA,eAAOF,GAAG,CAACC,MAAX;AACD;;AACD,aAAOD,GAAP;AACD,KA/BD;;AAgCA,QAAIG,eAAe,GAAG,SAAlBA,eAAkB,CAAUvD,MAAV,EAAkB7G,QAAlB,EAA4B;AAChD,UAAI2F,SAAS,GAAG+B,QAAQ,CAACP,YAAT,CAAsBN,MAAtB,CAAhB;;AACA,UAAI,OAAOlB,SAAP,KAAqB,QAAzB,EAAmC;AACjCiB,QAAAA,QAAQ,CAACyD,IAAT,CAAc;AACZrF,UAAAA,GAAG,EAAEW,SADO;AAEZ2E,UAAAA,OAAO,EAAE,iBAAUC,IAAV,EAAgB;AACvBvK,YAAAA,QAAQ,CAACwK,IAAI,CAACC,KAAL,CAAWF,IAAX,CAAD,CAAR;AACD;AAJW,SAAd;AAMD,OAPD,MAOO,IAAI,OAAO5E,SAAP,KAAqB,UAAzB,EAAqC;AAC1CA,QAAAA,SAAS,CAAC3F,QAAD,CAAT;AACD,OAFM,MAEA;AACLA,QAAAA,QAAQ,CAAC2F,SAAD,CAAR;AACD;AACF,KAdD;;AAeA,QAAI+E,aAAa,GAAG,SAAhBA,aAAgB,CAAU7D,MAAV,EAAkBxH,IAAlB,EAAwBsL,MAAxB,EAAgC;AAClD,UAAIC,WAAW,GAAG,SAAdA,WAAc,GAAY;AAC5BD,QAAAA,MAAM,CAAChC,MAAP,GAAgBgC,MAAM,CAACxB,OAAP,GAAiB,IAAjC;;AACA,YAAItC,MAAM,CAACgE,SAAX,EAAsB;AACpBhE,UAAAA,MAAM,CAACgE,SAAP,CAAiBC,MAAjB,CAAwBH,MAAxB;AACA9D,UAAAA,MAAM,CAACkE,WAAP;AACD;AACF,OAND;;AAOAJ,MAAAA,MAAM,CAAChC,MAAP,GAAgB,YAAY;AAC1B,YAAI,CAACtJ,IAAI,CAACuJ,KAAN,IAAe,CAACvJ,IAAI,CAACwJ,MAArB,IAA+BnB,QAAQ,CAACtB,aAAT,CAAuBS,MAAvB,CAAnC,EAAmE;AACjEA,UAAAA,MAAM,CAACmE,GAAP,CAAWC,UAAX,CAAsBN,MAAtB,EAA8B;AAC5B/B,YAAAA,KAAK,EAAEjL,MAAM,CAACgN,MAAM,CAAC5B,WAAR,CADe;AAE5BF,YAAAA,MAAM,EAAElL,MAAM,CAACgN,MAAM,CAAC1B,YAAR;AAFc,WAA9B;AAID;;AACD2B,QAAAA,WAAW;AACZ,OARD;;AASAD,MAAAA,MAAM,CAACxB,OAAP,GAAiByB,WAAjB;AACD,KAlBD;;AAmBA,QAAIM,aAAa,GAAG,SAAhBA,aAAgB,CAAUhG,IAAV,EAAgB;AAClC,aAAO,IAAIyB,QAAJ,CAAa,UAAUpN,OAAV,EAAmB4R,MAAnB,EAA2B;AAC7C,YAAIC,MAAM,GAAG1E,UAAU,EAAvB;;AACA0E,QAAAA,MAAM,CAACzC,MAAP,GAAgB,YAAY;AAC1BpP,UAAAA,OAAO,CAAC6R,MAAM,CAAC1I,MAAR,CAAP;AACD,SAFD;;AAGA0I,QAAAA,MAAM,CAACjC,OAAP,GAAiB,YAAY;AAC3BgC,UAAAA,MAAM,CAACC,MAAM,CAAC/J,KAAP,CAAaC,OAAd,CAAN;AACD,SAFD;;AAGA8J,QAAAA,MAAM,CAACC,aAAP,CAAqBnG,IAArB;AACD,OATM,CAAP;AAUD,KAXD;;AAYA,QAAIoG,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUX,MAAV,EAAkB;AACzC,aAAOA,MAAM,CAACY,QAAP,KAAoB,KAApB,KAA8BZ,MAAM,CAACa,YAAP,CAAoB,iBAApB,KAA0Cb,MAAM,CAACa,YAAP,CAAoB,sBAApB,CAAxE,CAAP;AACD,KAFD;;AAGA,QAAIC,KAAK,GAAG;AACVtD,MAAAA,YAAY,EAAEA,YADJ;AAEVyB,MAAAA,iBAAiB,EAAEA,iBAFT;AAGVE,MAAAA,cAAc,EAAEA,cAHN;AAIVE,MAAAA,YAAY,EAAEA,YAJJ;AAKVI,MAAAA,eAAe,EAAEA,eALP;AAMVM,MAAAA,aAAa,EAAEA,aANL;AAOVQ,MAAAA,aAAa,EAAEA,aAPL;AAQVI,MAAAA,kBAAkB,EAAEA;AARV,KAAZ;AAWA,QAAII,QAAQ,GAAGtS,OAAO,CAACC,IAAR,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,sBAA3B,CAAf;AAEA,QAAIoS,GAAG,GAAGD,QAAQ,CAACC,GAAnB;;AACA,QAAIC,SAAS,GAAG,SAAZA,SAAY,CAAU3S,KAAV,EAAiB;AAC/B,UAAIA,KAAK,CAACmQ,KAAN,CAAYyC,UAAZ,IAA0B5S,KAAK,CAACmQ,KAAN,CAAY0C,WAAtC,IAAqD7S,KAAK,CAACmQ,KAAN,CAAYyC,UAAZ,KAA2B5S,KAAK,CAACmQ,KAAN,CAAY0C,WAAhG,EAA6G;AAC3G,eAAOL,KAAK,CAAC7B,iBAAN,CAAwB3Q,KAAK,CAACmQ,KAAN,CAAYyC,UAApC,CAAP;AACD,OAFD,MAEO;AACL,eAAO,EAAP;AACD;AACF,KAND;;AAOA,QAAIE,SAAS,GAAG,SAAZA,SAAY,CAAU9S,KAAV,EAAiB;AAC/B,UAAIA,KAAK,CAACmQ,KAAN,CAAY4C,SAAZ,IAAyB/S,KAAK,CAACmQ,KAAN,CAAY6C,YAArC,IAAqDhT,KAAK,CAACmQ,KAAN,CAAY4C,SAAZ,KAA0B/S,KAAK,CAACmQ,KAAN,CAAY6C,YAA/F,EAA6G;AAC3G,eAAOR,KAAK,CAAC7B,iBAAN,CAAwB3Q,KAAK,CAACmQ,KAAN,CAAY4C,SAApC,CAAP;AACD,OAFD,MAEO;AACL,eAAO,EAAP;AACD;AACF,KAND;;AAOA,QAAIE,SAAS,GAAG,SAAZA,SAAY,CAAUjT,KAAV,EAAiB;AAC/B,UAAIA,KAAK,CAACmQ,KAAN,CAAY+C,WAAhB,EAA6B;AAC3B,eAAOV,KAAK,CAAC7B,iBAAN,CAAwB3Q,KAAK,CAACmQ,KAAN,CAAY+C,WAApC,CAAP;AACD,OAFD,MAEO;AACL,eAAO,EAAP;AACD;AACF,KAND;;AAOA,QAAIC,SAAS,GAAG,SAAZA,SAAY,CAAUnT,KAAV,EAAiB4L,IAAjB,EAAuB;AACrC,UAAI5L,KAAK,CAACuS,YAAN,CAAmB3G,IAAnB,CAAJ,EAA8B;AAC5B,eAAO5L,KAAK,CAACoT,YAAN,CAAmBxH,IAAnB,CAAP;AACD,OAFD,MAEO;AACL,eAAO,EAAP;AACD;AACF,KAND;;AAOA,QAAIyH,QAAQ,GAAG,SAAXA,QAAW,CAAUrT,KAAV,EAAiB4L,IAAjB,EAAuB;AACpC,aAAO5L,KAAK,CAACmQ,KAAN,CAAYvE,IAAZ,IAAoB5L,KAAK,CAACmQ,KAAN,CAAYvE,IAAZ,CAApB,GAAwC,EAA/C;AACD,KAFD;;AAGA,QAAI0H,UAAU,GAAG,SAAbA,UAAa,CAAUtT,KAAV,EAAiB;AAChC,aAAOA,KAAK,CAACwP,UAAN,KAAqB,IAArB,IAA6BxP,KAAK,CAACwP,UAAN,CAAiB8C,QAAjB,KAA8B,QAAlE;AACD,KAFD;;AAGA,QAAIiB,SAAS,GAAG,SAAZA,SAAY,CAAUvT,KAAV,EAAiB4L,IAAjB,EAAuBnL,KAAvB,EAA8B;AAC5CT,MAAAA,KAAK,CAACwT,YAAN,CAAmB5H,IAAnB,EAAyBnL,KAAzB;AACD,KAFD;;AAGA,QAAIgT,YAAY,GAAG,SAAfA,YAAe,CAAUzT,KAAV,EAAiB;AAClC,UAAI0T,SAAS,GAAGhB,GAAG,CAACiB,MAAJ,CAAW,QAAX,EAAqB;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAArB,CAAhB;AACAlB,MAAAA,GAAG,CAACmB,WAAJ,CAAgBH,SAAhB,EAA2B1T,KAA3B;AACA0T,MAAAA,SAAS,CAACjD,WAAV,CAAsBzQ,KAAtB;AACA0T,MAAAA,SAAS,CAACjD,WAAV,CAAsBiC,GAAG,CAACiB,MAAJ,CAAW,YAAX,EAAyB;AAAEG,QAAAA,eAAe,EAAE;AAAnB,OAAzB,EAAsD,SAAtD,CAAtB;AACAJ,MAAAA,SAAS,CAACI,eAAV,GAA4B,OAA5B;AACD,KAND;;AAOA,QAAIC,YAAY,GAAG,SAAfA,YAAe,CAAU/T,KAAV,EAAiB;AAClC,UAAI0T,SAAS,GAAG1T,KAAK,CAACwP,UAAtB;AACAkD,MAAAA,GAAG,CAACmB,WAAJ,CAAgB7T,KAAhB,EAAuB0T,SAAvB;AACAhB,MAAAA,GAAG,CAACsB,MAAJ,CAAWN,SAAX;AACD,KAJD;;AAKA,QAAIO,aAAa,GAAG,SAAhBA,aAAgB,CAAUjU,KAAV,EAAiB;AACnC,UAAIsT,UAAU,CAACtT,KAAD,CAAd,EAAuB;AACrB+T,QAAAA,YAAY,CAAC/T,KAAD,CAAZ;AACD,OAFD,MAEO;AACLyT,QAAAA,YAAY,CAACzT,KAAD,CAAZ;AACD;AACF,KAND;;AAOA,QAAIkU,cAAc,GAAG,SAAjBA,cAAiB,CAAUlU,KAAV,EAAiBmU,YAAjB,EAA+B;AAClD,UAAIC,SAAS,GAAGpU,KAAK,CAACoT,YAAN,CAAmB,OAAnB,CAAhB;AACA,UAAI3S,KAAK,GAAG0T,YAAY,CAACC,SAAS,KAAK,IAAd,GAAqBA,SAArB,GAAiC,EAAlC,CAAxB;;AACA,UAAI3T,KAAK,CAAC4E,MAAN,GAAe,CAAnB,EAAsB;AACpBrF,QAAAA,KAAK,CAACwT,YAAN,CAAmB,OAAnB,EAA4B/S,KAA5B;AACAT,QAAAA,KAAK,CAACwT,YAAN,CAAmB,gBAAnB,EAAqC/S,KAArC;AACD,OAHD,MAGO;AACLT,QAAAA,KAAK,CAACqU,eAAN,CAAsB,OAAtB;AACD;AACF,KATD;;AAUA,QAAIC,OAAO,GAAG,SAAVA,OAAU,CAAU1I,IAAV,EAAgBuI,YAAhB,EAA8B;AAC1C,aAAO,UAAUnU,KAAV,EAAiB4L,IAAjB,EAAuBnL,KAAvB,EAA8B;AACnC,YAAIT,KAAK,CAACmQ,KAAN,CAAYvE,IAAZ,CAAJ,EAAuB;AACrB5L,UAAAA,KAAK,CAACmQ,KAAN,CAAYvE,IAAZ,IAAoB4G,KAAK,CAAC3B,cAAN,CAAqBpQ,KAArB,CAApB;AACAyT,UAAAA,cAAc,CAAClU,KAAD,EAAQmU,YAAR,CAAd;AACD,SAHD,MAGO;AACLZ,UAAAA,SAAS,CAACvT,KAAD,EAAQ4L,IAAR,EAAcnL,KAAd,CAAT;AACD;AACF,OAPD;AAQD,KATD;;AAUA,QAAI8T,OAAO,GAAG,SAAVA,OAAU,CAAUvU,KAAV,EAAiB4L,IAAjB,EAAuB;AACnC,UAAI5L,KAAK,CAACmQ,KAAN,CAAYvE,IAAZ,CAAJ,EAAuB;AACrB,eAAO4G,KAAK,CAAC7B,iBAAN,CAAwB3Q,KAAK,CAACmQ,KAAN,CAAYvE,IAAZ,CAAxB,CAAP;AACD,OAFD,MAEO;AACL,eAAOuH,SAAS,CAACnT,KAAD,EAAQ4L,IAAR,CAAhB;AACD;AACF,KAND;;AAOA,QAAI4I,SAAS,GAAG,SAAZA,SAAY,CAAUxU,KAAV,EAAiBS,KAAjB,EAAwB;AACtC,UAAIgU,OAAO,GAAGjC,KAAK,CAAC3B,cAAN,CAAqBpQ,KAArB,CAAd;AACAT,MAAAA,KAAK,CAACmQ,KAAN,CAAYyC,UAAZ,GAAyB6B,OAAzB;AACAzU,MAAAA,KAAK,CAACmQ,KAAN,CAAY0C,WAAZ,GAA0B4B,OAA1B;AACD,KAJD;;AAKA,QAAIC,SAAS,GAAG,SAAZA,SAAY,CAAU1U,KAAV,EAAiBS,KAAjB,EAAwB;AACtC,UAAIgU,OAAO,GAAGjC,KAAK,CAAC3B,cAAN,CAAqBpQ,KAArB,CAAd;AACAT,MAAAA,KAAK,CAACmQ,KAAN,CAAY4C,SAAZ,GAAwB0B,OAAxB;AACAzU,MAAAA,KAAK,CAACmQ,KAAN,CAAY6C,YAAZ,GAA2ByB,OAA3B;AACD,KAJD;;AAKA,QAAIE,SAAS,GAAG,SAAZA,SAAY,CAAU3U,KAAV,EAAiBS,KAAjB,EAAwB;AACtC,UAAIgU,OAAO,GAAGjC,KAAK,CAAC3B,cAAN,CAAqBpQ,KAArB,CAAd;AACAT,MAAAA,KAAK,CAACmQ,KAAN,CAAY+C,WAAZ,GAA0BuB,OAA1B;AACD,KAHD;;AAIA,QAAIG,cAAc,GAAG,SAAjBA,cAAiB,CAAU5U,KAAV,EAAiBS,KAAjB,EAAwB;AAC3CT,MAAAA,KAAK,CAACmQ,KAAN,CAAY0E,WAAZ,GAA0BpU,KAA1B;AACD,KAFD;;AAGA,QAAIqU,cAAc,GAAG,SAAjBA,cAAiB,CAAU9U,KAAV,EAAiB;AACpC,aAAOqT,QAAQ,CAACrT,KAAD,EAAQ,aAAR,CAAf;AACD,KAFD;;AAGA,QAAI+U,QAAQ,GAAG,SAAXA,QAAW,CAAUC,GAAV,EAAe;AAC5B,aAAOA,GAAG,CAAC1C,QAAJ,KAAiB,QAAxB;AACD,KAFD;;AAGA,QAAI2C,OAAO,GAAG,SAAVA,OAAU,CAAUD,GAAV,EAAe;AAC3B,aAAOA,GAAG,CAAC1C,QAAJ,KAAiB,KAAxB;AACD,KAFD;;AAGA,QAAI4C,WAAW,GAAG,SAAdA,WAAc,GAAY;AAC5B,aAAO;AACLxE,QAAAA,GAAG,EAAE,EADA;AAELyE,QAAAA,GAAG,EAAE,EAFA;AAGL5H,QAAAA,KAAK,EAAE,EAHF;AAILoC,QAAAA,KAAK,EAAE,EAJF;AAKLC,QAAAA,MAAM,EAAE,EALH;AAMLgE,QAAAA,KAAK,EAAE,EANF;AAOLzD,QAAAA,KAAK,EAAE,EAPF;AAQLnD,QAAAA,OAAO,EAAE,KARJ;AASLoI,QAAAA,MAAM,EAAE,EATH;AAULC,QAAAA,MAAM,EAAE,EAVH;AAWLC,QAAAA,MAAM,EAAE,EAXH;AAYLT,QAAAA,WAAW,EAAE;AAZR,OAAP;AAcD,KAfD;;AAgBA,QAAIU,aAAa,GAAG,SAAhBA,aAAgB,CAAUpB,YAAV,EAAwB/N,IAAxB,EAA8B;AAChD,UAAIpG,KAAK,GAAGC,UAAU,CAACmP,QAAX,CAAoBC,aAApB,CAAkC,KAAlC,CAAZ;AACAkE,MAAAA,SAAS,CAACvT,KAAD,EAAQ,OAAR,EAAiBoG,IAAI,CAAC+J,KAAtB,CAAT;;AACA,UAAIwC,SAAS,CAAC3S,KAAD,CAAT,IAAoBoG,IAAI,CAACgP,MAAL,KAAgB,EAAxC,EAA4C;AAC1CZ,QAAAA,SAAS,CAACxU,KAAD,EAAQoG,IAAI,CAACgP,MAAb,CAAT;AACD;;AACD,UAAItC,SAAS,CAAC9S,KAAD,CAAT,IAAoBoG,IAAI,CAACiP,MAAL,KAAgB,EAAxC,EAA4C;AAC1CX,QAAAA,SAAS,CAAC1U,KAAD,EAAQoG,IAAI,CAACiP,MAAb,CAAT;AACD;;AACD,UAAIpC,SAAS,CAACjT,KAAD,CAAT,IAAoBoG,IAAI,CAACkP,MAAL,KAAgB,EAAxC,EAA4C;AAC1CX,QAAAA,SAAS,CAAC3U,KAAD,EAAQoG,IAAI,CAACkP,MAAb,CAAT;AACD;;AACD,UAAIR,cAAc,CAAC9U,KAAD,CAAd,IAAyBoG,IAAI,CAACyO,WAAL,KAAqB,EAAlD,EAAsD;AACpDD,QAAAA,cAAc,CAAC5U,KAAD,EAAQoG,IAAI,CAACyO,WAAb,CAAd;AACD;;AACD,aAAOV,YAAY,CAACnU,KAAK,CAACoT,YAAN,CAAmB,OAAnB,CAAD,CAAnB;AACD,KAhBD;;AAiBA,QAAIO,MAAM,GAAG,SAATA,MAAS,CAAUQ,YAAV,EAAwB/N,IAAxB,EAA8B;AACzC,UAAIpG,KAAK,GAAGC,UAAU,CAACmP,QAAX,CAAoBC,aAApB,CAAkC,KAAlC,CAAZ;AACAmG,MAAAA,KAAK,CAACrB,YAAD,EAAehJ,KAAK,CAAC/E,IAAD,EAAO;AAAE4G,QAAAA,OAAO,EAAE;AAAX,OAAP,CAApB,EAAgDhN,KAAhD,CAAL;AACAuT,MAAAA,SAAS,CAACvT,KAAD,EAAQ,KAAR,EAAeoG,IAAI,CAAC+O,GAApB,CAAT;;AACA,UAAI/O,IAAI,CAAC4G,OAAT,EAAkB;AAChB,YAAIyI,MAAM,GAAG/C,GAAG,CAACiB,MAAJ,CAAW,QAAX,EAAqB;AAAEC,UAAAA,KAAK,EAAE;AAAT,SAArB,CAAb;AACA6B,QAAAA,MAAM,CAAChF,WAAP,CAAmBzQ,KAAnB;AACAyV,QAAAA,MAAM,CAAChF,WAAP,CAAmBiC,GAAG,CAACiB,MAAJ,CAAW,YAAX,EAAyB;AAAEG,UAAAA,eAAe,EAAE;AAAnB,SAAzB,EAAsD,SAAtD,CAAnB;AACA2B,QAAAA,MAAM,CAAC3B,eAAP,GAAyB,OAAzB;AACA,eAAO2B,MAAP;AACD,OAND,MAMO;AACL,eAAOzV,KAAP;AACD;AACF,KAbD;;AAcA,QAAI0V,IAAI,GAAG,SAAPA,IAAO,CAAUvB,YAAV,EAAwBnU,KAAxB,EAA+B;AACxC,aAAO;AACL0Q,QAAAA,GAAG,EAAEyC,SAAS,CAACnT,KAAD,EAAQ,KAAR,CADT;AAELmV,QAAAA,GAAG,EAAEhC,SAAS,CAACnT,KAAD,EAAQ,KAAR,CAFT;AAGLuN,QAAAA,KAAK,EAAE4F,SAAS,CAACnT,KAAD,EAAQ,OAAR,CAHX;AAIL2P,QAAAA,KAAK,EAAE4E,OAAO,CAACvU,KAAD,EAAQ,OAAR,CAJT;AAKL4P,QAAAA,MAAM,EAAE2E,OAAO,CAACvU,KAAD,EAAQ,QAAR,CALV;AAML4T,QAAAA,KAAK,EAAET,SAAS,CAACnT,KAAD,EAAQ,OAAR,CANX;AAOLmQ,QAAAA,KAAK,EAAEgE,YAAY,CAAChB,SAAS,CAACnT,KAAD,EAAQ,OAAR,CAAV,CAPd;AAQLgN,QAAAA,OAAO,EAAEsG,UAAU,CAACtT,KAAD,CARd;AASLoV,QAAAA,MAAM,EAAEzC,SAAS,CAAC3S,KAAD,CATZ;AAULqV,QAAAA,MAAM,EAAEvC,SAAS,CAAC9S,KAAD,CAVZ;AAWLsV,QAAAA,MAAM,EAAErC,SAAS,CAACjT,KAAD,CAXZ;AAYL6U,QAAAA,WAAW,EAAExB,QAAQ,CAACrT,KAAD,EAAQ,aAAR;AAZhB,OAAP;AAcD,KAfD;;AAgBA,QAAI2V,UAAU,GAAG,SAAbA,UAAa,CAAU3V,KAAV,EAAiB4V,OAAjB,EAA0BC,OAA1B,EAAmCjK,IAAnC,EAAyCnF,GAAzC,EAA8C;AAC7D,UAAIoP,OAAO,CAACjK,IAAD,CAAP,KAAkBgK,OAAO,CAAChK,IAAD,CAA7B,EAAqC;AACnCnF,QAAAA,GAAG,CAACzG,KAAD,EAAQ4L,IAAR,EAAciK,OAAO,CAACjK,IAAD,CAArB,CAAH;AACD;AACF,KAJD;;AAKA,QAAIkK,UAAU,GAAG,SAAbA,UAAa,CAAUrP,GAAV,EAAe0N,YAAf,EAA6B;AAC5C,aAAO,UAAUnU,KAAV,EAAiB4L,IAAjB,EAAuBnL,KAAvB,EAA8B;AACnCgG,QAAAA,GAAG,CAACzG,KAAD,EAAQS,KAAR,CAAH;AACAyT,QAAAA,cAAc,CAAClU,KAAD,EAAQmU,YAAR,CAAd;AACD,OAHD;AAID,KALD;;AAMA,QAAIqB,KAAK,GAAG,SAARA,KAAQ,CAAUrB,YAAV,EAAwB0B,OAAxB,EAAiC7V,KAAjC,EAAwC;AAClD,UAAI4V,OAAO,GAAGF,IAAI,CAACvB,YAAD,EAAenU,KAAf,CAAlB;AACA2V,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,SAA1B,EAAqC,UAAU7V,KAAV,EAAiB+V,KAAjB,EAAwBC,MAAxB,EAAgC;AAC7E,eAAO/B,aAAa,CAACjU,KAAD,CAApB;AACD,OAFS,CAAV;AAGA2V,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,KAA1B,EAAiCtC,SAAjC,CAAV;AACAoC,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,KAA1B,EAAiCtC,SAAjC,CAAV;AACAoC,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,OAA1B,EAAmCtC,SAAnC,CAAV;AACAoC,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,OAA1B,EAAmCvB,OAAO,CAAC,OAAD,EAAUH,YAAV,CAA1C,CAAV;AACAwB,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,QAA1B,EAAoCvB,OAAO,CAAC,QAAD,EAAWH,YAAX,CAA3C,CAAV;AACAwB,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,OAA1B,EAAmCtC,SAAnC,CAAV;AACAoC,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,OAA1B,EAAmCC,UAAU,CAAC,UAAU9V,KAAV,EAAiBS,KAAjB,EAAwB;AAC9E,eAAO8S,SAAS,CAACvT,KAAD,EAAQ,OAAR,EAAiBS,KAAjB,CAAhB;AACD,OAFsD,EAEpD0T,YAFoD,CAA7C,CAAV;AAGAwB,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,QAA1B,EAAoCC,UAAU,CAACtB,SAAD,EAAYL,YAAZ,CAA9C,CAAV;AACAwB,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,QAA1B,EAAoCC,UAAU,CAACpB,SAAD,EAAYP,YAAZ,CAA9C,CAAV;AACAwB,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,QAA1B,EAAoCC,UAAU,CAACnB,SAAD,EAAYR,YAAZ,CAA9C,CAAV;AACAwB,MAAAA,UAAU,CAAC3V,KAAD,EAAQ4V,OAAR,EAAiBC,OAAjB,EAA0B,aAA1B,EAAyCC,UAAU,CAAClB,cAAD,EAAiBT,YAAjB,CAAnD,CAAV;AACD,KAlBD;;AAoBA,QAAIA,YAAY,GAAG,SAAfA,YAAe,CAAUvG,MAAV,EAAkBqI,OAAlB,EAA2B;AAC5C,UAAIjF,GAAG,GAAGpD,MAAM,CAACmE,GAAP,CAAWmE,MAAX,CAAkB1E,KAAlB,CAAwByE,OAAxB,CAAV;AACA,UAAIE,SAAS,GAAG3D,KAAK,CAACzB,YAAN,CAAmBC,GAAnB,CAAhB;AACA,UAAIoF,UAAU,GAAGxI,MAAM,CAACmE,GAAP,CAAWmE,MAAX,CAAkB1E,KAAlB,CAAwB5D,MAAM,CAACmE,GAAP,CAAWmE,MAAX,CAAkBG,SAAlB,CAA4BF,SAA5B,CAAxB,CAAjB;AACA,aAAOvI,MAAM,CAACmE,GAAP,CAAWmE,MAAX,CAAkBG,SAAlB,CAA4BD,UAA5B,CAAP;AACD,KALD;;AAMA,QAAIE,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAU1I,MAAV,EAAkB;AACvC,UAAI8D,MAAM,GAAG9D,MAAM,CAACgE,SAAP,CAAiB2E,OAAjB,EAAb;AACA,UAAI7C,SAAS,GAAG9F,MAAM,CAACmE,GAAP,CAAWyE,SAAX,CAAqB9E,MAArB,EAA6B,cAA7B,CAAhB;;AACA,UAAIgC,SAAJ,EAAe;AACb,eAAO9F,MAAM,CAACmE,GAAP,CAAWF,MAAX,CAAkB,KAAlB,EAAyB6B,SAAzB,EAAoC,CAApC,CAAP;AACD;;AACD,UAAIhC,MAAM,KAAKA,MAAM,CAACY,QAAP,KAAoB,KAApB,IAA6BE,KAAK,CAACH,kBAAN,CAAyBX,MAAzB,CAAlC,CAAV,EAA+E;AAC7E,eAAO,IAAP;AACD;;AACD,aAAOA,MAAP;AACD,KAVD;;AAWA,QAAI+E,cAAc,GAAG,SAAjBA,cAAiB,CAAU7I,MAAV,EAAkB6H,MAAlB,EAA0B;AAC7C,UAAI1D,GAAG,GAAGnE,MAAM,CAACmE,GAAjB;AACA,UAAI2E,SAAS,GAAG3E,GAAG,CAACyE,SAAJ,CAAcf,MAAM,CAACjG,UAArB,EAAiC,UAAUmH,IAAV,EAAgB;AAC/D,eAAO/I,MAAM,CAACgJ,MAAP,CAAcC,oBAAd,GAAqCF,IAAI,CAACrE,QAA1C,CAAP;AACD,OAFe,EAEb1E,MAAM,CAACkJ,OAAP,EAFa,CAAhB;;AAGA,UAAIJ,SAAJ,EAAe;AACb,eAAO3E,GAAG,CAACrG,KAAJ,CAAUgL,SAAV,EAAqBjB,MAArB,CAAP;AACD,OAFD,MAEO;AACL,eAAOA,MAAP;AACD;AACF,KAVD;;AAWA,QAAIsB,0BAA0B,GAAG,SAA7BA,0BAA6B,CAAUnJ,MAAV,EAAkB;AACjD,UAAI5N,KAAK,GAAGsW,gBAAgB,CAAC1I,MAAD,CAA5B;AACA,aAAO5N,KAAK,GAAG0V,IAAI,CAAC,UAAU1E,GAAV,EAAe;AACjC,eAAOmD,YAAY,CAACvG,MAAD,EAASoD,GAAT,CAAnB;AACD,OAFkB,EAEhBhR,KAFgB,CAAP,GAEAkV,WAAW,EAFvB;AAGD,KALD;;AAMA,QAAI8B,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUpJ,MAAV,EAAkBxH,IAAlB,EAAwB;AAC/C,UAAI4O,GAAG,GAAGrB,MAAM,CAAC,UAAU3C,GAAV,EAAe;AAC9B,eAAOmD,YAAY,CAACvG,MAAD,EAASoD,GAAT,CAAnB;AACD,OAFe,EAEb5K,IAFa,CAAhB;AAGAwH,MAAAA,MAAM,CAACmE,GAAP,CAAWwB,SAAX,CAAqByB,GAArB,EAA0B,aAA1B,EAAyC,UAAzC;AACApH,MAAAA,MAAM,CAACqJ,KAAP;AACArJ,MAAAA,MAAM,CAACgE,SAAP,CAAiBsF,UAAjB,CAA4BlC,GAAG,CAACmC,SAAhC;AACA,UAAIC,WAAW,GAAGxJ,MAAM,CAACmE,GAAP,CAAWF,MAAX,CAAkB,2BAAlB,EAA+C,CAA/C,CAAlB;AACAjE,MAAAA,MAAM,CAACmE,GAAP,CAAWwB,SAAX,CAAqB6D,WAArB,EAAkC,aAAlC,EAAiD,IAAjD;;AACA,UAAIrC,QAAQ,CAACqC,WAAD,CAAZ,EAA2B;AACzB,YAAI3B,MAAM,GAAGgB,cAAc,CAAC7I,MAAD,EAASwJ,WAAT,CAA3B;AACAxJ,QAAAA,MAAM,CAACgE,SAAP,CAAiBC,MAAjB,CAAwB4D,MAAxB;AACD,OAHD,MAGO;AACL7H,QAAAA,MAAM,CAACgE,SAAP,CAAiBC,MAAjB,CAAwBuF,WAAxB;AACD;AACF,KAfD;;AAgBA,QAAIC,WAAW,GAAG,SAAdA,WAAc,CAAUzJ,MAAV,EAAkB5N,KAAlB,EAAyB;AACzC4N,MAAAA,MAAM,CAACmE,GAAP,CAAWwB,SAAX,CAAqBvT,KAArB,EAA4B,KAA5B,EAAmCA,KAAK,CAACoT,YAAN,CAAmB,KAAnB,CAAnC;AACD,KAFD;;AAGA,QAAIkE,WAAW,GAAG,SAAdA,WAAc,CAAU1J,MAAV,EAAkB5N,KAAlB,EAAyB;AACzC,UAAIA,KAAJ,EAAW;AACT,YAAIgV,GAAG,GAAGpH,MAAM,CAACmE,GAAP,CAAW7P,EAAX,CAAclC,KAAK,CAACwP,UAApB,EAAgC,cAAhC,IAAkDxP,KAAK,CAACwP,UAAxD,GAAqExP,KAA/E;AACA4N,QAAAA,MAAM,CAACmE,GAAP,CAAWiC,MAAX,CAAkBgB,GAAlB;AACApH,QAAAA,MAAM,CAACqJ,KAAP;AACArJ,QAAAA,MAAM,CAACkE,WAAP;;AACA,YAAIlE,MAAM,CAACmE,GAAP,CAAWwF,OAAX,CAAmB3J,MAAM,CAACkJ,OAAP,EAAnB,CAAJ,EAA0C;AACxClJ,UAAAA,MAAM,CAACsJ,UAAP,CAAkB,EAAlB;AACAtJ,UAAAA,MAAM,CAACgE,SAAP,CAAiB4F,iBAAjB;AACD;AACF;AACF,KAXD;;AAYA,QAAIC,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAU7J,MAAV,EAAkBxH,IAAlB,EAAwB;AACtD,UAAIpG,KAAK,GAAGsW,gBAAgB,CAAC1I,MAAD,CAA5B;AACA4H,MAAAA,KAAK,CAAC,UAAUxE,GAAV,EAAe;AACnB,eAAOmD,YAAY,CAACvG,MAAD,EAASoD,GAAT,CAAnB;AACD,OAFI,EAEF5K,IAFE,EAEIpG,KAFJ,CAAL;AAGAqX,MAAAA,WAAW,CAACzJ,MAAD,EAAS5N,KAAT,CAAX;;AACA,UAAI+U,QAAQ,CAAC/U,KAAK,CAACwP,UAAP,CAAZ,EAAgC;AAC9B,YAAIiG,MAAM,GAAGzV,KAAK,CAACwP,UAAnB;AACAiH,QAAAA,cAAc,CAAC7I,MAAD,EAAS6H,MAAT,CAAd;AACA7H,QAAAA,MAAM,CAACgE,SAAP,CAAiBC,MAAjB,CAAwB7R,KAAK,CAACwP,UAA9B;AACD,OAJD,MAIO;AACL5B,QAAAA,MAAM,CAACgE,SAAP,CAAiBC,MAAjB,CAAwB7R,KAAxB;AACAwS,QAAAA,KAAK,CAACf,aAAN,CAAoB7D,MAApB,EAA4BxH,IAA5B,EAAkCpG,KAAlC;AACD;AACF,KAdD;;AAeA,QAAI0X,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAU9J,MAAV,EAAkBxH,IAAlB,EAAwB;AAChD,UAAIpG,KAAK,GAAGsW,gBAAgB,CAAC1I,MAAD,CAA5B;;AACA,UAAI5N,KAAJ,EAAW;AACT,YAAIoG,IAAI,CAACsK,GAAT,EAAc;AACZ+G,UAAAA,yBAAyB,CAAC7J,MAAD,EAASxH,IAAT,CAAzB;AACD,SAFD,MAEO;AACLkR,UAAAA,WAAW,CAAC1J,MAAD,EAAS5N,KAAT,CAAX;AACD;AACF,OAND,MAMO,IAAIoG,IAAI,CAACsK,GAAT,EAAc;AACnBsG,QAAAA,kBAAkB,CAACpJ,MAAD,EAASxH,IAAT,CAAlB;AACD;AACF,KAXD;;AAaA,QAAIuR,OAAO,GAAG,SAAVA,OAAU,CAAUC,GAAV,EAAe/T,CAAf,EAAkB;AAC9B,WAAK,IAAIsB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyS,GAAG,CAACvS,MAAxB,EAAgCF,CAAC,EAAjC,EAAqC;AACnC,YAAIM,CAAC,GAAG5B,CAAC,CAAC+T,GAAG,CAACzS,CAAD,CAAJ,EAASA,CAAT,CAAT;;AACA,YAAIM,CAAC,CAACtD,MAAF,EAAJ,EAAgB;AACd,iBAAOsD,CAAP;AACD;AACF;;AACD,aAAOrB,MAAM,CAACjD,IAAP,EAAP;AACD,KARD;;AAUA,QAAI0W,QAAQ,GAAG1X,OAAO,CAACC,IAAR,CAAaC,KAAb,CAAmBC,OAAnB,CAA2B,oBAA3B,CAAf;;AAEA,QAAIwX,QAAQ,GAAG,SAAXA,QAAW,CAAUC,IAAV,EAAgB;AAC7B,aAAOlT,QAAQ,CAACkT,IAAI,CAACtX,KAAN,CAAR,GAAuBsX,IAAI,CAACtX,KAA5B,GAAoC,EAA3C;AACD,KAFD;;AAGA,QAAIuX,YAAY,GAAG,SAAfA,YAAe,CAAUC,IAAV,EAAgBC,YAAhB,EAA8B;AAC/C,UAAIC,GAAG,GAAG,EAAV;AACAN,MAAAA,QAAQ,CAAChV,IAAT,CAAcoV,IAAd,EAAoB,UAAUF,IAAV,EAAgB;AAClC,YAAIzG,IAAI,GAAGzM,QAAQ,CAACkT,IAAI,CAACzG,IAAN,CAAR,GAAsByG,IAAI,CAACzG,IAA3B,GAAkCzM,QAAQ,CAACkT,IAAI,CAACxK,KAAN,CAAR,GAAuBwK,IAAI,CAACxK,KAA5B,GAAoC,EAAjF;;AACA,YAAIwK,IAAI,CAACK,IAAL,KAActW,SAAlB,EAA6B;AAC3B,cAAI6K,KAAK,GAAGqL,YAAY,CAACD,IAAI,CAACK,IAAN,EAAYF,YAAZ,CAAxB;AACAC,UAAAA,GAAG,CAAC3S,IAAJ,CAAS;AACP8L,YAAAA,IAAI,EAAEA,IADC;AAEP3E,YAAAA,KAAK,EAAEA;AAFA,WAAT;AAID,SAND,MAMO;AACL,cAAIlM,KAAK,GAAGyX,YAAY,CAACH,IAAD,CAAxB;AACAI,UAAAA,GAAG,CAAC3S,IAAJ,CAAS;AACP8L,YAAAA,IAAI,EAAEA,IADC;AAEP7Q,YAAAA,KAAK,EAAEA;AAFA,WAAT;AAID;AACF,OAfD;AAgBA,aAAO0X,GAAP;AACD,KAnBD;;AAoBA,QAAIE,SAAS,GAAG,SAAZA,SAAY,CAAUC,SAAV,EAAqB;AACnC,UAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AACxBA,QAAAA,SAAS,GAAGR,QAAZ;AACD;;AACD,aAAO,UAAUG,IAAV,EAAgB;AACrB,YAAIA,IAAJ,EAAU;AACR,iBAAO7T,MAAM,CAACD,IAAP,CAAY8T,IAAZ,EAAkBtV,GAAlB,CAAsB,UAAUsV,IAAV,EAAgB;AAC3C,mBAAOD,YAAY,CAACC,IAAD,EAAOK,SAAP,CAAnB;AACD,WAFM,CAAP;AAGD,SAJD,MAIO;AACL,iBAAOlU,MAAM,CAACjD,IAAP,EAAP;AACD;AACF,OARD;AASD,KAbD;;AAcA,QAAIoX,QAAQ,GAAG,SAAXA,QAAW,CAAUN,IAAV,EAAgB;AAC7B,aAAOI,SAAS,CAACP,QAAD,CAAT,CAAoBG,IAApB,CAAP;AACD,KAFD;;AAGA,QAAIO,OAAO,GAAG,SAAVA,OAAU,CAAUT,IAAV,EAAgB;AAC5B,aAAOxU,MAAM,CAACiB,SAAP,CAAiByB,cAAjB,CAAgCzE,IAAhC,CAAqCuW,IAArC,EAA2C,OAA3C,CAAP;AACD,KAFD;;AAGA,QAAIU,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUR,IAAV,EAAgBxX,KAAhB,EAAuB;AAC7C,aAAOkX,OAAO,CAACM,IAAD,EAAO,UAAUF,IAAV,EAAgB;AACnC,YAAIS,OAAO,CAACT,IAAD,CAAX,EAAmB;AACjB,iBAAOU,iBAAiB,CAACV,IAAI,CAACpL,KAAN,EAAalM,KAAb,CAAxB;AACD,SAFD,MAEO,IAAIsX,IAAI,CAACtX,KAAL,KAAeA,KAAnB,EAA0B;AAC/B,iBAAO2D,MAAM,CAACX,IAAP,CAAYsU,IAAZ,CAAP;AACD,SAFM,MAEA;AACL,iBAAO3T,MAAM,CAACjD,IAAP,EAAP;AACD;AACF,OARa,CAAd;AASD,KAVD;;AAWA,QAAIuX,SAAS,GAAG,SAAZA,SAAY,CAAUC,OAAV,EAAmBlY,KAAnB,EAA0B;AACxC,aAAOkY,OAAO,CAAC7V,IAAR,CAAa,UAAUmV,IAAV,EAAgB;AAClC,eAAOQ,iBAAiB,CAACR,IAAD,EAAOxX,KAAP,CAAxB;AACD,OAFM,CAAP;AAGD,KAJD;;AAKA,QAAImY,SAAS,GAAG;AACdP,MAAAA,SAAS,EAAEA,SADG;AAEdE,MAAAA,QAAQ,EAAEA,QAFI;AAGdG,MAAAA,SAAS,EAAEA;AAHG,KAAhB;;AAMA,aAASG,cAAT,GAA2B;AACzB,UAAIhV,CAAC,GAAGiI,QAAQ,CAACxJ,QAAT,CAAkB,gBAAlB,CAAR;AACA,aAAO,IAAIuB,CAAJ,EAAP;AACD;;AAED,QAAIiV,QAAQ,GAAG,SAAXA,QAAW,CAAUC,KAAV,EAAiBC,KAAjB,EAAwB;AACrC,UAAID,KAAJ,EAAW;AACT,eAAOA,KAAK,CAACnI,OAAN,CAAc,KAAd,EAAqB,EAArB,IAA2B,GAA3B,GAAiCoI,KAAK,CAACpI,OAAN,CAAc,KAAd,EAAqB,EAArB,CAAxC;AACD;;AACD,aAAOoI,KAAP;AACD,KALD;;AAMA,aAASC,QAAT,CAAmBC,QAAnB,EAA6B;AAC3B,UAAIC,cAAc,GAAG,SAAjBA,cAAiB,CAAUC,QAAV,EAAoB/H,OAApB,EAA6BgI,OAA7B,EAAsCC,QAAtC,EAAgD;AACnE,YAAIC,GAAJ,EAASC,QAAT;AACAD,QAAAA,GAAG,GAAGV,cAAc,EAApB;AACAU,QAAAA,GAAG,CAACE,IAAJ,CAAS,MAAT,EAAiBP,QAAQ,CAACnN,GAA1B;AACAwN,QAAAA,GAAG,CAACG,eAAJ,GAAsBR,QAAQ,CAACS,WAA/B;;AACAJ,QAAAA,GAAG,CAACK,MAAJ,CAAWC,UAAX,GAAwB,UAAUC,CAAV,EAAa;AACnCR,UAAAA,QAAQ,CAACQ,CAAC,CAACC,MAAF,GAAWD,CAAC,CAACE,KAAb,GAAqB,GAAtB,CAAR;AACD,SAFD;;AAGAT,QAAAA,GAAG,CAACrJ,OAAJ,GAAc,YAAY;AACxBmJ,UAAAA,OAAO,CAAC,6DAA6DE,GAAG,CAACU,MAAlE,CAAP;AACD,SAFD;;AAGAV,QAAAA,GAAG,CAAC7J,MAAJ,GAAa,YAAY;AACvB,cAAIwK,IAAJ;;AACA,cAAIX,GAAG,CAACU,MAAJ,GAAa,GAAb,IAAoBV,GAAG,CAACU,MAAJ,IAAc,GAAtC,EAA2C;AACzCZ,YAAAA,OAAO,CAAC,iBAAiBE,GAAG,CAACU,MAAtB,CAAP;AACA;AACD;;AACDC,UAAAA,IAAI,GAAG3I,IAAI,CAACC,KAAL,CAAW+H,GAAG,CAACY,YAAf,CAAP;;AACA,cAAI,CAACD,IAAD,IAAS,OAAOA,IAAI,CAACE,QAAZ,KAAyB,QAAtC,EAAgD;AAC9Cf,YAAAA,OAAO,CAAC,mBAAmBE,GAAG,CAACY,YAAxB,CAAP;AACA;AACD;;AACD9I,UAAAA,OAAO,CAACyH,QAAQ,CAACI,QAAQ,CAACmB,QAAV,EAAoBH,IAAI,CAACE,QAAzB,CAAT,CAAP;AACD,SAZD;;AAaAZ,QAAAA,QAAQ,GAAG,IAAIvZ,UAAU,CAACqa,QAAf,EAAX;AACAd,QAAAA,QAAQ,CAACe,MAAT,CAAgB,MAAhB,EAAwBnB,QAAQ,CAACnN,IAAT,EAAxB,EAAyCmN,QAAQ,CAACoB,QAAT,EAAzC;AACAjB,QAAAA,GAAG,CAACnI,IAAJ,CAASoI,QAAT;AACD,OA3BD;;AA4BA,UAAIiB,UAAU,GAAG,SAAbA,UAAa,CAAUrB,QAAV,EAAoBsB,OAApB,EAA6B;AAC5C,eAAO,IAAIhN,QAAJ,CAAa,UAAUpN,OAAV,EAAmB4R,MAAnB,EAA2B;AAC7C,cAAI;AACFwI,YAAAA,OAAO,CAACtB,QAAD,EAAW9Y,OAAX,EAAoB4R,MAApB,EAA4B3R,IAA5B,CAAP;AACD,WAFD,CAEE,OAAOoa,EAAP,EAAW;AACXzI,YAAAA,MAAM,CAACyI,EAAE,CAACtS,OAAJ,CAAN;AACD;AACF,SANM,CAAP;AAOD,OARD;;AASA,UAAIuS,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUF,OAAV,EAAmB;AACxC,eAAOA,OAAO,KAAKvB,cAAnB;AACD,OAFD;;AAGA,UAAIS,MAAM,GAAG,SAATA,MAAS,CAAUR,QAAV,EAAoB;AAC/B,eAAO,CAACF,QAAQ,CAACnN,GAAV,IAAiB6O,gBAAgB,CAAC1B,QAAQ,CAACwB,OAAV,CAAjC,GAAsDhN,QAAQ,CAACwE,MAAT,CAAgB,uCAAhB,CAAtD,GAAiHuI,UAAU,CAACrB,QAAD,EAAWF,QAAQ,CAACwB,OAApB,CAAlI;AACD,OAFD;;AAGAxB,MAAAA,QAAQ,GAAGrB,QAAQ,CAACgD,MAAT,CAAgB;AACzBlB,QAAAA,WAAW,EAAE,KADY;AAEzBe,QAAAA,OAAO,EAAEvB;AAFgB,OAAhB,EAGRD,QAHQ,CAAX;AAIA,aAAO;AAAEU,QAAAA,MAAM,EAAEA;AAAV,OAAP;AACD;;AAED,QAAIkB,SAAS,GAAG,SAAZA,SAAY,CAAUxO,IAAV,EAAgB;AAC9B,aAAO;AACLiB,QAAAA,KAAK,EAAE,UADF;AAEL3B,QAAAA,IAAI,EAAE,UAFD;AAGLe,QAAAA,KAAK,EAAE,CACL;AACE/H,UAAAA,IAAI,EAAE,OADR;AAEE6H,UAAAA,KAAK,EAAE,OAFT;AAGEb,UAAAA,IAAI,EAAE;AAHR,SADK,EAML;AACEhH,UAAAA,IAAI,EAAE,MADR;AAEEwI,UAAAA,OAAO,EAAE,CAFX;AAGET,UAAAA,KAAK,EAAE,CACL;AACE/H,YAAAA,IAAI,EAAE,OADR;AAEE6H,YAAAA,KAAK,EAAE,gBAFT;AAGEb,YAAAA,IAAI,EAAE;AAHR,WADK,EAML;AACEhH,YAAAA,IAAI,EAAE,OADR;AAEE6H,YAAAA,KAAK,EAAE,kBAFT;AAGEb,YAAAA,IAAI,EAAE;AAHR,WANK,EAWL;AACEhH,YAAAA,IAAI,EAAE,OADR;AAEE6H,YAAAA,KAAK,EAAE,cAFT;AAGEb,YAAAA,IAAI,EAAE;AAHR,WAXK,EAgBL;AACEhH,YAAAA,IAAI,EAAE,WADR;AAEEgH,YAAAA,IAAI,EAAE,aAFR;AAGEa,YAAAA,KAAK,EAAE,cAHT;AAIEE,YAAAA,KAAK,EAAE,CACL;AACE2E,cAAAA,IAAI,EAAE,WADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aADK,EAKL;AACE6Q,cAAAA,IAAI,EAAE,OADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aALK,EASL;AACE6Q,cAAAA,IAAI,EAAE,QADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aATK,EAaL;AACE6Q,cAAAA,IAAI,EAAE,QADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aAbK,EAiBL;AACE6Q,cAAAA,IAAI,EAAE,QADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aAjBK,EAqBL;AACE6Q,cAAAA,IAAI,EAAE,QADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aArBK,EAyBL;AACE6Q,cAAAA,IAAI,EAAE,OADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aAzBK,EA6BL;AACE6Q,cAAAA,IAAI,EAAE,OADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aA7BK,EAiCL;AACE6Q,cAAAA,IAAI,EAAE,QADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aAjCK,EAqCL;AACE6Q,cAAAA,IAAI,EAAE,MADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aArCK,EAyCL;AACE6Q,cAAAA,IAAI,EAAE,QADR;AAEE7Q,cAAAA,KAAK,EAAE;AAFT,aAzCK;AAJT,WAhBK;AAHT,SANK;AAHF,OAAP;AAmFD,KApFD;;AAqFA,QAAIsa,MAAM,GAAG;AAAEzN,MAAAA,OAAO,EAAEwN;AAAX,KAAb;;AAEA,QAAIE,OAAO,GAAG,SAAVA,OAAU,CAAUpN,MAAV,EAAkB;AAC9B,UAAIqN,gBAAgB,GAAGrC,SAAS,CAACP,SAAV,CAAoB,UAAUN,IAAV,EAAgB;AACzD,eAAOnK,MAAM,CAACsN,UAAP,CAAkBnD,IAAI,CAACtX,KAAL,IAAcsX,IAAI,CAAChM,GAArC,EAA0C,KAA1C,CAAP;AACD,OAFsB,CAAvB;AAGA,UAAIoP,eAAe,GAAGvT,MAAM,CAAC1B,EAAP,CAAU,UAAUkE,SAAV,EAAqB;AACnDoI,QAAAA,KAAK,CAACrB,eAAN,CAAsBvD,MAAtB,EAA8B,UAAUlB,SAAV,EAAqB;AACjDtC,UAAAA,SAAS,CAAC6Q,gBAAgB,CAACvO,SAAD,CAAhB,CAA4B/J,GAA5B,CAAgC,UAAUgK,KAAV,EAAiB;AACzD,mBAAO5J,OAAO,CAAC,CACb,CAAC;AACGuO,cAAAA,IAAI,EAAE,MADT;AAEG7Q,cAAAA,KAAK,EAAE;AAFV,aAAD,CADa,EAKbkM,KALa,CAAD,CAAd;AAOD,WARS,CAAD,CAAT;AASD,SAVD;AAWD,OAZqB,CAAtB;AAaA,UAAII,SAAS,GAAG6L,SAAS,CAACL,QAAV,CAAmB9J,QAAQ,CAACR,YAAT,CAAsBL,MAAtB,CAAnB,CAAhB;AACA,UAAIE,SAAS,GAAGW,QAAQ,CAACX,SAAT,CAAmBF,MAAnB,CAAhB;AACA,UAAIG,YAAY,GAAGU,QAAQ,CAACV,YAAT,CAAsBH,MAAtB,CAAnB;AACA,UAAIO,YAAY,GAAGM,QAAQ,CAACN,YAAT,CAAsBP,MAAtB,CAAnB;AACA,UAAIS,gBAAgB,GAAGI,QAAQ,CAACJ,gBAAT,CAA0BT,MAA1B,CAAvB;AACA,UAAI5N,KAAK,GAAG+W,0BAA0B,CAACnJ,MAAD,CAAtC;AACA,UAAIX,cAAc,GAAGwB,QAAQ,CAACxB,cAAT,CAAwBW,MAAxB,CAArB;AACA,UAAIV,aAAa,GAAGuB,QAAQ,CAACvB,aAAT,CAAuBU,MAAvB,CAApB;AACA,UAAIT,aAAa,GAAGsB,QAAQ,CAACtB,aAAT,CAAuBS,MAAvB,CAApB;AACA,UAAIP,eAAe,GAAGoB,QAAQ,CAACpB,eAAT,CAAyBO,MAAzB,CAAtB;AACA,UAAI7B,GAAG,GAAG0C,QAAQ,CAACL,YAAT,CAAsBR,MAAtB,CAAV;AACA,UAAIyM,QAAQ,GAAG5L,QAAQ,CAACF,iBAAT,CAA2BX,MAA3B,CAAf;AACA,UAAI+L,WAAW,GAAGlL,QAAQ,CAACD,oBAAT,CAA8BZ,MAA9B,CAAlB;AACA,UAAI8M,OAAO,GAAGjM,QAAQ,CAACH,gBAAT,CAA0BV,MAA1B,CAAd;AACA,UAAIwN,UAAU,GAAGhX,MAAM,CAACX,IAAP,CAAYgL,QAAQ,CAACT,aAAT,CAAuBJ,MAAvB,CAAZ,EAA4C1K,MAA5C,CAAmD,UAAUmY,MAAV,EAAkB;AACpF,eAAOxW,QAAQ,CAACwW,MAAD,CAAR,IAAoBA,MAAM,CAAChW,MAAP,GAAgB,CAA3C;AACD,OAFgB,CAAjB;AAGA,aAAO8V,eAAe,CAACxY,GAAhB,CAAoB,UAAU+J,SAAV,EAAqB;AAC9C,eAAO;AACL1M,UAAAA,KAAK,EAAEA,KADF;AAEL0M,UAAAA,SAAS,EAAEA,SAFN;AAGLK,UAAAA,SAAS,EAAEA,SAHN;AAILe,UAAAA,SAAS,EAAEA,SAJN;AAKLC,UAAAA,YAAY,EAAEA,YALT;AAMLI,UAAAA,YAAY,EAAEA,YANT;AAOLE,UAAAA,gBAAgB,EAAEA,gBAPb;AAQLpB,UAAAA,cAAc,EAAEA,cARX;AASLC,UAAAA,aAAa,EAAEA,aATV;AAULC,UAAAA,aAAa,EAAEA,aAVV;AAWLE,UAAAA,eAAe,EAAEA,eAXZ;AAYLtB,UAAAA,GAAG,EAAEA,GAZA;AAaLsO,UAAAA,QAAQ,EAAEA,QAbL;AAcLV,UAAAA,WAAW,EAAEA,WAdR;AAeLe,UAAAA,OAAO,EAAEA,OAfJ;AAgBLU,UAAAA,UAAU,EAAEA;AAhBP,SAAP;AAkBD,OAnBM,CAAP;AAoBD,KAtDD;;AAwDA,QAAIE,SAAS,GAAG,SAAZA,SAAY,CAAUhP,IAAV,EAAgB;AAC9B,UAAIK,KAAK,GAAG,CAAC;AACT/H,QAAAA,IAAI,EAAE,UADG;AAETgH,QAAAA,IAAI,EAAE;AAFG,OAAD,CAAZ;AAIA,aAAO;AACL2B,QAAAA,KAAK,EAAE,QADF;AAEL3B,QAAAA,IAAI,EAAE,QAFD;AAGLe,QAAAA,KAAK,EAAEA;AAHF,OAAP;AAKD,KAVD;;AAWA,QAAI4O,SAAS,GAAG;AAAEjO,MAAAA,OAAO,EAAEgO;AAAX,KAAhB;;AAEA,QAAIE,WAAW,GAAG,SAAdA,WAAc,CAAUlP,IAAV,EAAgB;AAChC,aAAO;AACLmP,QAAAA,SAAS,EAAE7C,SAAS,CAACF,SAAV,CAAoBpM,IAAI,CAACI,SAAzB,EAAoCJ,IAAI,CAACtM,KAAL,CAAW0Q,GAA/C,CADN;AAELgL,QAAAA,OAAO,EAAEpP,IAAI,CAACtM,KAAL,CAAWmV,GAFf;AAGLsE,QAAAA,IAAI,EAAE;AAHD,OAAP;AAKD,KAND;;AAOA,QAAIkC,aAAa,GAAG,SAAhBA,aAAgB,CAAU3b,KAAV,EAAiB;AACnC,aAAO;AACL0Q,QAAAA,GAAG,EAAE;AACHjQ,UAAAA,KAAK,EAAET,KAAK,CAAC0Q,GADV;AAEHkL,UAAAA,IAAI,EAAE;AAFH,SADA;AAKLC,QAAAA,MAAM,EAAE7b,KAAK,CAAC0Q,GALT;AAMLyE,QAAAA,GAAG,EAAEnV,KAAK,CAACmV,GANN;AAOL5H,QAAAA,KAAK,EAAEvN,KAAK,CAACuN,KAPR;AAQLgC,QAAAA,UAAU,EAAE;AACVI,UAAAA,KAAK,EAAE3P,KAAK,CAAC2P,KADH;AAEVC,UAAAA,MAAM,EAAE5P,KAAK,CAAC4P;AAFJ,SARP;AAYLkM,QAAAA,OAAO,EAAE9b,KAAK,CAAC4T,KAZV;AAaL5G,QAAAA,OAAO,EAAEhN,KAAK,CAACgN,OAbV;AAcLmD,QAAAA,KAAK,EAAEnQ,KAAK,CAACmQ,KAdR;AAeLkF,QAAAA,MAAM,EAAErV,KAAK,CAACqV,MAfT;AAgBLC,QAAAA,MAAM,EAAEtV,KAAK,CAACsV,MAhBT;AAiBLF,QAAAA,MAAM,EAAEpV,KAAK,CAACoV,MAjBT;AAkBL2G,QAAAA,WAAW,EAAE/b,KAAK,CAAC6U,WAlBd;AAmBLmH,QAAAA,SAAS,EAAE;AAnBN,OAAP;AAqBD,KAtBD;;AAuBA,QAAIC,WAAW,GAAG,SAAdA,WAAc,CAAU7V,IAAV,EAAgB;AAChC,aAAO;AACLsK,QAAAA,GAAG,EAAEtK,IAAI,CAACsK,GAAL,CAASjQ,KADT;AAEL0U,QAAAA,GAAG,EAAE/O,IAAI,CAAC+O,GAFL;AAGL5H,QAAAA,KAAK,EAAEnH,IAAI,CAACmH,KAHP;AAILoC,QAAAA,KAAK,EAAEvJ,IAAI,CAACmJ,UAAL,CAAgBI,KAJlB;AAKLC,QAAAA,MAAM,EAAExJ,IAAI,CAACmJ,UAAL,CAAgBK,MALnB;AAMLgE,QAAAA,KAAK,EAAExN,IAAI,CAAC0V,OANP;AAOL3L,QAAAA,KAAK,EAAE/J,IAAI,CAAC+J,KAPP;AAQLnD,QAAAA,OAAO,EAAE5G,IAAI,CAAC4G,OART;AASLoI,QAAAA,MAAM,EAAEhP,IAAI,CAACgP,MATR;AAULC,QAAAA,MAAM,EAAEjP,IAAI,CAACiP,MAVR;AAWLC,QAAAA,MAAM,EAAElP,IAAI,CAACkP,MAXR;AAYLT,QAAAA,WAAW,EAAEzO,IAAI,CAAC2V;AAZb,OAAP;AAcD,KAfD;;AAgBA,QAAIG,cAAc,GAAG,SAAjBA,cAAiB,CAAU5P,IAAV,EAAgB6P,MAAhB,EAAwB;AAC3C,UAAI,CAAC,uBAAuBrL,IAAvB,CAA4BqL,MAA5B,CAAL,EAA0C;AACxC,eAAO7P,IAAI,CAAC8O,UAAL,CAAgBtY,IAAhB,CAAqB,UAAUsZ,UAAV,EAAsB;AAChD,cAAID,MAAM,CAACE,SAAP,CAAiB,CAAjB,EAAoBD,UAAU,CAAC/W,MAA/B,MAA2C+W,UAA/C,EAA2D;AACzD,mBAAOhY,MAAM,CAACX,IAAP,CAAY2Y,UAAU,GAAGD,MAAzB,CAAP;AACD;;AACD,iBAAO/X,MAAM,CAACjD,IAAP,EAAP;AACD,SALM,CAAP;AAMD;;AACD,aAAOiD,MAAM,CAACjD,IAAP,EAAP;AACD,KAVD;;AAWA,QAAImb,aAAa,GAAG,SAAhBA,aAAgB,CAAUhQ,IAAV,EAAgBiQ,GAAhB,EAAqB;AACvC,UAAInW,IAAI,GAAGmW,GAAG,CAACC,OAAJ,EAAX;AACAN,MAAAA,cAAc,CAAC5P,IAAD,EAAOlG,IAAI,CAACsK,GAAL,CAASjQ,KAAhB,CAAd,CAAqCoC,IAArC,CAA0C,UAAUsZ,MAAV,EAAkB;AAC1DI,QAAAA,GAAG,CAACE,OAAJ,CAAY;AACV/L,UAAAA,GAAG,EAAE;AACHjQ,YAAAA,KAAK,EAAE0b,MADJ;AAEHP,YAAAA,IAAI,EAAExV,IAAI,CAACsK,GAAL,CAASkL;AAFZ;AADK,SAAZ;AAMD,OAPD;AAQD,KAVD;;AAWA,QAAIc,iBAAiB,GAAG,SAApBA,iBAAoB,CAAUpQ,IAAV,EAAgBlG,IAAhB,EAAsBwV,IAAtB,EAA4B;AAClD,UAAItP,IAAI,CAACW,cAAL,IAAuBpI,QAAQ,CAAC+W,IAAI,CAACzG,GAAN,CAAnC,EAA+C;AAC7C/O,QAAAA,IAAI,CAAC+O,GAAL,GAAWyG,IAAI,CAACzG,GAAhB;AACD;;AACD,UAAI7I,IAAI,CAACY,aAAL,IAAsBrI,QAAQ,CAAC+W,IAAI,CAACrO,KAAN,CAAlC,EAAgD;AAC9CnH,QAAAA,IAAI,CAACmH,KAAL,GAAaqO,IAAI,CAACrO,KAAlB;AACD;;AACD,UAAIjB,IAAI,CAACa,aAAT,EAAwB;AACtB,YAAItI,QAAQ,CAAC+W,IAAI,CAACjM,KAAN,CAAZ,EAA0B;AACxBvJ,UAAAA,IAAI,CAACmJ,UAAL,CAAgBI,KAAhB,GAAwBiM,IAAI,CAACjM,KAA7B;AACD;;AACD,YAAI9K,QAAQ,CAAC+W,IAAI,CAAChM,MAAN,CAAZ,EAA2B;AACzBxJ,UAAAA,IAAI,CAACmJ,UAAL,CAAgBK,MAAhB,GAAyBgM,IAAI,CAAChM,MAA9B;AACD;AACF;;AACD,UAAI/K,QAAQ,CAAC+W,IAAI,CAAChI,KAAN,CAAZ,EAA0B;AACxBgF,QAAAA,SAAS,CAACF,SAAV,CAAoBpM,IAAI,CAACS,SAAzB,EAAoC6O,IAAI,CAAChI,KAAzC,EAAgD/Q,IAAhD,CAAqD,UAAU8Z,KAAV,EAAiB;AACpEvW,UAAAA,IAAI,CAAC0V,OAAL,GAAea,KAAK,CAAClc,KAArB;AACD,SAFD;AAGD;;AACD,UAAI6L,IAAI,CAACe,eAAT,EAA0B;AACxB,YAAItI,SAAS,CAAC6W,IAAI,CAAC5O,OAAN,CAAb,EAA6B;AAC3B5G,UAAAA,IAAI,CAAC4G,OAAL,GAAe4O,IAAI,CAAC5O,OAApB;AACD;AACF;;AACD,UAAIV,IAAI,CAACwB,SAAT,EAAoB;AAClB,YAAIjJ,QAAQ,CAAC+W,IAAI,CAACvG,MAAN,CAAZ,EAA2B;AACzBjP,UAAAA,IAAI,CAACiP,MAAL,GAAcuG,IAAI,CAACvG,MAAnB;AACD;;AACD,YAAIxQ,QAAQ,CAAC+W,IAAI,CAACtG,MAAN,CAAZ,EAA2B;AACzBlP,UAAAA,IAAI,CAACkP,MAAL,GAAcsG,IAAI,CAACtG,MAAnB;AACD;;AACD,YAAIzQ,QAAQ,CAAC+W,IAAI,CAACxG,MAAN,CAAZ,EAA2B;AACzBhP,UAAAA,IAAI,CAACgP,MAAL,GAAcwG,IAAI,CAACxG,MAAnB;AACD;;AACD,YAAIvQ,QAAQ,CAAC+W,IAAI,CAACG,WAAN,CAAZ,EAAgC;AAC9B3V,UAAAA,IAAI,CAAC2V,WAAL,GAAmBH,IAAI,CAACG,WAAxB;AACD;AACF;AACF,KAvCD;;AAwCA,QAAIa,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUtQ,IAAV,EAAgBiQ,GAAhB,EAAqB;AAC1C,UAAInW,IAAI,GAAGmW,GAAG,CAACC,OAAJ,EAAX;AACA,UAAIZ,IAAI,GAAGxV,IAAI,CAACsK,GAAL,CAASkL,IAApB;;AACA,UAAIA,IAAI,KAAK9Z,SAAb,EAAwB;AACtB,YAAI+T,OAAO,GAAGlL,SAAS,CAAC,EAAD,EAAKvE,IAAL,CAAvB;AACAsW,QAAAA,iBAAiB,CAACpQ,IAAD,EAAOuJ,OAAP,EAAgB+F,IAAhB,CAAjB;AACAW,QAAAA,GAAG,CAACE,OAAJ,CAAY5G,OAAZ;AACD;AACF,KARD;;AASA,QAAIgH,kBAAkB,GAAG,SAArBA,kBAAqB,CAAUC,OAAV,EAAmBxQ,IAAnB,EAAyByQ,KAAzB,EAAgCR,GAAhC,EAAqC;AAC5D,UAAInW,IAAI,GAAGmW,GAAG,CAACC,OAAJ,EAAX;AACA,UAAIzQ,GAAG,GAAG3F,IAAI,CAACsK,GAAL,CAASjQ,KAAnB;AACA,UAAImb,IAAI,GAAGxV,IAAI,CAACsK,GAAL,CAASkL,IAAT,IAAiB,EAA5B;;AACA,UAAI,CAACA,IAAI,CAACjM,KAAN,IAAe,CAACiM,IAAI,CAAChM,MAArB,IAA+BtD,IAAI,CAACa,aAAxC,EAAuD;AACrD2P,QAAAA,OAAO,CAACE,SAAR,CAAkBjR,GAAlB,EAAuBxF,GAAvB,CAA2B,UAAUkD,MAAV,EAAkB;AAC3CA,UAAAA,MAAM,CAAC5G,IAAP,CAAY,UAAUoa,IAAV,EAAgB;AAC1B,gBAAIF,KAAK,CAACtD,IAAV,EAAgB;AACd8C,cAAAA,GAAG,CAACE,OAAJ,CAAY;AAAElN,gBAAAA,UAAU,EAAE0N;AAAd,eAAZ;AACD;AACF,WAJD;AAKD,SAND;AAOD;AACF,KAbD;;AAcA,QAAIC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAU5Q,IAAV,EAAgByQ,KAAhB,EAAuBR,GAAvB,EAA4B;AACrD,UAAInW,IAAI,GAAGmW,GAAG,CAACC,OAAJ,EAAX;AACA,UAAIxc,KAAK,GAAG4Y,SAAS,CAACF,SAAV,CAAoBpM,IAAI,CAACI,SAAzB,EAAoCtG,IAAI,CAACsK,GAAL,CAASjQ,KAA7C,CAAZ;AACAsc,MAAAA,KAAK,CAACtB,SAAN,GAAkBzb,KAAlB;AACAuc,MAAAA,GAAG,CAACE,OAAJ,CAAY;AACVZ,QAAAA,MAAM,EAAE7b,KAAK,CAAC2C,GAAN,CAAU,UAAUga,KAAV,EAAiB;AACjC,iBAAOA,KAAK,CAAClc,KAAb;AACD,SAFO,EAEL2B,KAFK,CAEC,EAFD;AADE,OAAZ;AAKD,KATD;;AAUA,QAAI+a,SAAS,GAAG,SAAZA,SAAY,CAAUL,OAAV,EAAmBxQ,IAAnB,EAAyByQ,KAAzB,EAAgCR,GAAhC,EAAqC;AACnDD,MAAAA,aAAa,CAAChQ,IAAD,EAAOiQ,GAAP,CAAb;AACAK,MAAAA,gBAAgB,CAACtQ,IAAD,EAAOiQ,GAAP,CAAhB;AACAM,MAAAA,kBAAkB,CAACC,OAAD,EAAUxQ,IAAV,EAAgByQ,KAAhB,EAAuBR,GAAvB,CAAlB;AACAW,MAAAA,oBAAoB,CAAC5Q,IAAD,EAAOyQ,KAAP,EAAcR,GAAd,CAApB;AACD,KALD;;AAMA,QAAIa,YAAY,GAAG,SAAfA,YAAe,CAAUN,OAAV,EAAmBxQ,IAAnB,EAAyByQ,KAAzB,EAAgCR,GAAhC,EAAqC;AACtD,UAAInW,IAAI,GAAGmW,GAAG,CAACC,OAAJ,EAAX;AACA,UAAIxc,KAAK,GAAG4Y,SAAS,CAACF,SAAV,CAAoBpM,IAAI,CAACI,SAAzB,EAAoCtG,IAAI,CAACyV,MAAzC,CAAZ;AACA7b,MAAAA,KAAK,CAAC6C,IAAN,CAAW,UAAUsM,GAAV,EAAe;AACxB,YAAIkO,SAAS,GAAGjX,IAAI,CAAC+O,GAAL,KAAa,EAAb,IAAmB4H,KAAK,CAACtB,SAAN,CAAgB9Y,GAAhB,CAAoB,UAAU3C,KAAV,EAAiB;AACtE,iBAAOA,KAAK,CAACsR,IAAN,KAAelL,IAAI,CAAC+O,GAA3B;AACD,SAFkC,EAEhC/S,KAFgC,CAE1B,KAF0B,CAAnC;;AAGA,YAAIib,SAAJ,EAAe;AACb,cAAIlO,GAAG,CAAC1O,KAAJ,KAAc,EAAlB,EAAsB;AACpB8b,YAAAA,GAAG,CAACE,OAAJ,CAAY;AACV/L,cAAAA,GAAG,EAAEvB,GADK;AAEVgG,cAAAA,GAAG,EAAE4H,KAAK,CAACrB;AAFD,aAAZ;AAID,WALD,MAKO;AACLa,YAAAA,GAAG,CAACE,OAAJ,CAAY;AACV/L,cAAAA,GAAG,EAAEvB,GADK;AAEVgG,cAAAA,GAAG,EAAEhG,GAAG,CAACmC;AAFC,aAAZ;AAID;AACF,SAZD,MAYO;AACLiL,UAAAA,GAAG,CAACE,OAAJ,CAAY;AAAE/L,YAAAA,GAAG,EAAEvB;AAAP,WAAZ;AACD;AACF,OAnBD;AAoBA4N,MAAAA,KAAK,CAACtB,SAAN,GAAkBzb,KAAlB;AACAmd,MAAAA,SAAS,CAACL,OAAD,EAAUxQ,IAAV,EAAgByQ,KAAhB,EAAuBR,GAAvB,CAAT;AACD,KAzBD;;AA0BA,QAAIe,UAAU,GAAG,SAAbA,UAAa,CAAUtM,GAAV,EAAe;AAC9B,UAAIuM,iBAAiB,GAAGvM,GAAG,CAAC,YAAD,CAAH,IAAqBA,GAAG,CAAC,eAAD,CAAxB,IAA6CA,GAAG,CAAC,YAAD,CAAH,KAAsBA,GAAG,CAAC,eAAD,CAA9F;AACA,aAAOuM,iBAAiB,GAAG/K,KAAK,CAAC7B,iBAAN,CAAwBjM,MAAM,CAACsM,GAAG,CAAC,YAAD,CAAJ,CAA9B,CAAH,GAAwD,EAAhF;AACD,KAHD;;AAIA,QAAIwM,UAAU,GAAG,SAAbA,UAAa,CAAUxM,GAAV,EAAe;AAC9B,UAAIyM,iBAAiB,GAAGzM,GAAG,CAAC,cAAD,CAAH,IAAuBA,GAAG,CAAC,aAAD,CAA1B,IAA6CA,GAAG,CAAC,cAAD,CAAH,KAAwBA,GAAG,CAAC,aAAD,CAAhG;AACA,aAAOyM,iBAAiB,GAAGjL,KAAK,CAAC7B,iBAAN,CAAwBjM,MAAM,CAACsM,GAAG,CAAC,cAAD,CAAJ,CAA9B,CAAH,GAA0D,EAAlF;AACD,KAHD;;AAIA,QAAI0M,eAAe,GAAG,SAAlBA,eAAkB,CAAU1M,GAAV,EAAe;AACnC,aAAOA,GAAG,CAAC,cAAD,CAAH,GAAsBwB,KAAK,CAAC7B,iBAAN,CAAwBjM,MAAM,CAACsM,GAAG,CAAC,cAAD,CAAJ,CAA9B,CAAtB,GAA6E,EAApF;AACD,KAFD;;AAGA,QAAI2M,eAAe,GAAG,SAAlBA,eAAkB,CAAU3M,GAAV,EAAe;AACnC,aAAOA,GAAG,CAAC,cAAD,CAAH,GAAsBtM,MAAM,CAACsM,GAAG,CAAC,cAAD,CAAJ,CAA5B,GAAoD,EAA3D;AACD,KAFD;;AAGA,QAAI4M,SAAS,GAAG,SAAZA,SAAY,CAAUC,UAAV,EAAsBC,cAAtB,EAAsC9M,GAAtC,EAA2C;AACzD,aAAO8M,cAAc,CAACD,UAAU,CAACC,cAAc,CAAC9M,GAAD,CAAf,CAAX,CAArB;AACD,KAFD;;AAGA,QAAI+M,YAAY,GAAG,SAAfA,YAAe,CAAUF,UAAV,EAAsBC,cAAtB,EAAsC1X,IAAtC,EAA4C;AAC7D,UAAI4K,GAAG,GAAGwB,KAAK,CAACzB,YAAN,CAAmB8M,UAAU,CAACzX,IAAI,CAAC+J,KAAN,CAA7B,CAAV;AACA,UAAI6N,QAAQ,GAAGrT,SAAS,CAAC,EAAD,EAAKvE,IAAL,CAAxB;AACA4X,MAAAA,QAAQ,CAAC3I,MAAT,GAAkBiI,UAAU,CAACtM,GAAD,CAA5B;AACAgN,MAAAA,QAAQ,CAAC5I,MAAT,GAAkBoI,UAAU,CAACxM,GAAD,CAA5B;AACAgN,MAAAA,QAAQ,CAAC1I,MAAT,GAAkBoI,eAAe,CAAC1M,GAAD,CAAjC;AACAgN,MAAAA,QAAQ,CAACjC,WAAT,GAAuB4B,eAAe,CAAC3M,GAAD,CAAtC;AACAgN,MAAAA,QAAQ,CAAC7N,KAAT,GAAiByN,SAAS,CAACC,UAAD,EAAaC,cAAb,EAA6B9M,GAA7B,CAA1B;AACA,aAAOgN,QAAP;AACD,KATD;;AAUA,QAAIC,WAAW,GAAG,SAAdA,WAAc,CAAUnB,OAAV,EAAmBP,GAAnB,EAAwB;AACxC,UAAInW,IAAI,GAAGmW,GAAG,CAACC,OAAJ,EAAX;AACA,UAAI3G,OAAO,GAAGkI,YAAY,CAACjB,OAAO,CAACe,UAAT,EAAqBf,OAAO,CAACgB,cAA7B,EAA6C1X,IAA7C,CAA1B;AACAmW,MAAAA,GAAG,CAACE,OAAJ,CAAY5G,OAAZ;AACD,KAJD;;AAKA,QAAIqI,YAAY,GAAG,SAAfA,YAAe,CAAUpB,OAAV,EAAmBxQ,IAAnB,EAAyBiQ,GAAzB,EAA8B;AAC/C,UAAInW,IAAI,GAAGuE,SAAS,CAACgR,aAAa,CAACrP,IAAI,CAACtM,KAAN,CAAd,EAA4Buc,GAAG,CAACC,OAAJ,EAA5B,CAApB;AACA,UAAIrM,KAAK,GAAGoF,aAAa,CAACuH,OAAO,CAAC3I,YAAT,EAAuB8H,WAAW,CAAC7V,IAAD,CAAlC,CAAzB;AACAmW,MAAAA,GAAG,CAACE,OAAJ,CAAY;AAAEtM,QAAAA,KAAK,EAAEA;AAAT,OAAZ;AACD,KAJD;;AAKA,QAAIgO,eAAe,GAAG,SAAlBA,eAAkB,CAAUrB,OAAV,EAAmBxQ,IAAnB,EAAyByQ,KAAzB,EAAgCR,GAAhC,EAAqC;AACzD,UAAInW,IAAI,GAAGmW,GAAG,CAACC,OAAJ,EAAX;AACAD,MAAAA,GAAG,CAAC6B,KAAJ,CAAU,iBAAV;AACAzY,MAAAA,IAAI,CAACS,IAAI,CAAC4V,SAAN,CAAJ,CAAqBha,IAArB,CAA0B,YAAY;AACpCua,QAAAA,GAAG,CAAC8B,OAAJ;AACD,OAFD,EAEG,UAAUC,IAAV,EAAgB;AACjB,YAAIC,OAAO,GAAGnS,GAAG,CAACJ,eAAJ,CAAoBsS,IAApB,CAAd;AACA,YAAIE,QAAQ,GAAGvF,QAAQ,CAAC;AACtBlN,UAAAA,GAAG,EAAEO,IAAI,CAACP,GADY;AAEtBsO,UAAAA,QAAQ,EAAE/N,IAAI,CAAC+N,QAFO;AAGtBV,UAAAA,WAAW,EAAErN,IAAI,CAACqN,WAHI;AAItBe,UAAAA,OAAO,EAAEpO,IAAI,CAACoO;AAJQ,SAAD,CAAvB;;AAMA,YAAI+D,QAAQ,GAAG,SAAXA,QAAW,GAAY;AACzBlC,UAAAA,GAAG,CAAC8B,OAAJ;AACAjS,UAAAA,GAAG,CAACF,eAAJ,CAAoBqS,OAApB;AACD,SAHD;;AAIA/L,QAAAA,KAAK,CAACP,aAAN,CAAoBqM,IAApB,EAA0BjU,IAA1B,CAA+B,UAAUqU,OAAV,EAAmB;AAChD,cAAItF,QAAQ,GAAG0D,OAAO,CAAC6B,eAAR,CAAwBL,IAAxB,EAA8BC,OAA9B,EAAuCG,OAAvC,CAAf;AACAF,UAAAA,QAAQ,CAAC5E,MAAT,CAAgBR,QAAhB,EAA0B/O,IAA1B,CAA+B,UAAU0B,GAAV,EAAe;AAC5CwQ,YAAAA,GAAG,CAACE,OAAJ,CAAY;AACV/L,cAAAA,GAAG,EAAE;AACHjQ,gBAAAA,KAAK,EAAEsL,GADJ;AAEH6P,gBAAAA,IAAI,EAAE;AAFH;AADK,aAAZ;AAMAW,YAAAA,GAAG,CAACqC,OAAJ,CAAY,SAAZ;AACAzB,YAAAA,SAAS,CAACL,OAAD,EAAUxQ,IAAV,EAAgByQ,KAAhB,EAAuBR,GAAvB,CAAT;AACAkC,YAAAA,QAAQ;AACT,WAVD,EAUGI,KAVH,CAUS,UAAUrW,GAAV,EAAe;AACtBiW,YAAAA,QAAQ;AACR3B,YAAAA,OAAO,CAACgC,QAAR,CAAiBvC,GAAjB,EAAsB/T,GAAtB;AACD,WAbD;AAcD,SAhBD;AAiBD,OA/BD;AAgCD,KAnCD;;AAoCA,QAAIuW,aAAa,GAAG,SAAhBA,aAAgB,CAAUjC,OAAV,EAAmBxQ,IAAnB,EAAyByQ,KAAzB,EAAgC;AAClD,aAAO,UAAUR,GAAV,EAAeyC,GAAf,EAAoB;AACzB,YAAIA,GAAG,CAACpT,IAAJ,KAAa,KAAjB,EAAwB;AACtBuR,UAAAA,SAAS,CAACL,OAAD,EAAUxQ,IAAV,EAAgByQ,KAAhB,EAAuBR,GAAvB,CAAT;AACD,SAFD,MAEO,IAAIyC,GAAG,CAACpT,IAAJ,KAAa,QAAjB,EAA2B;AAChCwR,UAAAA,YAAY,CAACN,OAAD,EAAUxQ,IAAV,EAAgByQ,KAAhB,EAAuBR,GAAvB,CAAZ;AACD,SAFM,MAEA,IAAIyC,GAAG,CAACpT,IAAJ,KAAa,KAAjB,EAAwB;AAC7BmR,UAAAA,KAAK,CAACrB,OAAN,GAAgBa,GAAG,CAACC,OAAJ,GAAcrH,GAA9B;AACD,SAFM,MAEA,IAAI6J,GAAG,CAACpT,IAAJ,KAAa,OAAjB,EAA0B;AAC/BqS,UAAAA,WAAW,CAACnB,OAAD,EAAUP,GAAV,CAAX;AACD,SAFM,MAEA,IAAIyC,GAAG,CAACpT,IAAJ,KAAa,QAAb,IAAyBoT,GAAG,CAACpT,IAAJ,KAAa,QAAtC,IAAkDoT,GAAG,CAACpT,IAAJ,KAAa,QAA/D,IAA2EoT,GAAG,CAACpT,IAAJ,KAAa,aAA5F,EAA2G;AAChHsS,UAAAA,YAAY,CAACpB,OAAD,EAAUxQ,IAAV,EAAgBiQ,GAAhB,CAAZ;AACD,SAFM,MAEA,IAAIyC,GAAG,CAACpT,IAAJ,KAAa,WAAjB,EAA8B;AACnCuS,UAAAA,eAAe,CAACrB,OAAD,EAAUxQ,IAAV,EAAgByQ,KAAhB,EAAuBR,GAAvB,CAAf;AACD;AACF,OAdD;AAeD,KAhBD;;AAiBA,QAAI0C,YAAY,GAAG,SAAfA,YAAe,CAAUlC,KAAV,EAAiB;AAClC,aAAO,YAAY;AACjBA,QAAAA,KAAK,CAACtD,IAAN,GAAa,KAAb;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIyF,cAAc,GAAG,SAAjBA,cAAiB,CAAU5S,IAAV,EAAgB;AACnC,UAAIA,IAAI,CAACwB,SAAL,IAAkBxB,IAAI,CAAC6B,YAAvB,IAAuC7B,IAAI,CAAC+B,gBAAhD,EAAkE;AAChE,YAAI8Q,QAAQ,GAAG;AACbva,UAAAA,IAAI,EAAE,UADO;AAEbwa,UAAAA,IAAI,EAAErc,OAAO,CAAC,CACZ,CAACyK,OAAO,CAACF,OAAR,CAAgBhB,IAAhB,CAAD,CADY,EAEZA,IAAI,CAACwB,SAAL,GAAiB,CAACiN,MAAM,CAACzN,OAAP,CAAehB,IAAf,CAAD,CAAjB,GAA0C,EAF9B,EAGZA,IAAI,CAACyB,YAAL,KAAsBzB,IAAI,CAAC6B,YAAL,IAAqB7B,IAAI,CAAC+B,gBAAhD,IAAoE,CAACkN,SAAS,CAACjO,OAAV,CAAkBhB,IAAlB,CAAD,CAApE,GAAgG,EAHpF,CAAD;AAFA,SAAf;AAQA,eAAO6S,QAAP;AACD,OAVD,MAUO;AACL,YAAIE,KAAK,GAAG;AACVza,UAAAA,IAAI,EAAE,OADI;AAEV+H,UAAAA,KAAK,EAAEa,OAAO,CAACnB,SAAR,CAAkBC,IAAlB;AAFG,SAAZ;AAIA,eAAO+S,KAAP;AACD;AACF,KAlBD;;AAmBA,QAAIC,UAAU,GAAG,SAAbA,UAAa,CAAUxC,OAAV,EAAmB;AAClC,aAAO,UAAUxQ,IAAV,EAAgB;AACrB,YAAIyQ,KAAK,GAAGvB,WAAW,CAAClP,IAAD,CAAvB;AACA,eAAO;AACLiB,UAAAA,KAAK,EAAE,mBADF;AAEL0P,UAAAA,IAAI,EAAE,QAFD;AAGLzM,UAAAA,IAAI,EAAE0O,cAAc,CAAC5S,IAAD,CAHf;AAILiT,UAAAA,OAAO,EAAE,CACP;AACE3a,YAAAA,IAAI,EAAE,QADR;AAEEgH,YAAAA,IAAI,EAAE,QAFR;AAGE0F,YAAAA,IAAI,EAAE;AAHR,WADO,EAMP;AACE1M,YAAAA,IAAI,EAAE,QADR;AAEEgH,YAAAA,IAAI,EAAE,MAFR;AAGE0F,YAAAA,IAAI,EAAE,MAHR;AAIEkO,YAAAA,OAAO,EAAE;AAJX,WANO,CAJJ;AAiBLC,UAAAA,WAAW,EAAE9D,aAAa,CAACrP,IAAI,CAACtM,KAAN,CAjBrB;AAkBL0f,UAAAA,QAAQ,EAAE5C,OAAO,CAAC4C,QAAR,CAAiBpT,IAAjB,CAlBL;AAmBLqT,UAAAA,QAAQ,EAAEZ,aAAa,CAACjC,OAAD,EAAUxQ,IAAV,EAAgByQ,KAAhB,CAnBlB;AAoBL6C,UAAAA,OAAO,EAAEX,YAAY,CAAClC,KAAD;AApBhB,SAAP;AAsBD,OAxBD;AAyBD,KA1BD;;AA2BA,QAAI8C,aAAa,GAAG,SAAhBA,aAAgB,CAAUjS,MAAV,EAAkB;AACpC,aAAO,UAAUtB,IAAV,EAAgB;AACrB,eAAO,UAAUiQ,GAAV,EAAe;AACpB,cAAInW,IAAI,GAAGuE,SAAS,CAACgR,aAAa,CAACrP,IAAI,CAACtM,KAAN,CAAd,EAA4Buc,GAAG,CAACC,OAAJ,EAA5B,CAApB;AACA5O,UAAAA,MAAM,CAACkS,WAAP,CAAmBC,QAAnB,CAA4B,YAAY;AACtCrI,YAAAA,mBAAmB,CAAC9J,MAAD,EAASqO,WAAW,CAAC7V,IAAD,CAApB,CAAnB;AACD,WAFD;AAGAwH,UAAAA,MAAM,CAACoS,YAAP,CAAoBC,gBAApB;AACA1D,UAAAA,GAAG,CAAC2D,KAAJ;AACD,SAPD;AAQD,OATD;AAUD,KAXD;;AAYA,QAAIlD,SAAS,GAAG,SAAZA,SAAY,CAAUpP,MAAV,EAAkB;AAChC,aAAO,UAAU7B,GAAV,EAAe;AACpB,eAAOzB,YAAY,CAACpE,EAAb,CAAgB,UAAUkE,SAAV,EAAqB;AAC1CoI,UAAAA,KAAK,CAACtD,YAAN,CAAmBtB,MAAM,CAACuS,eAAP,CAAuBC,UAAvB,CAAkCrU,GAAlC,CAAnB,EAA2D,UAAU3F,IAAV,EAAgB;AACzE,gBAAIqD,MAAM,GAAGrD,IAAI,CAACzD,GAAL,CAAS,UAAU4M,UAAV,EAAsB;AAC1C,qBAAO;AACLI,gBAAAA,KAAK,EAAEjL,MAAM,CAAC6K,UAAU,CAACI,KAAZ,CADR;AAELC,gBAAAA,MAAM,EAAElL,MAAM,CAAC6K,UAAU,CAACK,MAAZ;AAFT,eAAP;AAID,aALY,CAAb;AAMAxF,YAAAA,SAAS,CAACX,MAAD,CAAT;AACD,WARD;AASD,SAVM,CAAP;AAWD,OAZD;AAaD,KAdD;;AAeA,QAAIkV,eAAe,GAAG,SAAlBA,eAAkB,CAAU/Q,MAAV,EAAkB;AACtC,aAAO,UAAU0Q,IAAV,EAAgBC,OAAhB,EAAyBG,OAAzB,EAAkC;AACvC,eAAO9Q,MAAM,CAACoS,YAAP,CAAoBK,SAApB,CAA8B1M,MAA9B,CAAqC;AAC1C1H,UAAAA,IAAI,EAAEqS,IADoC;AAE1CC,UAAAA,OAAO,EAAEA,OAFiC;AAG1C3S,UAAAA,IAAI,EAAE0S,IAAI,CAAC1S,IAAL,GAAY0S,IAAI,CAAC1S,IAAL,CAAUgF,OAAV,CAAkB,WAAlB,EAA+B,EAA/B,CAAZ,GAAiD,IAHb;AAI1C0P,UAAAA,MAAM,EAAE5B,OAAO,CAAChT,KAAR,CAAc,GAAd,EAAmB,CAAnB;AAJkC,SAArC,CAAP;AAMD,OAPD;AAQD,KATD;;AAUA,QAAIoT,QAAQ,GAAG,SAAXA,QAAW,CAAUlR,MAAV,EAAkB;AAC/B,aAAO,UAAU2O,GAAV,EAAelU,OAAf,EAAwB;AAC7BuF,QAAAA,MAAM,CAAC2S,aAAP,CAAqBC,KAArB,CAA2BnY,OAA3B,EAAoCkU,GAAG,CAAC2D,KAAxC;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIO,cAAc,GAAG,SAAjBA,cAAiB,CAAU7S,MAAV,EAAkB;AACrC,aAAO,UAAUqI,OAAV,EAAmB;AACxB,eAAO9B,YAAY,CAACvG,MAAD,EAASqI,OAAT,CAAnB;AACD,OAFD;AAGD,KAJD;;AAKA,QAAI4H,UAAU,GAAG,SAAbA,UAAa,CAAUjQ,MAAV,EAAkB;AACjC,aAAO,UAAUqI,OAAV,EAAmB;AACxB,eAAOrI,MAAM,CAACmE,GAAP,CAAW8L,UAAX,CAAsB5H,OAAtB,CAAP;AACD,OAFD;AAGD,KAJD;;AAKA,QAAI6H,cAAc,GAAG,SAAjBA,cAAiB,CAAUlQ,MAAV,EAAkB;AACrC,aAAO,UAAU8S,SAAV,EAAqB9U,IAArB,EAA2B;AAChC,eAAOgC,MAAM,CAACmE,GAAP,CAAW+L,cAAX,CAA0B4C,SAA1B,EAAqC9U,IAArC,CAAP;AACD,OAFD;AAGD,KAJD;;AAKA,QAAI+U,MAAM,GAAG,SAATA,MAAS,CAAU/S,MAAV,EAAkB;AAC7B,UAAIkP,OAAO,GAAG;AACZ4C,QAAAA,QAAQ,EAAEG,aAAa,CAACjS,MAAD,CADX;AAEZoP,QAAAA,SAAS,EAAEA,SAAS,CAACpP,MAAD,CAFR;AAGZ+Q,QAAAA,eAAe,EAAEA,eAAe,CAAC/Q,MAAD,CAHpB;AAIZkR,QAAAA,QAAQ,EAAEA,QAAQ,CAAClR,MAAD,CAJN;AAKZuG,QAAAA,YAAY,EAAEsM,cAAc,CAAC7S,MAAD,CALhB;AAMZiQ,QAAAA,UAAU,EAAEA,UAAU,CAACjQ,MAAD,CANV;AAOZkQ,QAAAA,cAAc,EAAEA,cAAc,CAAClQ,MAAD;AAPlB,OAAd;;AASA,UAAI6L,IAAI,GAAG,SAAPA,IAAO,GAAY;AACrB,eAAOuB,OAAO,CAACpN,MAAD,CAAP,CAAgBjL,GAAhB,CAAoB2c,UAAU,CAACxC,OAAD,CAA9B,EAAyCvW,GAAzC,CAA6C,UAAUqa,IAAV,EAAgB;AAClEhT,UAAAA,MAAM,CAAC2S,aAAP,CAAqB9G,IAArB,CAA0BmH,IAA1B;AACD,SAFM,CAAP;AAGD,OAJD;;AAKA,aAAO;AAAEnH,QAAAA,IAAI,EAAEA;AAAR,OAAP;AACD,KAhBD;;AAkBA,QAAIoH,QAAQ,GAAG,SAAXA,QAAW,CAAUjT,MAAV,EAAkB;AAC/BA,MAAAA,MAAM,CAACkT,UAAP,CAAkB,UAAlB,EAA8BH,MAAM,CAAC/S,MAAD,CAAN,CAAe6L,IAA7C;AACD,KAFD;;AAGA,QAAIsH,QAAQ,GAAG;AAAEF,MAAAA,QAAQ,EAAEA;AAAZ,KAAf;;AAEA,QAAIG,aAAa,GAAG,SAAhBA,aAAgB,CAAUrK,IAAV,EAAgB;AAClC,UAAIsK,SAAS,GAAGtK,IAAI,CAACuK,IAAL,CAAU,OAAV,CAAhB;AACA,aAAOD,SAAS,IAAI,YAAYnQ,IAAZ,CAAiBmQ,SAAjB,CAApB;AACD,KAHD;;AAIA,QAAIE,0BAA0B,GAAG,SAA7BA,0BAA6B,CAAUpE,KAAV,EAAiB;AAChD,aAAO,UAAUqE,KAAV,EAAiB;AACtB,YAAIjc,CAAC,GAAGic,KAAK,CAAC/b,MAAd;;AACA,YAAIgc,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAU1K,IAAV,EAAgB;AAC1CA,UAAAA,IAAI,CAACuK,IAAL,CAAU,iBAAV,EAA6BnE,KAAK,GAAG,MAAH,GAAY,IAA9C;AACD,SAFD;;AAGA,eAAO5X,CAAC,EAAR,EAAY;AACV,cAAIwR,IAAI,GAAGyK,KAAK,CAACjc,CAAD,CAAhB;;AACA,cAAI6b,aAAa,CAACrK,IAAD,CAAjB,EAAyB;AACvBA,YAAAA,IAAI,CAACuK,IAAL,CAAU,iBAAV,EAA6BnE,KAAK,GAAG,OAAH,GAAa,IAA/C;AACAlF,YAAAA,QAAQ,CAAChV,IAAT,CAAc8T,IAAI,CAAC2K,MAAL,CAAY,YAAZ,CAAd,EAAyCD,qBAAzC;AACD;AACF;AACF,OAZD;AAaD,KAdD;;AAeA,QAAIE,KAAK,GAAG,SAARA,KAAQ,CAAU3T,MAAV,EAAkB;AAC5BA,MAAAA,MAAM,CAAC4T,EAAP,CAAU,SAAV,EAAqB,YAAY;AAC/B5T,QAAAA,MAAM,CAAC6T,MAAP,CAAcC,aAAd,CAA4B,QAA5B,EAAsCP,0BAA0B,CAAC,IAAD,CAAhE;AACAvT,QAAAA,MAAM,CAAC+T,UAAP,CAAkBD,aAAlB,CAAgC,QAAhC,EAA0CP,0BAA0B,CAAC,KAAD,CAApE;AACD,OAHD;AAID,KALD;;AAMA,QAAIS,aAAa,GAAG;AAAEL,MAAAA,KAAK,EAAEA;AAAT,KAApB;;AAEA,QAAIM,QAAQ,GAAG,SAAXA,QAAW,CAAUC,IAAV,EAAgBrW,KAAhB,EAAuB;AACpC,UAAIsW,GAAG,GAAGtW,KAAK,IAAIxL,UAAU,CAACmP,QAA9B;AACA,UAAI4S,GAAG,GAAGD,GAAG,CAAC1S,aAAJ,CAAkB,KAAlB,CAAV;AACA2S,MAAAA,GAAG,CAACC,SAAJ,GAAgBH,IAAhB;;AACA,UAAI,CAACE,GAAG,CAACE,aAAJ,EAAD,IAAwBF,GAAG,CAACG,UAAJ,CAAe9c,MAAf,GAAwB,CAApD,EAAuD;AACrDpF,QAAAA,UAAU,CAACmiB,OAAX,CAAmBha,KAAnB,CAAyB,uCAAzB,EAAkE0Z,IAAlE;AACA,cAAM,IAAIhhB,KAAJ,CAAU,mCAAV,CAAN;AACD;;AACD,aAAOuhB,OAAO,CAACL,GAAG,CAACG,UAAJ,CAAe,CAAf,CAAD,CAAd;AACD,KATD;;AAUA,QAAIG,OAAO,GAAG,SAAVA,OAAU,CAAUC,GAAV,EAAe9W,KAAf,EAAsB;AAClC,UAAIsW,GAAG,GAAGtW,KAAK,IAAIxL,UAAU,CAACmP,QAA9B;AACA,UAAIuH,IAAI,GAAGoL,GAAG,CAAC1S,aAAJ,CAAkBkT,GAAlB,CAAX;AACA,aAAOF,OAAO,CAAC1L,IAAD,CAAd;AACD,KAJD;;AAKA,QAAI6L,QAAQ,GAAG,SAAXA,QAAW,CAAUlR,IAAV,EAAgB7F,KAAhB,EAAuB;AACpC,UAAIsW,GAAG,GAAGtW,KAAK,IAAIxL,UAAU,CAACmP,QAA9B;AACA,UAAIuH,IAAI,GAAGoL,GAAG,CAACU,cAAJ,CAAmBnR,IAAnB,CAAX;AACA,aAAO+Q,OAAO,CAAC1L,IAAD,CAAd;AACD,KAJD;;AAKA,QAAI0L,OAAO,GAAG,SAAVA,OAAU,CAAU1L,IAAV,EAAgB;AAC5B,UAAIA,IAAI,KAAK,IAAT,IAAiBA,IAAI,KAAK7U,SAA9B,EAAyC;AACvC,cAAM,IAAIhB,KAAJ,CAAU,kCAAV,CAAN;AACD;;AACD,aAAO;AAAEiR,QAAAA,GAAG,EAAEvR,QAAQ,CAACmW,IAAD;AAAf,OAAP;AACD,KALD;;AAMA,QAAI+L,SAAS,GAAG,SAAZA,SAAY,CAAUC,MAAV,EAAkBhiB,CAAlB,EAAqBiiB,CAArB,EAAwB;AACtC,UAAIb,GAAG,GAAGY,MAAM,CAAC5Q,GAAP,EAAV;AACA,aAAO3N,MAAM,CAACD,IAAP,CAAY4d,GAAG,CAACc,gBAAJ,CAAqBliB,CAArB,EAAwBiiB,CAAxB,CAAZ,EAAwCjgB,GAAxC,CAA4C0f,OAA5C,CAAP;AACD,KAHD;;AAIA,QAAIS,OAAO,GAAG;AACZjB,MAAAA,QAAQ,EAAEA,QADE;AAEZS,MAAAA,OAAO,EAAEA,OAFG;AAGZE,MAAAA,QAAQ,EAAEA,QAHE;AAIZH,MAAAA,OAAO,EAAEA,OAJG;AAKZK,MAAAA,SAAS,EAAEA;AALC,KAAd;AAQA,QAAIK,SAAS,GAAG9iB,UAAU,CAAC+iB,IAAX,CAAgBC,cAAhC;AACA,QAAIC,aAAa,GAAGjjB,UAAU,CAAC+iB,IAAX,CAAgBG,kBAApC;AACA,QAAIC,OAAO,GAAGnjB,UAAU,CAAC+iB,IAAX,CAAgBK,YAA9B;AACA,QAAIC,QAAQ,GAAGrjB,UAAU,CAAC+iB,IAAX,CAAgBO,aAA/B;AACA,QAAIC,aAAa,GAAGvjB,UAAU,CAAC+iB,IAAX,CAAgBS,kBAApC;AACA,QAAIC,iBAAiB,GAAGzjB,UAAU,CAAC+iB,IAAX,CAAgBW,sBAAxC;AACA,QAAIC,OAAO,GAAG3jB,UAAU,CAAC+iB,IAAX,CAAgBa,YAA9B;AACA,QAAIC,IAAI,GAAG7jB,UAAU,CAAC+iB,IAAX,CAAgBe,SAA3B;AACA,QAAIC,sBAAsB,GAAG/jB,UAAU,CAAC+iB,IAAX,CAAgBiB,2BAA7C;AACA,QAAIC,gBAAgB,GAAGjkB,UAAU,CAAC+iB,IAAX,CAAgBmB,qBAAvC;AACA,QAAIC,MAAM,GAAGnkB,UAAU,CAAC+iB,IAAX,CAAgBqB,WAA7B;AACA,QAAIC,QAAQ,GAAGrkB,UAAU,CAAC+iB,IAAX,CAAgBuB,aAA/B;;AAEA,QAAI3Y,IAAI,GAAG,SAAPA,IAAO,CAAU4Y,OAAV,EAAmB;AAC5B,UAAI/e,CAAC,GAAG+e,OAAO,CAACzS,GAAR,GAAcO,QAAtB;AACA,aAAO7M,CAAC,CAACgf,WAAF,EAAP;AACD,KAHD;;AAKA,QAAIC,SAAS,GAAG,SAAZA,SAAY,GAAY;AAC1B,UAAIC,MAAM,GAAG,EAAb;;AACA,WAAK,IAAIxd,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGpB,SAAS,CAACV,MAAhC,EAAwC8B,EAAE,EAA1C,EAA8C;AAC5Cwd,QAAAA,MAAM,CAACxd,EAAD,CAAN,GAAapB,SAAS,CAACoB,EAAD,CAAtB;AACD;;AACD,aAAO,YAAY;AACjB,YAAIyd,MAAM,GAAG,EAAb;;AACA,aAAK,IAAIzd,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGpB,SAAS,CAACV,MAAhC,EAAwC8B,EAAE,EAA1C,EAA8C;AAC5Cyd,UAAAA,MAAM,CAACzd,EAAD,CAAN,GAAapB,SAAS,CAACoB,EAAD,CAAtB;AACD;;AACD,YAAIwd,MAAM,CAACtf,MAAP,KAAkBuf,MAAM,CAACvf,MAA7B,EAAqC;AACnC,gBAAM,IAAIvE,KAAJ,CAAU,qDAAqD6jB,MAAM,CAACtf,MAA5D,GAAqE,UAArE,GAAkFuf,MAAM,CAACvf,MAAzF,GAAkG,YAA5G,CAAN;AACD;;AACD,YAAIwf,MAAM,GAAG,EAAb;AACAhiB,QAAAA,IAAI,CAAC8hB,MAAD,EAAS,UAAU/Y,IAAV,EAAgBzG,CAAhB,EAAmB;AAC9B0f,UAAAA,MAAM,CAACjZ,IAAD,CAAN,GAAepL,QAAQ,CAACokB,MAAM,CAACzf,CAAD,CAAP,CAAvB;AACD,SAFG,CAAJ;AAGA,eAAO0f,MAAP;AACD,OAbD;AAcD,KAnBD;;AAqBA,QAAIlO,IAAI,GAAG,SAAPA,IAAO,GAAY;AACrB,UAAI9S,CAAC,GAAGiI,QAAQ,CAACxJ,QAAT,CAAkB,MAAlB,CAAR;AACA,aAAOuB,CAAP;AACD,KAHD;;AAIA,QAAIihB,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAUphB,CAAV,EAAaQ,CAAb,EAAgB6gB,KAAhB,EAAuB;AACnD,aAAO,CAACrhB,CAAC,CAACohB,uBAAF,CAA0B5gB,CAA1B,IAA+B6gB,KAAhC,MAA2C,CAAlD;AACD,KAFD;;AAGA,QAAIC,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAUthB,CAAV,EAAaQ,CAAb,EAAgB;AAC9C,aAAO4gB,uBAAuB,CAACphB,CAAD,EAAIQ,CAAJ,EAAOyS,IAAI,GAAGsO,2BAAd,CAA9B;AACD,KAFD;;AAGA,QAAIC,2BAA2B,GAAG,SAA9BA,2BAA8B,CAAUxhB,CAAV,EAAaQ,CAAb,EAAgB;AAChD,aAAO4gB,uBAAuB,CAACphB,CAAD,EAAIQ,CAAJ,EAAOyS,IAAI,GAAGwO,8BAAd,CAA9B;AACD,KAFD;;AAGA,QAAInC,IAAI,GAAG;AACTgC,MAAAA,yBAAyB,EAAEA,yBADlB;AAETE,MAAAA,2BAA2B,EAAEA;AAFpB,KAAX;;AAKA,QAAIE,MAAM,GAAG,SAATA,MAAS,CAAUvhB,CAAV,EAAa;AACxB,UAAIwhB,MAAM,GAAG,KAAb;AACA,UAAI5f,CAAJ;AACA,aAAO,YAAY;AACjB,YAAIyB,IAAI,GAAG,EAAX;;AACA,aAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGpB,SAAS,CAACV,MAAhC,EAAwC8B,EAAE,EAA1C,EAA8C;AAC5CD,UAAAA,IAAI,CAACC,EAAD,CAAJ,GAAWpB,SAAS,CAACoB,EAAD,CAApB;AACD;;AACD,YAAI,CAACke,MAAL,EAAa;AACXA,UAAAA,MAAM,GAAG,IAAT;AACA5f,UAAAA,CAAC,GAAG5B,CAAC,CAAC6B,KAAF,CAAQ,IAAR,EAAcwB,IAAd,CAAJ;AACD;;AACD,eAAOzB,CAAP;AACD,OAVD;AAWD,KAdD;;AAgBA,QAAI6f,UAAU,GAAG,SAAbA,UAAa,CAAUC,OAAV,EAAmBtjB,CAAnB,EAAsB;AACrC,WAAK,IAAIkD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGogB,OAAO,CAAClgB,MAA5B,EAAoCF,CAAC,EAArC,EAAyC;AACvC,YAAIxE,CAAC,GAAG4kB,OAAO,CAACpgB,CAAD,CAAf;AACA,YAAIxE,CAAC,CAACmQ,IAAF,CAAO7O,CAAP,CAAJ,EACE,OAAOtB,CAAP;AACH;;AACD,aAAOmB,SAAP;AACD,KAPD;;AAQA,QAAI0jB,MAAM,GAAG,SAATA,MAAS,CAAUD,OAAV,EAAmBE,KAAnB,EAA0B;AACrC,UAAIhgB,CAAC,GAAG6f,UAAU,CAACC,OAAD,EAAUE,KAAV,CAAlB;AACA,UAAI,CAAChgB,CAAL,EACE,OAAO;AACLigB,QAAAA,KAAK,EAAE,CADF;AAELC,QAAAA,KAAK,EAAE;AAFF,OAAP;;AAIF,UAAIC,KAAK,GAAG,SAARA,KAAQ,CAAUzgB,CAAV,EAAa;AACvB,eAAO0gB,MAAM,CAACJ,KAAK,CAAC7U,OAAN,CAAcnL,CAAd,EAAiB,MAAMN,CAAvB,CAAD,CAAb;AACD,OAFD;;AAGA,aAAO2gB,IAAI,CAACF,KAAK,CAAC,CAAD,CAAN,EAAWA,KAAK,CAAC,CAAD,CAAhB,CAAX;AACD,KAXD;;AAYA,QAAIG,MAAM,GAAG,SAATA,MAAS,CAAUC,cAAV,EAA0BP,KAA1B,EAAiC;AAC5C,UAAIQ,YAAY,GAAGvhB,MAAM,CAAC+gB,KAAD,CAAN,CAAchB,WAAd,EAAnB;AACA,UAAIuB,cAAc,CAAC3gB,MAAf,KAA0B,CAA9B,EACE,OAAO6gB,OAAO,EAAd;AACF,aAAOV,MAAM,CAACQ,cAAD,EAAiBC,YAAjB,CAAb;AACD,KALD;;AAMA,QAAIC,OAAO,GAAG,SAAVA,OAAU,GAAY;AACxB,aAAOJ,IAAI,CAAC,CAAD,EAAI,CAAJ,CAAX;AACD,KAFD;;AAGA,QAAIA,IAAI,GAAG,SAAPA,IAAO,CAAUJ,KAAV,EAAiBC,KAAjB,EAAwB;AACjC,aAAO;AACLD,QAAAA,KAAK,EAAEA,KADF;AAELC,QAAAA,KAAK,EAAEA;AAFF,OAAP;AAID,KALD;;AAMA,QAAIQ,OAAO,GAAG;AACZjgB,MAAAA,EAAE,EAAE4f,IADQ;AAEZC,MAAAA,MAAM,EAAEA,MAFI;AAGZG,MAAAA,OAAO,EAAEA;AAHG,KAAd;AAMA,QAAIE,IAAI,GAAG,MAAX;AACA,QAAIC,MAAM,GAAG,QAAb;AACA,QAAIC,EAAE,GAAG,IAAT;AACA,QAAIC,KAAK,GAAG,OAAZ;AACA,QAAIC,OAAO,GAAG,SAAd;AACA,QAAIC,MAAM,GAAG,QAAb;;AACA,QAAIC,SAAS,GAAG,SAAZA,SAAY,CAAU9a,IAAV,EAAgB+a,OAAhB,EAAyB;AACvC,aAAO,YAAY;AACjB,eAAOA,OAAO,KAAK/a,IAAnB;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIgb,SAAS,GAAG,SAAZA,SAAY,GAAY;AAC1B,aAAOC,IAAI,CAAC;AACVF,QAAAA,OAAO,EAAE7kB,SADC;AAEVglB,QAAAA,OAAO,EAAEX,OAAO,CAACD,OAAR;AAFC,OAAD,CAAX;AAID,KALD;;AAMA,QAAIW,IAAI,GAAG,SAAPA,IAAO,CAAUva,IAAV,EAAgB;AACzB,UAAIqa,OAAO,GAAGra,IAAI,CAACqa,OAAnB;AACA,UAAIG,OAAO,GAAGxa,IAAI,CAACwa,OAAnB;AACA,aAAO;AACLH,QAAAA,OAAO,EAAEA,OADJ;AAELG,QAAAA,OAAO,EAAEA,OAFJ;AAGLC,QAAAA,MAAM,EAAEL,SAAS,CAACN,IAAD,EAAOO,OAAP,CAHZ;AAILK,QAAAA,QAAQ,EAAEN,SAAS,CAACL,MAAD,EAASM,OAAT,CAJd;AAKLM,QAAAA,IAAI,EAAEP,SAAS,CAACJ,EAAD,EAAKK,OAAL,CALV;AAMLO,QAAAA,OAAO,EAAER,SAAS,CAACH,KAAD,EAAQI,OAAR,CANb;AAOLQ,QAAAA,SAAS,EAAET,SAAS,CAACF,OAAD,EAAUG,OAAV,CAPf;AAQLS,QAAAA,QAAQ,EAAEV,SAAS,CAACD,MAAD,EAASE,OAAT;AARd,OAAP;AAUD,KAbD;;AAcA,QAAIU,OAAO,GAAG;AACZnB,MAAAA,OAAO,EAAEU,SADG;AAEZ1gB,MAAAA,EAAE,EAAE2gB,IAFQ;AAGZT,MAAAA,IAAI,EAAE5lB,QAAQ,CAAC4lB,IAAD,CAHF;AAIZC,MAAAA,MAAM,EAAE7lB,QAAQ,CAAC6lB,MAAD,CAJJ;AAKZC,MAAAA,EAAE,EAAE9lB,QAAQ,CAAC8lB,EAAD,CALA;AAMZC,MAAAA,KAAK,EAAE/lB,QAAQ,CAAC+lB,KAAD,CANH;AAOZC,MAAAA,OAAO,EAAEhmB,QAAQ,CAACgmB,OAAD,CAPL;AAQZC,MAAAA,MAAM,EAAEjmB,QAAQ,CAACimB,MAAD;AARJ,KAAd;AAWA,QAAIa,OAAO,GAAG,SAAd;AACA,QAAIC,GAAG,GAAG,KAAV;AACA,QAAIC,OAAO,GAAG,SAAd;AACA,QAAIC,KAAK,GAAG,OAAZ;AACA,QAAIC,GAAG,GAAG,KAAV;AACA,QAAIC,OAAO,GAAG,SAAd;AACA,QAAIC,OAAO,GAAG,SAAd;;AACA,QAAIC,IAAI,GAAG,SAAPA,IAAO,CAAUjc,IAAV,EAAgB+a,OAAhB,EAAyB;AAClC,aAAO,YAAY;AACjB,eAAOA,OAAO,KAAK/a,IAAnB;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIkc,SAAS,GAAG,SAAZA,SAAY,GAAY;AAC1B,aAAOC,IAAI,CAAC;AACVpB,QAAAA,OAAO,EAAE7kB,SADC;AAEVglB,QAAAA,OAAO,EAAEX,OAAO,CAACD,OAAR;AAFC,OAAD,CAAX;AAID,KALD;;AAMA,QAAI6B,IAAI,GAAG,SAAPA,IAAO,CAAUzb,IAAV,EAAgB;AACzB,UAAIqa,OAAO,GAAGra,IAAI,CAACqa,OAAnB;AACA,UAAIG,OAAO,GAAGxa,IAAI,CAACwa,OAAnB;AACA,aAAO;AACLH,QAAAA,OAAO,EAAEA,OADJ;AAELG,QAAAA,OAAO,EAAEA,OAFJ;AAGLkB,QAAAA,SAAS,EAAEH,IAAI,CAACP,OAAD,EAAUX,OAAV,CAHV;AAILsB,QAAAA,KAAK,EAAEJ,IAAI,CAACN,GAAD,EAAMZ,OAAN,CAJN;AAKLuB,QAAAA,SAAS,EAAEL,IAAI,CAACL,OAAD,EAAUb,OAAV,CALV;AAMLwB,QAAAA,KAAK,EAAEN,IAAI,CAACH,GAAD,EAAMf,OAAN,CANN;AAOLyB,QAAAA,OAAO,EAAEP,IAAI,CAACJ,KAAD,EAAQd,OAAR,CAPR;AAQL0B,QAAAA,SAAS,EAAER,IAAI,CAACF,OAAD,EAAUhB,OAAV,CARV;AASL2B,QAAAA,SAAS,EAAET,IAAI,CAACD,OAAD,EAAUjB,OAAV;AATV,OAAP;AAWD,KAdD;;AAeA,QAAI4B,eAAe,GAAG;AACpBrC,MAAAA,OAAO,EAAE4B,SADW;AAEpB5hB,MAAAA,EAAE,EAAE6hB,IAFgB;AAGpBT,MAAAA,OAAO,EAAE9mB,QAAQ,CAAC8mB,OAAD,CAHG;AAIpBC,MAAAA,GAAG,EAAE/mB,QAAQ,CAAC+mB,GAAD,CAJO;AAKpBC,MAAAA,OAAO,EAAEhnB,QAAQ,CAACgnB,OAAD,CALG;AAMpBC,MAAAA,KAAK,EAAEjnB,QAAQ,CAACinB,KAAD,CANK;AAOpBC,MAAAA,GAAG,EAAElnB,QAAQ,CAACknB,GAAD,CAPO;AAQpBC,MAAAA,OAAO,EAAEnnB,QAAQ,CAACmnB,OAAD,CARG;AASpBC,MAAAA,OAAO,EAAEpnB,QAAQ,CAAConB,OAAD;AATG,KAAtB;;AAYA,QAAIY,UAAU,GAAG,SAAbA,UAAa,CAAUC,EAAV,EAAcC,OAAd,EAAuBC,SAAvB,EAAkC;AACjD,UAAIC,MAAM,GAAGH,EAAE,CAACR,KAAH,MAAc,QAAQnX,IAAR,CAAa6X,SAAb,MAA4B,IAAvD;AACA,UAAIE,QAAQ,GAAGJ,EAAE,CAACR,KAAH,MAAc,CAACW,MAA9B;AACA,UAAIE,UAAU,GAAGL,EAAE,CAACP,SAAH,MAAkBO,EAAE,CAAC3B,OAAH,CAAWpB,KAAX,KAAqB,CAAxD;AACA,UAAIqD,UAAU,GAAGN,EAAE,CAACP,SAAH,MAAkBO,EAAE,CAAC3B,OAAH,CAAWpB,KAAX,KAAqB,CAAxD;AACA,UAAIsD,QAAQ,GAAGJ,MAAM,IAAIE,UAAV,IAAwBC,UAAU,IAAI,UAAUjY,IAAV,CAAe6X,SAAf,MAA8B,IAAnF;AACA,UAAIM,OAAO,GAAGR,EAAE,CAACR,KAAH,MAAcQ,EAAE,CAACP,SAAH,EAA5B;AACA,UAAIgB,OAAO,GAAGD,OAAO,IAAI,CAACD,QAA1B;AACA,UAAIG,UAAU,GAAGT,OAAO,CAACtB,QAAR,MAAsBqB,EAAE,CAACR,KAAH,EAAtB,IAAoC,UAAUnX,IAAV,CAAe6X,SAAf,MAA8B,KAAnF;AACA,aAAO;AACLC,QAAAA,MAAM,EAAEpoB,QAAQ,CAACooB,MAAD,CADX;AAELC,QAAAA,QAAQ,EAAEroB,QAAQ,CAACqoB,QAAD,CAFb;AAGLG,QAAAA,QAAQ,EAAExoB,QAAQ,CAACwoB,QAAD,CAHb;AAILE,QAAAA,OAAO,EAAE1oB,QAAQ,CAAC0oB,OAAD,CAJZ;AAKLD,QAAAA,OAAO,EAAEzoB,QAAQ,CAACyoB,OAAD,CALZ;AAMLf,QAAAA,SAAS,EAAEO,EAAE,CAACP,SANT;AAOLD,QAAAA,KAAK,EAAEQ,EAAE,CAACR,KAPL;AAQLmB,QAAAA,SAAS,EAAE5oB,QAAQ,CAAC2oB,UAAD;AARd,OAAP;AAUD,KAnBD;;AAqBA,QAAIE,QAAQ,GAAG,SAAXA,QAAW,CAAUC,UAAV,EAAsBX,SAAtB,EAAiC;AAC9C,UAAIlD,KAAK,GAAG/gB,MAAM,CAACikB,SAAD,CAAN,CAAkBlE,WAAlB,EAAZ;AACA,aAAOnf,IAAI,CAACgkB,UAAD,EAAa,UAAUC,SAAV,EAAqB;AAC3C,eAAOA,SAAS,CAACC,MAAV,CAAiB/D,KAAjB,CAAP;AACD,OAFU,CAAX;AAGD,KALD;;AAMA,QAAIgE,aAAa,GAAG,SAAhBA,aAAgB,CAAUC,QAAV,EAAoBf,SAApB,EAA+B;AACjD,aAAOU,QAAQ,CAACK,QAAD,EAAWf,SAAX,CAAR,CAA8BhmB,GAA9B,CAAkC,UAAU+lB,OAAV,EAAmB;AAC1D,YAAI5B,OAAO,GAAGX,OAAO,CAACJ,MAAR,CAAe2C,OAAO,CAAC1C,cAAvB,EAAuC2C,SAAvC,CAAd;AACA,eAAO;AACLhC,UAAAA,OAAO,EAAE+B,OAAO,CAAC9c,IADZ;AAELkb,UAAAA,OAAO,EAAEA;AAFJ,SAAP;AAID,OANM,CAAP;AAOD,KARD;;AASA,QAAI6C,QAAQ,GAAG,SAAXA,QAAW,CAAUC,IAAV,EAAgBjB,SAAhB,EAA2B;AACxC,aAAOU,QAAQ,CAACO,IAAD,EAAOjB,SAAP,CAAR,CAA0BhmB,GAA1B,CAA8B,UAAU8lB,EAAV,EAAc;AACjD,YAAI3B,OAAO,GAAGX,OAAO,CAACJ,MAAR,CAAe0C,EAAE,CAACzC,cAAlB,EAAkC2C,SAAlC,CAAd;AACA,eAAO;AACLhC,UAAAA,OAAO,EAAE8B,EAAE,CAAC7c,IADP;AAELkb,UAAAA,OAAO,EAAEA;AAFJ,SAAP;AAID,OANM,CAAP;AAOD,KARD;;AASA,QAAI+C,QAAQ,GAAG;AACbJ,MAAAA,aAAa,EAAEA,aADF;AAEbE,MAAAA,QAAQ,EAAEA;AAFG,KAAf;;AAKA,QAAIG,QAAQ,GAAG,SAAXA,QAAW,CAAUC,GAAV,EAAeC,MAAf,EAAuB;AACpC,aAAOD,GAAG,CAACE,OAAJ,CAAYD,MAAZ,MAAwB,CAAC,CAAhC;AACD,KAFD;;AAIA,QAAIE,kBAAkB,GAAG,qCAAzB;;AACA,QAAIC,aAAa,GAAG,SAAhBA,aAAgB,CAAUC,MAAV,EAAkB;AACpC,aAAO,UAAUC,QAAV,EAAoB;AACzB,eAAOP,QAAQ,CAACO,QAAD,EAAWD,MAAX,CAAf;AACD,OAFD;AAGD,KAJD;;AAKA,QAAIV,QAAQ,GAAG,CACb;AACE9d,MAAAA,IAAI,EAAE,MADR;AAEEoa,MAAAA,cAAc,EAAE,CAAC,gCAAD,CAFlB;AAGEwD,MAAAA,MAAM,EAAE,gBAAUa,QAAV,EAAoB;AAC1B,YAAIC,WAAW,GAAGR,QAAQ,CAACO,QAAD,EAAW,OAAX,CAAR,IAA+BP,QAAQ,CAACO,QAAD,EAAW,QAAX,CAAvC,IAA+DP,QAAQ,CAACO,QAAD,EAAW,QAAX,CAAvE,IAA+FP,QAAQ,CAACO,QAAD,EAAW,aAAX,CAAzH;AACA,eAAOC,WAAP;AACD;AANH,KADa,EASb;AACE1e,MAAAA,IAAI,EAAE,QADR;AAEEoa,MAAAA,cAAc,EAAE,CACd,iCADc,EAEdkE,kBAFc,CAFlB;AAMEV,MAAAA,MAAM,EAAE,gBAAUa,QAAV,EAAoB;AAC1B,eAAOP,QAAQ,CAACO,QAAD,EAAW,QAAX,CAAR,IAAgC,CAACP,QAAQ,CAACO,QAAD,EAAW,aAAX,CAAhD;AACD;AARH,KATa,EAmBb;AACEze,MAAAA,IAAI,EAAE,IADR;AAEEoa,MAAAA,cAAc,EAAE,CACd,gCADc,EAEd,4BAFc,CAFlB;AAMEwD,MAAAA,MAAM,EAAE,gBAAUa,QAAV,EAAoB;AAC1B,eAAOP,QAAQ,CAACO,QAAD,EAAW,MAAX,CAAR,IAA8BP,QAAQ,CAACO,QAAD,EAAW,SAAX,CAA7C;AACD;AARH,KAnBa,EA6Bb;AACEze,MAAAA,IAAI,EAAE,OADR;AAEEoa,MAAAA,cAAc,EAAE,CACdkE,kBADc,EAEd,gCAFc,CAFlB;AAMEV,MAAAA,MAAM,EAAEW,aAAa,CAAC,OAAD;AANvB,KA7Ba,EAqCb;AACEve,MAAAA,IAAI,EAAE,SADR;AAEEoa,MAAAA,cAAc,EAAE,CAAC,qCAAD,CAFlB;AAGEwD,MAAAA,MAAM,EAAEW,aAAa,CAAC,SAAD;AAHvB,KArCa,EA0Cb;AACEve,MAAAA,IAAI,EAAE,QADR;AAEEoa,MAAAA,cAAc,EAAE,CACdkE,kBADc,EAEd,+BAFc,CAFlB;AAMEV,MAAAA,MAAM,EAAE,gBAAUa,QAAV,EAAoB;AAC1B,eAAO,CAACP,QAAQ,CAACO,QAAD,EAAW,QAAX,CAAR,IAAgCP,QAAQ,CAACO,QAAD,EAAW,SAAX,CAAzC,KAAmEP,QAAQ,CAACO,QAAD,EAAW,aAAX,CAAlF;AACD;AARH,KA1Ca,CAAf;AAqDA,QAAIT,IAAI,GAAG,CACT;AACEhe,MAAAA,IAAI,EAAE,SADR;AAEE4d,MAAAA,MAAM,EAAEW,aAAa,CAAC,KAAD,CAFvB;AAGEnE,MAAAA,cAAc,EAAE,CAAC,uCAAD;AAHlB,KADS,EAMT;AACEpa,MAAAA,IAAI,EAAE,KADR;AAEE4d,MAAAA,MAAM,EAAE,gBAAUa,QAAV,EAAoB;AAC1B,eAAOP,QAAQ,CAACO,QAAD,EAAW,QAAX,CAAR,IAAgCP,QAAQ,CAACO,QAAD,EAAW,MAAX,CAA/C;AACD,OAJH;AAKErE,MAAAA,cAAc,EAAE,CACd,qCADc,EAEd,8BAFc,EAGd,qCAHc;AALlB,KANS,EAiBT;AACEpa,MAAAA,IAAI,EAAE,SADR;AAEE4d,MAAAA,MAAM,EAAEW,aAAa,CAAC,SAAD,CAFvB;AAGEnE,MAAAA,cAAc,EAAE,CAAC,mCAAD;AAHlB,KAjBS,EAsBT;AACEpa,MAAAA,IAAI,EAAE,KADR;AAEE4d,MAAAA,MAAM,EAAEW,aAAa,CAAC,MAAD,CAFvB;AAGEnE,MAAAA,cAAc,EAAE,CAAC,gCAAD;AAHlB,KAtBS,EA2BT;AACEpa,MAAAA,IAAI,EAAE,OADR;AAEE4d,MAAAA,MAAM,EAAEW,aAAa,CAAC,OAAD,CAFvB;AAGEnE,MAAAA,cAAc,EAAE;AAHlB,KA3BS,EAgCT;AACEpa,MAAAA,IAAI,EAAE,SADR;AAEE4d,MAAAA,MAAM,EAAEW,aAAa,CAAC,OAAD,CAFvB;AAGEnE,MAAAA,cAAc,EAAE;AAHlB,KAhCS,EAqCT;AACEpa,MAAAA,IAAI,EAAE,SADR;AAEE4d,MAAAA,MAAM,EAAEW,aAAa,CAAC,SAAD,CAFvB;AAGEnE,MAAAA,cAAc,EAAE;AAHlB,KArCS,CAAX;AA2CA,QAAIuE,YAAY,GAAG;AACjBb,MAAAA,QAAQ,EAAElpB,QAAQ,CAACkpB,QAAD,CADD;AAEjBE,MAAAA,IAAI,EAAEppB,QAAQ,CAACopB,IAAD;AAFG,KAAnB;;AAKA,QAAIY,QAAQ,GAAG,SAAXA,QAAW,CAAU7B,SAAV,EAAqB;AAClC,UAAIe,QAAQ,GAAGa,YAAY,CAACb,QAAb,EAAf;AACA,UAAIE,IAAI,GAAGW,YAAY,CAACX,IAAb,EAAX;AACA,UAAIlB,OAAO,GAAGmB,QAAQ,CAACJ,aAAT,CAAuBC,QAAvB,EAAiCf,SAAjC,EAA4C3mB,IAA5C,CAAiDqlB,OAAO,CAACnB,OAAzD,EAAkEmB,OAAO,CAACnhB,EAA1E,CAAd;AACA,UAAIuiB,EAAE,GAAGoB,QAAQ,CAACF,QAAT,CAAkBC,IAAlB,EAAwBjB,SAAxB,EAAmC3mB,IAAnC,CAAwCumB,eAAe,CAACrC,OAAxD,EAAiEqC,eAAe,CAACriB,EAAjF,CAAT;AACA,UAAIukB,UAAU,GAAGjC,UAAU,CAACC,EAAD,EAAKC,OAAL,EAAcC,SAAd,CAA3B;AACA,aAAO;AACLD,QAAAA,OAAO,EAAEA,OADJ;AAELD,QAAAA,EAAE,EAAEA,EAFC;AAGLgC,QAAAA,UAAU,EAAEA;AAHP,OAAP;AAKD,KAXD;;AAYA,QAAIC,iBAAiB,GAAG;AAAE3E,MAAAA,MAAM,EAAEyE;AAAV,KAAxB;AAEA,QAAIG,QAAQ,GAAGvF,MAAM,CAAC,YAAY;AAChC,UAAIuD,SAAS,GAAG1oB,UAAU,CAAC2qB,SAAX,CAAqBjC,SAArC;AACA,aAAO+B,iBAAiB,CAAC3E,MAAlB,CAAyB4C,SAAzB,CAAP;AACD,KAHoB,CAArB;AAIA,QAAIkC,mBAAmB,GAAG;AAAE9E,MAAAA,MAAM,EAAE4E;AAAV,KAA1B;;AAEA,QAAIG,eAAe,GAAG,SAAlBA,eAAkB,CAAUC,EAAV,EAAcC,EAAd,EAAkB;AACtC,UAAIC,EAAE,GAAGF,EAAE,CAAChZ,GAAH,EAAT;AACA,UAAImZ,EAAE,GAAGF,EAAE,CAACjZ,GAAH,EAAT;AACA,aAAOkZ,EAAE,KAAKC,EAAP,GAAY,KAAZ,GAAoBD,EAAE,CAACnB,QAAH,CAAYoB,EAAZ,CAA3B;AACD,KAJD;;AAKA,QAAIC,UAAU,GAAG,SAAbA,UAAa,CAAUJ,EAAV,EAAcC,EAAd,EAAkB;AACjC,aAAOhI,IAAI,CAACkC,2BAAL,CAAiC6F,EAAE,CAAChZ,GAAH,EAAjC,EAA2CiZ,EAAE,CAACjZ,GAAH,EAA3C,CAAP;AACD,KAFD;;AAGA,QAAI2W,OAAO,GAAGmC,mBAAmB,CAAC9E,MAApB,GAA6B2C,OAA3C;AACA,QAAI0C,UAAU,GAAG1C,OAAO,CAACzB,IAAR,KAAiBkE,UAAjB,GAA8BL,eAA/C;;AAEA,QAAIO,MAAM,GAAG,SAATA,MAAS,CAAU7G,OAAV,EAAmB;AAC9B,UAAIzS,GAAG,GAAGyS,OAAO,CAACzS,GAAR,EAAV;AACA,aAAO3N,MAAM,CAACD,IAAP,CAAY4N,GAAG,CAACvC,UAAhB,EAA4B7M,GAA5B,CAAgCmgB,OAAO,CAACT,OAAxC,CAAP;AACD,KAHD;;AAIA,QAAIiJ,IAAI,GAAG5G,SAAS,CAAC,SAAD,EAAY,QAAZ,CAApB;;AAEA,QAAI6G,cAAc,GAAG,SAAjBA,cAAiB,CAAUvW,GAAV,EAAe;AAClC,aAAOqW,MAAM,CAACrW,GAAD,CAAN,CAAY9R,MAAZ,CAAmB,UAAUsoB,SAAV,EAAqB;AAC7C,eAAO5f,IAAI,CAAC4f,SAAD,CAAJ,KAAoB,QAA3B;AACD,OAFM,EAEJppB,KAFI,CAEE4S,GAFF,CAAP;AAGD,KAJD;;AAKA,QAAIyW,UAAU,GAAG,SAAbA,UAAa,CAAU7d,MAAV,EAAkB;AACjC,UAAI8d,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAU/U,IAAV,EAAgB;AACxC,eAAO;AACLrF,UAAAA,IAAI,EAAE,OADD;AAELqa,UAAAA,IAAI,EAAE,OAFD;AAGLC,UAAAA,QAAQ,EAAE,oBAAY;AACpB,gBAAIC,OAAO,GAAGN,cAAc,CAACzI,OAAO,CAACT,OAAR,CAAgB1L,IAAhB,CAAD,CAA5B;AACA/I,YAAAA,MAAM,CAACgE,SAAP,CAAiBC,MAAjB,CAAwBga,OAAO,CAAC9Z,GAAR,EAAxB;AACA4O,YAAAA,MAAM,CAAC/S,MAAD,CAAN,CAAe6L,IAAf;AACD;AAPI,SAAP;AASD,OAVD;;AAWA7L,MAAAA,MAAM,CAACke,EAAP,CAAUC,QAAV,CAAmBC,eAAnB,CAAmC,OAAnC,EAA4C;AAC1CL,QAAAA,IAAI,EAAE,OADoC;AAE1CM,QAAAA,OAAO,EAAE,mBAFiC;AAG1CL,QAAAA,QAAQ,EAAEjL,MAAM,CAAC/S,MAAD,CAAN,CAAe6L,IAHiB;AAI1CyS,QAAAA,OAAO,EAAE,iBAAUC,SAAV,EAAqB;AAC5B,iBAAOve,MAAM,CAACgE,SAAP,CAAiBwa,yBAAjB,CAA2C,gEAA3C,EAA6GD,SAAS,CAACE,SAAvH,EAAkIC,MAAzI;AACD;AANyC,OAA5C;AAQA1e,MAAAA,MAAM,CAACke,EAAP,CAAUC,QAAV,CAAmBQ,WAAnB,CAA+B,OAA/B,EAAwC;AACtCZ,QAAAA,IAAI,EAAE,OADgC;AAEtCra,QAAAA,IAAI,EAAE,UAFgC;AAGtCsa,QAAAA,QAAQ,EAAEjL,MAAM,CAAC/S,MAAD,CAAN,CAAe6L;AAHa,OAAxC;AAKA7L,MAAAA,MAAM,CAACke,EAAP,CAAUC,QAAV,CAAmBS,cAAnB,CAAkC,OAAlC,EAA2C;AACzCC,QAAAA,MAAM,EAAE,gBAAUjI,OAAV,EAAmB;AACzB,iBAAOzP,QAAQ,CAACyP,OAAD,CAAR,IAAqBvP,OAAO,CAACuP,OAAD,CAAP,IAAoB,CAAChS,KAAK,CAACH,kBAAN,CAAyBmS,OAAzB,CAA1C,GAA8E,CAACkH,mBAAmB,CAAClH,OAAD,CAApB,CAA9E,GAA+G,EAAtH;AACD;AAHwC,OAA3C;AAKD,KA9BD;;AA+BA,QAAIkI,OAAO,GAAG;AAAE7L,MAAAA,QAAQ,EAAE4K;AAAZ,KAAd;AAEAvrB,IAAAA,MAAM,CAACysB,GAAP,CAAW,OAAX,EAAoB,UAAU/e,MAAV,EAAkB;AACpCgU,MAAAA,aAAa,CAACL,KAAd,CAAoB3T,MAApB;AACA8e,MAAAA,OAAO,CAAC7L,QAAR,CAAiBjT,MAAjB;AACAmT,MAAAA,QAAQ,CAACF,QAAT,CAAkBjT,MAAlB;AACD,KAJD;;AAKA,aAASgf,MAAT,GAAmB,CAClB;;AAED,WAAOA,MAAP;AAEH,GAj2EY,CAi2EXvhB,MAj2EW,CAAb;AAk2EC,CAn2ED","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.0.7 (2019-06-05)\n */\n(function () {\nvar image = (function (domGlobals) {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var never$1 = never;\n    var always$1 = always;\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var noop = function () {\n      };\n      var nul = function () {\n        return null;\n      };\n      var undef = function () {\n        return undefined;\n      };\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never$1,\n        isSome: never$1,\n        isNone: always$1,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: nul,\n        getOrUndefined: undef,\n        or: id,\n        orThunk: call,\n        map: none,\n        ap: none,\n        each: noop,\n        bind: none,\n        flatten: none,\n        exists: never$1,\n        forall: always$1,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      if (Object.freeze)\n        Object.freeze(me);\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = function () {\n        return a;\n      };\n      var self = function () {\n        return me;\n      };\n      var map = function (f) {\n        return some(f(a));\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always$1,\n        isNone: never$1,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: map,\n        ap: function (optfab) {\n          return optfab.fold(none, function (fab) {\n            return some(fab(a));\n          });\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        flatten: constant_a,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never$1, function (b) {\n            return elementEq(a, b);\n          });\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null)\n        return 'null';\n      var t = typeof x;\n      if (t === 'object' && Array.prototype.isPrototypeOf(x))\n        return 'array';\n      if (t === 'object' && String.prototype.isPrototypeOf(x))\n        return 'string';\n      return t;\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isBoolean = isType('boolean');\n    var isFunction = isType('function');\n\n    var slice = Array.prototype.slice;\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i, xs);\n      }\n    };\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i, xs)) {\n          return Option.some(x);\n        }\n      }\n      return Option.none();\n    };\n    var push = Array.prototype.push;\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!Array.prototype.isPrototypeOf(xs[i]))\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        push.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return slice.call(x);\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var nu = function (baseFn) {\n      var data = Option.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady())\n          call(nCallback);\n        else\n          callbacks.push(nCallback);\n      };\n      var set = function (x) {\n        data = Option.some(x);\n        run(callbacks);\n        callbacks = [];\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          domGlobals.setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu,\n      pure: pure\n    };\n\n    var bounce = function (f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        var me = this;\n        domGlobals.setTimeout(function () {\n          f.apply(me, args);\n        }, 0);\n      };\n    };\n\n    var nu$1 = function (baseFn) {\n      var get = function (callback) {\n        baseFn(bounce(callback));\n      };\n      var map = function (fab) {\n        return nu$1(function (callback) {\n          get(function (a) {\n            var value = fab(a);\n            callback(value);\n          });\n        });\n      };\n      var bind = function (aFutureB) {\n        return nu$1(function (callback) {\n          get(function (a) {\n            aFutureB(a).get(callback);\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return nu$1(function (callback) {\n          get(function (a) {\n            futureB.get(callback);\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return nu$1(function (callback) {\n          if (cache === null) {\n            cache = toLazy();\n          }\n          cache.get(callback);\n        });\n      };\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        get: get\n      };\n    };\n    var pure$1 = function (a) {\n      return nu$1(function (callback) {\n        callback(a);\n      });\n    };\n    var Future = {\n      nu: nu$1,\n      pure: pure$1\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (opt) {\n        return value(o);\n      };\n      var orThunk = function (f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOption = function () {\n        return Option.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOption: Option.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var wrap = function (delegate) {\n      var toCached = function () {\n        return wrap(delegate.toCached());\n      };\n      var bindFuture = function (f) {\n        return wrap(delegate.bind(function (resA) {\n          return resA.fold(function (err) {\n            return Future.pure(Result.error(err));\n          }, function (a) {\n            return f(a);\n          });\n        }));\n      };\n      var bindResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.bind(f);\n        }));\n      };\n      var mapResult = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.map(f);\n        }));\n      };\n      var mapError = function (f) {\n        return wrap(delegate.map(function (resA) {\n          return resA.mapError(f);\n        }));\n      };\n      var foldResult = function (whenError, whenValue) {\n        return delegate.map(function (res) {\n          return res.fold(whenError, whenValue);\n        });\n      };\n      var withTimeout = function (timeout, errorThunk) {\n        return wrap(Future.nu(function (callback) {\n          var timedOut = false;\n          var timer = domGlobals.setTimeout(function () {\n            timedOut = true;\n            callback(Result.error(errorThunk()));\n          }, timeout);\n          delegate.get(function (result) {\n            if (!timedOut) {\n              domGlobals.clearTimeout(timer);\n              callback(result);\n            }\n          });\n        }));\n      };\n      return __assign({}, delegate, {\n        toCached: toCached,\n        bindFuture: bindFuture,\n        bindResult: bindResult,\n        mapResult: mapResult,\n        mapError: mapError,\n        foldResult: foldResult,\n        withTimeout: withTimeout\n      });\n    };\n    var nu$2 = function (worker) {\n      return wrap(Future.nu(worker));\n    };\n    var value$1 = function (value) {\n      return wrap(Future.pure(Result.value(value)));\n    };\n    var error$1 = function (error) {\n      return wrap(Future.pure(Result.error(error)));\n    };\n    var fromResult = function (result) {\n      return wrap(Future.pure(result));\n    };\n    var fromFuture = function (future) {\n      return wrap(future.map(Result.value));\n    };\n    var fromPromise = function (promise) {\n      return nu$2(function (completer) {\n        promise.then(function (value) {\n          completer(Result.value(value));\n        }, function (error) {\n          completer(Result.error(error));\n        });\n      });\n    };\n    var FutureResult = {\n      nu: nu$2,\n      wrap: wrap,\n      pure: value$1,\n      value: value$1,\n      error: error$1,\n      fromResult: fromResult,\n      fromFuture: fromFuture,\n      fromPromise: fromPromise\n    };\n\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++)\n          objects[i] = arguments[i];\n        if (objects.length === 0)\n          throw new Error('Can\\'t merge zero objects');\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject)\n            if (hasOwnProperty.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n    var merge = baseMerge(shallow);\n\n    var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n    var path = function (parts, scope) {\n      var o = scope !== undefined && scope !== null ? scope : Global;\n      for (var i = 0; i < parts.length && o !== undefined && o !== null; ++i)\n        o = o[parts[i]];\n      return o;\n    };\n    var resolve = function (p, scope) {\n      var parts = p.split('.');\n      return path(parts, scope);\n    };\n\n    var unsafe = function (name, scope) {\n      return resolve(name, scope);\n    };\n    var getOrDie = function (name, scope) {\n      var actual = unsafe(name, scope);\n      if (actual === undefined || actual === null)\n        throw name + ' not available on this browser';\n      return actual;\n    };\n    var Global$1 = { getOrDie: getOrDie };\n\n    var url = function () {\n      return Global$1.getOrDie('URL');\n    };\n    var createObjectURL = function (blob) {\n      return url().createObjectURL(blob);\n    };\n    var revokeObjectURL = function (u) {\n      url().revokeObjectURL(u);\n    };\n    var URL = {\n      createObjectURL: createObjectURL,\n      revokeObjectURL: revokeObjectURL\n    };\n\n    var makeItems = function (info) {\n      var imageUrl = {\n        name: 'src',\n        type: 'urlinput',\n        filetype: 'image',\n        label: 'Source'\n      };\n      var imageList = info.imageList.map(function (items) {\n        return {\n          name: 'images',\n          type: 'selectbox',\n          label: 'Image list',\n          items: items\n        };\n      });\n      var imageDescription = {\n        name: 'alt',\n        type: 'input',\n        label: 'Image description'\n      };\n      var imageTitle = {\n        name: 'title',\n        type: 'input',\n        label: 'Image title'\n      };\n      var imageDimensions = {\n        name: 'dimensions',\n        type: 'sizeinput'\n      };\n      var classList = info.classList.map(function (items) {\n        return {\n          name: 'classes',\n          type: 'selectbox',\n          label: 'Class',\n          items: items\n        };\n      });\n      var caption = {\n        type: 'label',\n        label: 'Caption',\n        items: [{\n            type: 'checkbox',\n            name: 'caption',\n            label: 'Show caption'\n          }]\n      };\n      return flatten([\n        [imageUrl],\n        imageList.toArray(),\n        info.hasDescription ? [imageDescription] : [],\n        info.hasImageTitle ? [imageTitle] : [],\n        info.hasDimensions ? [imageDimensions] : [],\n        [{\n            type: 'grid',\n            columns: 2,\n            items: flatten([\n              classList.toArray(),\n              info.hasImageCaption ? [caption] : []\n            ])\n          }]\n      ]);\n    };\n    var makeTab = function (info) {\n      return {\n        title: 'General',\n        name: 'general',\n        items: makeItems(info)\n      };\n    };\n    var MainTab = {\n      makeTab: makeTab,\n      makeItems: makeItems\n    };\n\n    function FileReader () {\n      var f = Global$1.getOrDie('FileReader');\n      return new f();\n    }\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n    var hasDimensions = function (editor) {\n      return editor.getParam('image_dimensions', true, 'boolean');\n    };\n    var hasAdvTab = function (editor) {\n      return editor.getParam('image_advtab', false, 'boolean');\n    };\n    var hasUploadTab = function (editor) {\n      return editor.getParam('image_uploadtab', true, 'boolean');\n    };\n    var getPrependUrl = function (editor) {\n      return editor.getParam('image_prepend_url', '', 'string');\n    };\n    var getClassList = function (editor) {\n      return editor.getParam('image_class_list');\n    };\n    var hasDescription = function (editor) {\n      return editor.getParam('image_description', true, 'boolean');\n    };\n    var hasImageTitle = function (editor) {\n      return editor.getParam('image_title', false, 'boolean');\n    };\n    var hasImageCaption = function (editor) {\n      return editor.getParam('image_caption', false, 'boolean');\n    };\n    var getImageList = function (editor) {\n      return editor.getParam('image_list', false);\n    };\n    var hasUploadUrl = function (editor) {\n      return !!getUploadUrl(editor);\n    };\n    var hasUploadHandler = function (editor) {\n      return !!getUploadHandler(editor);\n    };\n    var getUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', undefined, 'function');\n    };\n    var getUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', undefined, 'string');\n    };\n    var getUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var Settings = {\n      hasDimensions: hasDimensions,\n      hasUploadTab: hasUploadTab,\n      hasAdvTab: hasAdvTab,\n      getPrependUrl: getPrependUrl,\n      getClassList: getClassList,\n      hasDescription: hasDescription,\n      hasImageTitle: hasImageTitle,\n      hasImageCaption: hasImageCaption,\n      getImageList: getImageList,\n      hasUploadUrl: hasUploadUrl,\n      hasUploadHandler: hasUploadHandler,\n      getUploadUrl: getUploadUrl,\n      getUploadHandler: getUploadHandler,\n      getUploadBasePath: getUploadBasePath,\n      getUploadCredentials: getUploadCredentials\n    };\n\n    var parseIntAndGetMax = function (val1, val2) {\n      return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n    };\r\n\tvar parseIntAndGetMin = function (val1, val2) {\r\n\t  return Math.min(parseInt(val1, 10), parseInt(val2, 10));\r\n\t};\n    var getImageSize = function (url, callback) {\n      var img = domGlobals.document.createElement('img');\n      var done = function (dimensions) {\n        if (img.parentNode) {\n          img.parentNode.removeChild(img);\n        }\n        callback(dimensions);\n      };\n      img.onload = function () {\r\n\t\tvar width = 0;\r\n\t\tvar height = 0;\n        var pwidth = parseIntAndGetMax(img.width, img.clientWidth);\n        var pheight = parseIntAndGetMax(img.height, img.clientHeight);\r\n\t\tvar bili = pwidth/pheight;\r\n\t\tif(pwidth>800) {\r\n\t\t\twidth = parseIntAndGetMin(pwidth, 500);\r\n\t\t\theight = width/bili;\r\n\t\t}else{\r\n\t\t\twidth = pwidth;\r\n\t\t\theight = pheight;\r\n\t\t}\n        var dimensions = {\n          width: width,\n          height: height\n        };\n        done(Result.value(dimensions));\n      };\n      img.onerror = function () {\n        done(Result.error('Failed to get image dimensions for: ' + url));\n      };\n      var style = img.style;\n      style.visibility = 'hidden';\n      style.position = 'fixed';\n      style.bottom = style.left = '0px';\n      style.width = style.height = 'auto';\n      domGlobals.document.body.appendChild(img);\n      img.src = url;\n    };\n    var removePixelSuffix = function (value) {\n      if (value) {\n        value = value.replace(/px$/, '');\n      }\n      return value;\n    };\n    var addPixelSuffix = function (value) {\n      if (value.length > 0 && /^[0-9]+$/.test(value)) {\n        value += 'px';\n      }\n      return value;\n    };\n    var mergeMargins = function (css) {\n      if (css.margin) {\n        var splitMargin = String(css.margin).split(' ');\n        switch (splitMargin.length) {\n        case 1:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[0];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[0];\n          break;\n        case 2:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 3:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n        case 4:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[3];\n        }\n        delete css.margin;\n      }\n      return css;\n    };\n    var createImageList = function (editor, callback) {\n      var imageList = Settings.getImageList(editor);\n      if (typeof imageList === 'string') {\n        global$2.send({\n          url: imageList,\n          success: function (text) {\n            callback(JSON.parse(text));\n          }\n        });\n      } else if (typeof imageList === 'function') {\n        imageList(callback);\n      } else {\n        callback(imageList);\n      }\n    };\n    var waitLoadImage = function (editor, data, imgElm) {\n      var selectImage = function () {\n        imgElm.onload = imgElm.onerror = null;\n        if (editor.selection) {\n          editor.selection.select(imgElm);\n          editor.nodeChanged();\n        }\n      };\n      imgElm.onload = function () {\n        if (!data.width && !data.height && Settings.hasDimensions(editor)) {\n          editor.dom.setAttribs(imgElm, {\n            width: String(imgElm.clientWidth),\n            height: String(imgElm.clientHeight)\n          });\n        }\n        selectImage();\n      };\n      imgElm.onerror = selectImage;\n    };\n    var blobToDataUri = function (blob) {\n      return new global$1(function (resolve, reject) {\n        var reader = FileReader();\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n        reader.onerror = function () {\n          reject(reader.error.message);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var isPlaceholderImage = function (imgElm) {\n      return imgElm.nodeName === 'IMG' && (imgElm.hasAttribute('data-mce-object') || imgElm.hasAttribute('data-mce-placeholder'));\n    };\n    var Utils = {\n      getImageSize: getImageSize,\n      removePixelSuffix: removePixelSuffix,\n      addPixelSuffix: addPixelSuffix,\n      mergeMargins: mergeMargins,\n      createImageList: createImageList,\n      waitLoadImage: waitLoadImage,\n      blobToDataUri: blobToDataUri,\n      isPlaceholderImage: isPlaceholderImage\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var DOM = global$3.DOM;\n    var getHspace = function (image) {\n      if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n        return Utils.removePixelSuffix(image.style.marginLeft);\n      } else {\n        return '';\n      }\n    };\n    var getVspace = function (image) {\n      if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n        return Utils.removePixelSuffix(image.style.marginTop);\n      } else {\n        return '';\n      }\n    };\n    var getBorder = function (image) {\n      if (image.style.borderWidth) {\n        return Utils.removePixelSuffix(image.style.borderWidth);\n      } else {\n        return '';\n      }\n    };\n    var getAttrib = function (image, name) {\n      if (image.hasAttribute(name)) {\n        return image.getAttribute(name);\n      } else {\n        return '';\n      }\n    };\n    var getStyle = function (image, name) {\n      return image.style[name] ? image.style[name] : '';\n    };\n    var hasCaption = function (image) {\n      return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n    };\n    var setAttrib = function (image, name, value) {\n      image.setAttribute(name, value);\n    };\n    var wrapInFigure = function (image) {\n      var figureElm = DOM.create('figure', { class: 'image' });\n      DOM.insertAfter(figureElm, image);\n      figureElm.appendChild(image);\n      figureElm.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n      figureElm.contentEditable = 'false';\n    };\n    var removeFigure = function (image) {\n      var figureElm = image.parentNode;\n      DOM.insertAfter(image, figureElm);\n      DOM.remove(figureElm);\n    };\n    var toggleCaption = function (image) {\n      if (hasCaption(image)) {\n        removeFigure(image);\n      } else {\n        wrapInFigure(image);\n      }\n    };\n    var normalizeStyle = function (image, normalizeCss) {\n      var attrValue = image.getAttribute('style');\n      var value = normalizeCss(attrValue !== null ? attrValue : '');\n      if (value.length > 0) {\n        image.setAttribute('style', value);\n        image.setAttribute('data-mce-style', value);\n      } else {\n        image.removeAttribute('style');\n      }\n    };\n    var setSize = function (name, normalizeCss) {\n      return function (image, name, value) {\n        if (image.style[name]) {\n          image.style[name] = Utils.addPixelSuffix(value);\n          normalizeStyle(image, normalizeCss);\n        } else {\n          setAttrib(image, name, value);\n        }\n      };\n    };\n    var getSize = function (image, name) {\n      if (image.style[name]) {\n        return Utils.removePixelSuffix(image.style[name]);\n      } else {\n        return getAttrib(image, name);\n      }\n    };\n    var setHspace = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginLeft = pxValue;\n      image.style.marginRight = pxValue;\n    };\n    var setVspace = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.marginTop = pxValue;\n      image.style.marginBottom = pxValue;\n    };\n    var setBorder = function (image, value) {\n      var pxValue = Utils.addPixelSuffix(value);\n      image.style.borderWidth = pxValue;\n    };\n    var setBorderStyle = function (image, value) {\n      image.style.borderStyle = value;\n    };\n    var getBorderStyle = function (image) {\n      return getStyle(image, 'borderStyle');\n    };\n    var isFigure = function (elm) {\n      return elm.nodeName === 'FIGURE';\n    };\n    var isImage = function (elm) {\n      return elm.nodeName === 'IMG';\n    };\n    var defaultData = function () {\n      return {\n        src: '',\n        alt: '',\n        title: '',\n        width: '',\n        height: '',\n        class: '',\n        style: '',\n        caption: false,\n        hspace: '',\n        vspace: '',\n        border: '',\n        borderStyle: ''\n      };\n    };\n    var getStyleValue = function (normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      setAttrib(image, 'style', data.style);\n      if (getHspace(image) || data.hspace !== '') {\n        setHspace(image, data.hspace);\n      }\n      if (getVspace(image) || data.vspace !== '') {\n        setVspace(image, data.vspace);\n      }\n      if (getBorder(image) || data.border !== '') {\n        setBorder(image, data.border);\n      }\n      if (getBorderStyle(image) || data.borderStyle !== '') {\n        setBorderStyle(image, data.borderStyle);\n      }\n      return normalizeCss(image.getAttribute('style'));\n    };\n    var create = function (normalizeCss, data) {\n      var image = domGlobals.document.createElement('img');\n      write(normalizeCss, merge(data, { caption: false }), image);\n      setAttrib(image, 'alt', data.alt);\n      if (data.caption) {\n        var figure = DOM.create('figure', { class: 'image' });\n        figure.appendChild(image);\n        figure.appendChild(DOM.create('figcaption', { contentEditable: 'true' }, 'Caption'));\n        figure.contentEditable = 'false';\n        return figure;\n      } else {\n        return image;\n      }\n    };\n    var read = function (normalizeCss, image) {\n      return {\n        src: getAttrib(image, 'src'),\n        alt: getAttrib(image, 'alt'),\n        title: getAttrib(image, 'title'),\n        width: getSize(image, 'width'),\n        height: getSize(image, 'height'),\n        class: getAttrib(image, 'class'),\n        style: normalizeCss(getAttrib(image, 'style')),\n        caption: hasCaption(image),\n        hspace: getHspace(image),\n        vspace: getVspace(image),\n        border: getBorder(image),\n        borderStyle: getStyle(image, 'borderStyle')\n      };\n    };\n    var updateProp = function (image, oldData, newData, name, set) {\n      if (newData[name] !== oldData[name]) {\n        set(image, name, newData[name]);\n      }\n    };\n    var normalized = function (set, normalizeCss) {\n      return function (image, name, value) {\n        set(image, value);\n        normalizeStyle(image, normalizeCss);\n      };\n    };\n    var write = function (normalizeCss, newData, image) {\n      var oldData = read(normalizeCss, image);\n      updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n        return toggleCaption(image);\n      });\n      updateProp(image, oldData, newData, 'src', setAttrib);\n      updateProp(image, oldData, newData, 'alt', setAttrib);\n      updateProp(image, oldData, newData, 'title', setAttrib);\n      updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n      updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n      updateProp(image, oldData, newData, 'class', setAttrib);\n      updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n        return setAttrib(image, 'style', value);\n      }, normalizeCss));\n      updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n      updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n      updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n      updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n    };\n\n    var normalizeCss = function (editor, cssText) {\n      var css = editor.dom.styles.parse(cssText);\n      var mergedCss = Utils.mergeMargins(css);\n      var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n      return editor.dom.styles.serialize(compressed);\n    };\n    var getSelectedImage = function (editor) {\n      var imgElm = editor.selection.getNode();\n      var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n      if (figureElm) {\n        return editor.dom.select('img', figureElm)[0];\n      }\n      if (imgElm && (imgElm.nodeName !== 'IMG' || Utils.isPlaceholderImage(imgElm))) {\n        return null;\n      }\n      return imgElm;\n    };\n    var splitTextBlock = function (editor, figure) {\n      var dom = editor.dom;\n      var textBlock = dom.getParent(figure.parentNode, function (node) {\n        return editor.schema.getTextBlockElements()[node.nodeName];\n      }, editor.getBody());\n      if (textBlock) {\n        return dom.split(textBlock, figure);\n      } else {\n        return figure;\n      }\n    };\n    var readImageDataFromSelection = function (editor) {\n      var image = getSelectedImage(editor);\n      return image ? read(function (css) {\n        return normalizeCss(editor, css);\n      }, image) : defaultData();\n    };\n    var insertImageAtCaret = function (editor, data) {\n      var elm = create(function (css) {\n        return normalizeCss(editor, css);\n      }, data);\n      editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n      editor.focus();\n      editor.selection.setContent(elm.outerHTML);\n      var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n      editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n      if (isFigure(insertedElm)) {\n        var figure = splitTextBlock(editor, insertedElm);\n        editor.selection.select(figure);\n      } else {\n        editor.selection.select(insertedElm);\n      }\n    };\n    var syncSrcAttr = function (editor, image) {\n      editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n    };\n    var deleteImage = function (editor, image) {\n      if (image) {\n        var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n        editor.dom.remove(elm);\n        editor.focus();\n        editor.nodeChanged();\n        if (editor.dom.isEmpty(editor.getBody())) {\n          editor.setContent('');\n          editor.selection.setCursorLocation();\n        }\n      }\n    };\n    var writeImageDataToSelection = function (editor, data) {\n      var image = getSelectedImage(editor);\n      write(function (css) {\n        return normalizeCss(editor, css);\n      }, data, image);\n      syncSrcAttr(editor, image);\n      if (isFigure(image.parentNode)) {\n        var figure = image.parentNode;\n        splitTextBlock(editor, figure);\n        editor.selection.select(image.parentNode);\n      } else {\n        editor.selection.select(image);\n        Utils.waitLoadImage(editor, data, image);\n      }\n    };\n    var insertOrUpdateImage = function (editor, data) {\n      var image = getSelectedImage(editor);\n      if (image) {\n        if (data.src) {\n          writeImageDataToSelection(editor, data);\n        } else {\n          deleteImage(editor, image);\n        }\n      } else if (data.src) {\n        insertImageAtCaret(editor, data);\n      }\n    };\n\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Option.none();\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getValue = function (item) {\n      return isString(item.value) ? item.value : '';\n    };\n    var sanitizeList = function (list, extractValue) {\n      var out = [];\n      global$4.each(list, function (item) {\n        var text = isString(item.text) ? item.text : isString(item.title) ? item.title : '';\n        if (item.menu !== undefined) {\n          var items = sanitizeList(item.menu, extractValue);\n          out.push({\n            text: text,\n            items: items\n          });\n        } else {\n          var value = extractValue(item);\n          out.push({\n            text: text,\n            value: value\n          });\n        }\n      });\n      return out;\n    };\n    var sanitizer = function (extracter) {\n      if (extracter === void 0) {\n        extracter = getValue;\n      }\n      return function (list) {\n        if (list) {\n          return Option.from(list).map(function (list) {\n            return sanitizeList(list, extracter);\n          });\n        } else {\n          return Option.none();\n        }\n      };\n    };\n    var sanitize = function (list) {\n      return sanitizer(getValue)(list);\n    };\n    var isGroup = function (item) {\n      return Object.prototype.hasOwnProperty.call(item, 'items');\n    };\n    var findEntryDelegate = function (list, value) {\n      return findMap(list, function (item) {\n        if (isGroup(item)) {\n          return findEntryDelegate(item.items, value);\n        } else if (item.value === value) {\n          return Option.some(item);\n        } else {\n          return Option.none();\n        }\n      });\n    };\n    var findEntry = function (optList, value) {\n      return optList.bind(function (list) {\n        return findEntryDelegate(list, value);\n      });\n    };\n    var ListUtils = {\n      sanitizer: sanitizer,\n      sanitize: sanitize,\n      findEntry: findEntry\n    };\n\n    function XMLHttpRequest () {\n      var f = Global$1.getOrDie('XMLHttpRequest');\n      return new f();\n    }\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n      return path2;\n    };\n    function Uploader (settings) {\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr, formData;\n        xhr = XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          var json;\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        formData = new domGlobals.FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var uploadBlob = function (blobInfo, handler) {\n        return new global$1(function (resolve, reject) {\n          try {\n            handler(blobInfo, resolve, reject, noop);\n          } catch (ex) {\n            reject(ex.message);\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var upload = function (blobInfo) {\n        return !settings.url && isDefaultHandler(settings.handler) ? global$1.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n      };\n      settings = global$4.extend({\n        credentials: false,\n        handler: defaultHandler\n      }, settings);\n      return { upload: upload };\n    }\n\n    var makeTab$1 = function (info) {\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: [\n          {\n            type: 'input',\n            label: 'Style',\n            name: 'style'\n          },\n          {\n            type: 'grid',\n            columns: 2,\n            items: [\n              {\n                type: 'input',\n                label: 'Vertical space',\n                name: 'vspace'\n              },\n              {\n                type: 'input',\n                label: 'Horizontal space',\n                name: 'hspace'\n              },\n              {\n                type: 'input',\n                label: 'Border width',\n                name: 'border'\n              },\n              {\n                type: 'selectbox',\n                name: 'borderstyle',\n                label: 'Border style',\n                items: [\n                  {\n                    text: 'Select...',\n                    value: ''\n                  },\n                  {\n                    text: 'Solid',\n                    value: 'solid'\n                  },\n                  {\n                    text: 'Dotted',\n                    value: 'dotted'\n                  },\n                  {\n                    text: 'Dashed',\n                    value: 'dashed'\n                  },\n                  {\n                    text: 'Double',\n                    value: 'double'\n                  },\n                  {\n                    text: 'Groove',\n                    value: 'groove'\n                  },\n                  {\n                    text: 'Ridge',\n                    value: 'ridge'\n                  },\n                  {\n                    text: 'Inset',\n                    value: 'inset'\n                  },\n                  {\n                    text: 'Outset',\n                    value: 'outset'\n                  },\n                  {\n                    text: 'None',\n                    value: 'none'\n                  },\n                  {\n                    text: 'Hidden',\n                    value: 'hidden'\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      };\n    };\n    var AdvTab = { makeTab: makeTab$1 };\n\n    var collect = function (editor) {\n      var urlListSanitizer = ListUtils.sanitizer(function (item) {\n        return editor.convertURL(item.value || item.url, 'src');\n      });\n      var futureImageList = Future.nu(function (completer) {\n        Utils.createImageList(editor, function (imageList) {\n          completer(urlListSanitizer(imageList).map(function (items) {\n            return flatten([\n              [{\n                  text: 'None',\n                  value: ''\n                }],\n              items\n            ]);\n          }));\n        });\n      });\n      var classList = ListUtils.sanitize(Settings.getClassList(editor));\n      var hasAdvTab = Settings.hasAdvTab(editor);\n      var hasUploadTab = Settings.hasUploadTab(editor);\n      var hasUploadUrl = Settings.hasUploadUrl(editor);\n      var hasUploadHandler = Settings.hasUploadHandler(editor);\n      var image = readImageDataFromSelection(editor);\n      var hasDescription = Settings.hasDescription(editor);\n      var hasImageTitle = Settings.hasImageTitle(editor);\n      var hasDimensions = Settings.hasDimensions(editor);\n      var hasImageCaption = Settings.hasImageCaption(editor);\n      var url = Settings.getUploadUrl(editor);\n      var basePath = Settings.getUploadBasePath(editor);\n      var credentials = Settings.getUploadCredentials(editor);\n      var handler = Settings.getUploadHandler(editor);\n      var prependURL = Option.some(Settings.getPrependUrl(editor)).filter(function (preUrl) {\n        return isString(preUrl) && preUrl.length > 0;\n      });\n      return futureImageList.map(function (imageList) {\n        return {\n          image: image,\n          imageList: imageList,\n          classList: classList,\n          hasAdvTab: hasAdvTab,\n          hasUploadTab: hasUploadTab,\n          hasUploadUrl: hasUploadUrl,\n          hasUploadHandler: hasUploadHandler,\n          hasDescription: hasDescription,\n          hasImageTitle: hasImageTitle,\n          hasDimensions: hasDimensions,\n          hasImageCaption: hasImageCaption,\n          url: url,\n          basePath: basePath,\n          credentials: credentials,\n          handler: handler,\n          prependURL: prependURL\n        };\n      });\n    };\n\n    var makeTab$2 = function (info) {\n      var items = [{\n          type: 'dropzone',\n          name: 'fileinput'\n        }];\n      return {\n        title: 'Upload',\n        name: 'upload',\n        items: items\n      };\n    };\n    var UploadTab = { makeTab: makeTab$2 };\n\n    var createState = function (info) {\n      return {\n        prevImage: ListUtils.findEntry(info.imageList, info.image.src),\n        prevAlt: info.image.alt,\n        open: true\n      };\n    };\n    var fromImageData = function (image) {\n      return {\n        src: {\n          value: image.src,\n          meta: {}\n        },\n        images: image.src,\n        alt: image.alt,\n        title: image.title,\n        dimensions: {\n          width: image.width,\n          height: image.height\n        },\n        classes: image.class,\n        caption: image.caption,\n        style: image.style,\n        vspace: image.vspace,\n        border: image.border,\n        hspace: image.hspace,\n        borderstyle: image.borderStyle,\n        fileinput: []\n      };\n    };\n    var toImageData = function (data) {\n      return {\n        src: data.src.value,\n        alt: data.alt,\n        title: data.title,\n        width: data.dimensions.width,\n        height: data.dimensions.height,\n        class: data.classes,\n        style: data.style,\n        caption: data.caption,\n        hspace: data.hspace,\n        vspace: data.vspace,\n        border: data.border,\n        borderStyle: data.borderstyle\n      };\n    };\n    var addPrependUrl2 = function (info, srcURL) {\n      if (!/^(?:[a-zA-Z]+:)?\\/\\//.test(srcURL)) {\n        return info.prependURL.bind(function (prependUrl) {\n          if (srcURL.substring(0, prependUrl.length) !== prependUrl) {\n            return Option.some(prependUrl + srcURL);\n          }\n          return Option.none();\n        });\n      }\n      return Option.none();\n    };\n    var addPrependUrl = function (info, api) {\n      var data = api.getData();\n      addPrependUrl2(info, data.src.value).each(function (srcURL) {\n        api.setData({\n          src: {\n            value: srcURL,\n            meta: data.src.meta\n          }\n        });\n      });\n    };\n    var formFillFromMeta2 = function (info, data, meta) {\n      if (info.hasDescription && isString(meta.alt)) {\n        data.alt = meta.alt;\n      }\n      if (info.hasImageTitle && isString(meta.title)) {\n        data.title = meta.title;\n      }\n      if (info.hasDimensions) {\n        if (isString(meta.width)) {\n          data.dimensions.width = meta.width;\n        }\n        if (isString(meta.height)) {\n          data.dimensions.height = meta.height;\n        }\n      }\n      if (isString(meta.class)) {\n        ListUtils.findEntry(info.classList, meta.class).each(function (entry) {\n          data.classes = entry.value;\n        });\n      }\n      if (info.hasImageCaption) {\n        if (isBoolean(meta.caption)) {\n          data.caption = meta.caption;\n        }\n      }\n      if (info.hasAdvTab) {\n        if (isString(meta.vspace)) {\n          data.vspace = meta.vspace;\n        }\n        if (isString(meta.border)) {\n          data.border = meta.border;\n        }\n        if (isString(meta.hspace)) {\n          data.hspace = meta.hspace;\n        }\n        if (isString(meta.borderstyle)) {\n          data.borderstyle = meta.borderstyle;\n        }\n      }\n    };\n    var formFillFromMeta = function (info, api) {\n      var data = api.getData();\n      var meta = data.src.meta;\n      if (meta !== undefined) {\n        var newData = deepMerge({}, data);\n        formFillFromMeta2(info, newData, meta);\n        api.setData(newData);\n      }\n    };\n    var calculateImageSize = function (helpers, info, state, api) {\n      var data = api.getData();\n      var url = data.src.value;\n      var meta = data.src.meta || {};\n      if (!meta.width && !meta.height && info.hasDimensions) {\n        helpers.imageSize(url).get(function (result) {\n          result.each(function (size) {\n            if (state.open) {\n              api.setData({ dimensions: size });\n            }\n          });\n        });\n      }\n    };\n    var updateImagesDropdown = function (info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.src.value);\n      state.prevImage = image;\n      api.setData({\n        images: image.map(function (entry) {\n          return entry.value;\n        }).getOr('')\n      });\n    };\n    var changeSrc = function (helpers, info, state, api) {\n      addPrependUrl(info, api);\n      formFillFromMeta(info, api);\n      calculateImageSize(helpers, info, state, api);\n      updateImagesDropdown(info, state, api);\n    };\n    var changeImages = function (helpers, info, state, api) {\n      var data = api.getData();\n      var image = ListUtils.findEntry(info.imageList, data.images);\n      image.each(function (img) {\n        var updateAlt = data.alt === '' || state.prevImage.map(function (image) {\n          return image.text === data.alt;\n        }).getOr(false);\n        if (updateAlt) {\n          if (img.value === '') {\n            api.setData({\n              src: img,\n              alt: state.prevAlt\n            });\n          } else {\n            api.setData({\n              src: img,\n              alt: img.text\n            });\n          }\n        } else {\n          api.setData({ src: img });\n        }\n      });\n      state.prevImage = image;\n      changeSrc(helpers, info, state, api);\n    };\n    var calcVSpace = function (css) {\n      var matchingTopBottom = css['margin-top'] && css['margin-bottom'] && css['margin-top'] === css['margin-bottom'];\n      return matchingTopBottom ? Utils.removePixelSuffix(String(css['margin-top'])) : '';\n    };\n    var calcHSpace = function (css) {\n      var matchingLeftRight = css['margin-right'] && css['margin-left'] && css['margin-right'] === css['margin-left'];\n      return matchingLeftRight ? Utils.removePixelSuffix(String(css['margin-right'])) : '';\n    };\n    var calcBorderWidth = function (css) {\n      return css['border-width'] ? Utils.removePixelSuffix(String(css['border-width'])) : '';\n    };\n    var calcBorderStyle = function (css) {\n      return css['border-style'] ? String(css['border-style']) : '';\n    };\n    var calcStyle = function (parseStyle, serializeStyle, css) {\n      return serializeStyle(parseStyle(serializeStyle(css)));\n    };\n    var changeStyle2 = function (parseStyle, serializeStyle, data) {\n      var css = Utils.mergeMargins(parseStyle(data.style));\n      var dataCopy = deepMerge({}, data);\n      dataCopy.vspace = calcVSpace(css);\n      dataCopy.hspace = calcHSpace(css);\n      dataCopy.border = calcBorderWidth(css);\n      dataCopy.borderstyle = calcBorderStyle(css);\n      dataCopy.style = calcStyle(parseStyle, serializeStyle, css);\n      return dataCopy;\n    };\n    var changeStyle = function (helpers, api) {\n      var data = api.getData();\n      var newData = changeStyle2(helpers.parseStyle, helpers.serializeStyle, data);\n      api.setData(newData);\n    };\n    var changeAStyle = function (helpers, info, api) {\n      var data = deepMerge(fromImageData(info.image), api.getData());\n      var style = getStyleValue(helpers.normalizeCss, toImageData(data));\n      api.setData({ style: style });\n    };\n    var changeFileInput = function (helpers, info, state, api) {\n      var data = api.getData();\n      api.block('Uploading image');\n      head(data.fileinput).fold(function () {\n        api.unblock();\n      }, function (file) {\n        var blobUri = URL.createObjectURL(file);\n        var uploader = Uploader({\n          url: info.url,\n          basePath: info.basePath,\n          credentials: info.credentials,\n          handler: info.handler\n        });\n        var finalize = function () {\n          api.unblock();\n          URL.revokeObjectURL(blobUri);\n        };\n        Utils.blobToDataUri(file).then(function (dataUrl) {\n          var blobInfo = helpers.createBlobCache(file, blobUri, dataUrl);\n          uploader.upload(blobInfo).then(function (url) {\n            api.setData({\n              src: {\n                value: url,\n                meta: {}\n              }\n            });\n            api.showTab('general');\n            changeSrc(helpers, info, state, api);\n            finalize();\n          }).catch(function (err) {\n            finalize();\n            helpers.alertErr(api, err);\n          });\n        });\n      });\n    };\n    var changeHandler = function (helpers, info, state) {\n      return function (api, evt) {\n        if (evt.name === 'src') {\n          changeSrc(helpers, info, state, api);\n        } else if (evt.name === 'images') {\n          changeImages(helpers, info, state, api);\n        } else if (evt.name === 'alt') {\n          state.prevAlt = api.getData().alt;\n        } else if (evt.name === 'style') {\n          changeStyle(helpers, api);\n        } else if (evt.name === 'vspace' || evt.name === 'hspace' || evt.name === 'border' || evt.name === 'borderstyle') {\n          changeAStyle(helpers, info, api);\n        } else if (evt.name === 'fileinput') {\n          changeFileInput(helpers, info, state, api);\n        }\n      };\n    };\n    var closeHandler = function (state) {\n      return function () {\n        state.open = false;\n      };\n    };\n    var makeDialogBody = function (info) {\n      if (info.hasAdvTab || info.hasUploadUrl || info.hasUploadHandler) {\n        var tabPanel = {\n          type: 'tabpanel',\n          tabs: flatten([\n            [MainTab.makeTab(info)],\n            info.hasAdvTab ? [AdvTab.makeTab(info)] : [],\n            info.hasUploadTab && (info.hasUploadUrl || info.hasUploadHandler) ? [UploadTab.makeTab(info)] : []\n          ])\n        };\n        return tabPanel;\n      } else {\n        var panel = {\n          type: 'panel',\n          items: MainTab.makeItems(info)\n        };\n        return panel;\n      }\n    };\n    var makeDialog = function (helpers) {\n      return function (info) {\n        var state = createState(info);\n        return {\n          title: 'Insert/Edit Image',\n          size: 'normal',\n          body: makeDialogBody(info),\n          buttons: [\n            {\n              type: 'cancel',\n              name: 'cancel',\n              text: 'Cancel'\n            },\n            {\n              type: 'submit',\n              name: 'save',\n              text: 'Save',\n              primary: true\n            }\n          ],\n          initialData: fromImageData(info.image),\n          onSubmit: helpers.onSubmit(info),\n          onChange: changeHandler(helpers, info, state),\n          onClose: closeHandler(state)\n        };\n      };\n    };\n    var submitHandler = function (editor) {\n      return function (info) {\n        return function (api) {\n          var data = deepMerge(fromImageData(info.image), api.getData());\n          editor.undoManager.transact(function () {\n            insertOrUpdateImage(editor, toImageData(data));\n          });\n          editor.editorUpload.uploadImagesAuto();\n          api.close();\n        };\n      };\n    };\n    var imageSize = function (editor) {\n      return function (url) {\n        return FutureResult.nu(function (completer) {\n          Utils.getImageSize(editor.documentBaseURI.toAbsolute(url), function (data) {\n            var result = data.map(function (dimensions) {\n              return {\n                width: String(dimensions.width),\n                height: String(dimensions.height)\n              };\n            });\n            completer(result);\n          });\n        });\n      };\n    };\n    var createBlobCache = function (editor) {\n      return function (file, blobUri, dataUrl) {\n        return editor.editorUpload.blobCache.create({\n          blob: file,\n          blobUri: blobUri,\n          name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n          base64: dataUrl.split(',')[1]\n        });\n      };\n    };\n    var alertErr = function (editor) {\n      return function (api, message) {\n        editor.windowManager.alert(message, api.close);\n      };\n    };\n    var normalizeCss$1 = function (editor) {\n      return function (cssText) {\n        return normalizeCss(editor, cssText);\n      };\n    };\n    var parseStyle = function (editor) {\n      return function (cssText) {\n        return editor.dom.parseStyle(cssText);\n      };\n    };\n    var serializeStyle = function (editor) {\n      return function (stylesArg, name) {\n        return editor.dom.serializeStyle(stylesArg, name);\n      };\n    };\n    var Dialog = function (editor) {\n      var helpers = {\n        onSubmit: submitHandler(editor),\n        imageSize: imageSize(editor),\n        createBlobCache: createBlobCache(editor),\n        alertErr: alertErr(editor),\n        normalizeCss: normalizeCss$1(editor),\n        parseStyle: parseStyle(editor),\n        serializeStyle: serializeStyle(editor)\n      };\n      var open = function () {\n        return collect(editor).map(makeDialog(helpers)).get(function (spec) {\n          editor.windowManager.open(spec);\n        });\n      };\n      return { open: open };\n    };\n\n    var register = function (editor) {\n      editor.addCommand('mceImage', Dialog(editor).open);\n    };\n    var Commands = { register: register };\n\n    var hasImageClass = function (node) {\n      var className = node.attr('class');\n      return className && /\\bimage\\b/.test(className);\n    };\n    var toggleContentEditableState = function (state) {\n      return function (nodes) {\n        var i = nodes.length;\n        var toggleContentEditable = function (node) {\n          node.attr('contenteditable', state ? 'true' : null);\n        };\n        while (i--) {\n          var node = nodes[i];\n          if (hasImageClass(node)) {\n            node.attr('contenteditable', state ? 'false' : null);\n            global$4.each(node.getAll('figcaption'), toggleContentEditable);\n          }\n        }\n      };\n    };\n    var setup = function (editor) {\n      editor.on('PreInit', function () {\n        editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n        editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n      });\n    };\n    var FilterContent = { setup: setup };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || domGlobals.document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        domGlobals.console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || domGlobals.document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: constant(node) };\n    };\n    var fromPoint = function (docElm, x, y) {\n      var doc = docElm.dom();\n      return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n    };\n    var Element = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n    var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n    var COMMENT = domGlobals.Node.COMMENT_NODE;\n    var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n    var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n    var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n    var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n    var TEXT = domGlobals.Node.TEXT_NODE;\n    var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n    var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n    var ENTITY = domGlobals.Node.ENTITY_NODE;\n    var NOTATION = domGlobals.Node.NOTATION_NODE;\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n\n    var Immutable = function () {\n      var fields = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n      return function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n        var struct = {};\n        each(fields, function (name, i) {\n          struct[name] = constant(values[i]);\n        });\n        return struct;\n      };\n    };\n\n    var node = function () {\n      var f = Global$1.getOrDie('Node');\n      return f;\n    };\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, node().DOCUMENT_POSITION_PRECEDING);\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, node().DOCUMENT_POSITION_CONTAINED_BY);\n    };\n    var Node = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s))\n          return x;\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r)\n        return {\n          major: 0,\n          minor: 0\n        };\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu$3(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0)\n        return unknown();\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu$3(0, 0);\n    };\n    var nu$3 = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu$3,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$1 = function () {\n      return nu$4({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$4 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$4,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n    var unknown$2 = function () {\n      return nu$5({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$5 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$5,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd)\n    };\n\n    var DeviceType = function (os, browser, userAgent) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isAndroid3 = os.isAndroid() && os.version.major === 3;\n      var isAndroid4 = os.isAndroid() && os.version.major === 4;\n      var isTablet = isiPad || isAndroid3 || isAndroid4 && /mobile/i.test(userAgent) === true;\n      var isTouch = os.isiOS() || os.isAndroid();\n      var isPhone = isTouch && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview)\n      };\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var contains = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          var monstrosity = contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n          return monstrosity;\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'msie') || contains(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('os x'),\n        versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var detect$2 = function (userAgent) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var detect$3 = cached(function () {\n      var userAgent = domGlobals.navigator.userAgent;\n      return PlatformDetection.detect(userAgent);\n    });\n    var PlatformDetection$1 = { detect: detect$3 };\n\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom();\n      var d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n    var browser = PlatformDetection$1.detect().browser;\n    var contains$1 = browser.isIE() ? ieContains : regularContains;\n\n    var parent = function (element) {\n      var dom = element.dom();\n      return Option.from(dom.parentNode).map(Element.fromDom);\n    };\n    var spot = Immutable('element', 'offset');\n\n    var getRootElement = function (elm) {\n      return parent(elm).filter(function (parentElm) {\n        return name(parentElm) === 'figure';\n      }).getOr(elm);\n    };\n    var register$1 = function (editor) {\n      var makeContextMenuItem = function (node) {\n        return {\n          text: 'Image',\n          icon: 'image',\n          onAction: function () {\n            var rootElm = getRootElement(Element.fromDom(node));\n            editor.selection.select(rootElm.dom());\n            Dialog(editor).open();\n          }\n        };\n      };\n      editor.ui.registry.addToggleButton('image', {\n        icon: 'image',\n        tooltip: 'Insert/edit image',\n        onAction: Dialog(editor).open,\n        onSetup: function (buttonApi) {\n          return editor.selection.selectorChangedWithUnbind('img:not([data-mce-object],[data-mce-placeholder]),figure.image', buttonApi.setActive).unbind;\n        }\n      });\n      editor.ui.registry.addMenuItem('image', {\n        icon: 'image',\n        text: 'Image...',\n        onAction: Dialog(editor).open\n      });\n      editor.ui.registry.addContextMenu('image', {\n        update: function (element) {\n          return isFigure(element) || isImage(element) && !Utils.isPlaceholderImage(element) ? [makeContextMenuItem(element)] : [];\n        }\n      });\n    };\n    var Buttons = { register: register$1 };\n\n    global.add('image', function (editor) {\n      FilterContent.setup(editor);\n      Buttons.register(editor);\n      Commands.register(editor);\n    });\n    function Plugin () {\n    }\n\n    return Plugin;\n\n}(window));\n})();\n"]}]}