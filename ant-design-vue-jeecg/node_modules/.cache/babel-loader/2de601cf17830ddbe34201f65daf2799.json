{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js??ref--0-0!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\product\\modules\\ProductAuditMoadl.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\product\\modules\\ProductAuditMoadl.vue","mtime":1591672206234},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getAction, httpAction } from '@/api/manage';\nimport pick from 'lodash.pick';\nimport JCodeEditor from \"@/components/jeecg/JCodeEditor\";\nimport JEditor from \"@/components/jeecg/JEditor\";\nimport AvatarModal from \"@/views/account/settings/AvatarModal\";\nimport * as qiniu from 'qiniu-js';\nexport default {\n  name: \"ProductAuditMoadl\",\n  data: function data() {\n    return {\n      title: \"操作\",\n      visible: false,\n      model: {},\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 5\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 17\n        }\n      },\n      labelColc: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 3\n        }\n      },\n      wrapperColc: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 20\n        }\n      },\n      labelColk: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 2\n        }\n      },\n      wrapperColk: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 21\n        }\n      },\n      loading: false,\n      confirmLoading: false,\n      form: this.$form.createForm(this),\n      coverimg: '',\n      canimg: '',\n      percent: '',\n      refusereason: '',\n      disableSubmit: false,\n      content: '',\n      thisType: null,\n      headers: {},\n      selectList: [],\n      validatorRules: {},\n      url: {\n        getbyId: '/product/productsource/findListByProductId',\n        fileUpload: window._CONFIG['domianQiNiu'],\n        qiniuToken: '/qiniuUpToken'\n      }\n    };\n  },\n  components: {\n    JCodeEditor: JCodeEditor,\n    JEditor: JEditor,\n    AvatarModal: AvatarModal\n  },\n  computed: {\n    uploadAction: function uploadAction() {\n      return this.url.fileUpload;\n    }\n  },\n  methods: {\n    add: function add() {\n      this.coverimg = '';\n      this.refusereason = '';\n      this.content = '';\n      this.edit({});\n    },\n    edit: function edit(record) {\n      var _this = this;\n\n      console.log(record);\n      this.coverimg = record.coverimg;\n      this.form.resetFields();\n      this.getNewModel(record.id);\n\n      if (record.id) {\n        this.thisType = record.type;\n      }\n\n      this.model = Object.assign({}, record);\n      this.visible = true;\n      this.$nextTick(function () {\n        _this.form.setFieldsValue(pick(_this.model, 'id', 'title', 'introduction', 'albumname', 'nickname', 'coverimg', 'auditstate', 'catename', 'type', 'price'));\n      });\n    },\n    // 根据id获取具体数据\n    getNewModel: function getNewModel(id) {\n      var _this2 = this;\n\n      var html = '';\n      var that = this;\n      getAction(this.url.getbyId, {\n        productId: id,\n        ischeck: 1\n      }).then(function (res) {\n        if (res.success) {\n          var record = res.result;\n          html += '<div style=\"max-height: 350px;overflow-y: scroll;\">';\n          record.forEach(function (item) {\n            switch (item.type) {\n              case 'img':\n                html += \"<p><img src=\\\"\".concat(item.url, \"\\\" style=\\\"width:300px;\\\" /><br/><span style=\\\"color: #ccc;\\\">\").concat(item.title, \"</span></p>\");\n                break;\n\n              case 'text':\n                html += \"<p style=\\\"text-indent: 2em;\\\"><h3 style=\\\"text-align: center;\\\">\".concat(item.title, \"</h3>\").concat(item.url, \"</p>\");\n                break;\n\n              case 'video':\n                html += \"<p><video controls=\\\"controls\\\" width=\\\"300\\\" height=\\\"150\\\"><source src=\\\"\".concat(item.url, \"\\\" /></video></p>\");\n                break;\n\n              case 'audio':\n                html += \"<p><audio src=\\\"\".concat(item.url, \"\\\" controls=\\\"controls\\\"></audio></p>\");\n                break;\n\n              default:\n                break;\n            }\n          });\n          html += '</div>';\n          _this2.content = html;\n          console.log('this.content');\n          console.log(_this2.content);\n        } else {\n          that.$message.warning(res.message);\n        }\n      });\n    },\n    close: function close() {\n      this.$emit('close');\n      this.visible = false;\n      this.coverimg = '';\n      this.disableSubmit = false;\n      this.content = '';\n    },\n    handleCancel: function handleCancel() {\n      this.close();\n    },\n    // 自定义上传\n    customRequest: function customRequest(data) {\n      var _this3 = this;\n\n      var suffix = \".\" + data.file.name.replace(/^.+\\./, ''); //请求token\n\n      httpAction(this.url.qiniuToken, {}, 'post').then(function (res) {\n        if (res) {\n          var token = res.data.token;\n          var file = data.file;\n          var key = new Date().getTime() + suffix;\n          var domain = _this3.url.fileUpload;\n          var config = {\n            useCdnDomain: true,\n            region: null\n          };\n          var putExtra = {\n            fname: '',\n            params: {},\n            mimeType: null\n          };\n          var observable = qiniu.upload(file, key, token, putExtra, config);\n          observable.subscribe({\n            next: function next(res) {\n              _this3.loading = true;\n              _this3.percent = res.total.percent.toFixed(2);\n              _this3.coverimg = '';\n            },\n            error: function error() {\n              _this3.$message.error('上传失败');\n\n              _this3.loading = false;\n              _this3.coverimg = _this3.canimg;\n            },\n            complete: function complete(response) {\n              _this3.coverimg = \"\".concat(domain, \"/\").concat(response.key);\n              _this3.loading = false;\n            }\n          });\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["ProductAuditMoadl.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal\r\n    :title=\"title\"\r\n    :width=\"1200\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    @cancel=\"handleCancel\"\r\n    :footer=\"null\"\r\n    cancelText=\"关闭\"\r\n  >\r\n    \r\n    <a-spin :spinning=\"confirmLoading\">\r\n      <a-form :form=\"form\">\r\n        <a-row class=\"form-row\" :gutter=\"16\">\r\n          <a-col :lg=\"8\">\r\n            \r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程标题\">\r\n              <a-input placeholder=\"请输入课程标题\" v-decorator=\"['title', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程分类\">\r\n              <a-input placeholder=\"请输入课程分类\" v-decorator=\"['catename', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n    \r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程作者\">\r\n              <a-input placeholder=\"请输入课程作者\" v-decorator=\"['nickname', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n    \r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程专辑\">\r\n              <a-input placeholder=\"请输入课程专辑\" v-decorator=\"['albumname', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"审核状态\">\r\n              <a-select placeholder=\"请选择审核状态\" v-decorator=\"['auditstate', {}]\" disabled>\r\n                <a-select-option :value=\"1\">审核中</a-select-option>\r\n                <a-select-option :value=\"2\">审核不通过</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"是否收费\">\r\n              <a-select placeholder=\"请选择是否收费\" v-decorator=\"['type', {}]\" disabled>\r\n                <a-select-option :value=\"3\">收费</a-select-option>\r\n                <a-select-option :value=\"1\">免费</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"8\" v-if=\"thisType === 3\">\r\n            <a-form-item\r\n              :labelCol=\"labelCol\"\r\n              :wrapperCol=\"wrapperCol\"\r\n              label=\"课程价格\">\r\n              <a-input placeholder=\"请输入课程价格\" v-decorator=\"['price', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"14\" v-show=\"thisType === 3\">\r\n            <a-form-item\r\n              :labelCol=\"labelColc\"\r\n              :wrapperCol=\"wrapperColc\"\r\n              label=\"课程简介\">\r\n              <a-input placeholder=\"请输入课程简介\" v-decorator=\"['introduction', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"24\" v-show=\"thisType === 1\">\r\n            <a-form-item\r\n              :labelCol=\"labelColk\"\r\n              :wrapperCol=\"wrapperColk\"\r\n              label=\"课程简介\">\r\n              <a-input placeholder=\"请输入课程简介\" v-decorator=\"['introduction', {}]\" :readOnly=\"disableSubmit\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :lg=\"24\" v-show=\"disableSubmit\">\r\n            <a-form-item\r\n              :labelCol=\"labelColk\"\r\n              :wrapperCol=\"wrapperColk\"\r\n              label=\"课程详情\">\r\n              <div v-html=\"content\" style=\"border: 1px solid #ccc;padding: 20px;border-radius: 5px;\"></div>\r\n            </a-form-item>\r\n          </a-col>\r\n          \r\n        \r\n        </a-row>\r\n        <a-form-item label=\"课程封面\" :labelCol=\"labelColk\" :wrapperCol=\"wrapperColk\">\r\n          <a-upload\r\n            listType=\"picture-card\"\r\n            class=\"avatar-uploader\"\r\n            :showUploadList=\"false\"\r\n            :supportServerRender=\"true\"\r\n            :customRequest=\"customRequest\"\r\n            :disabled=\"disableSubmit\"\r\n          >\r\n            <img v-if=\"coverimg\" :src=\"coverimg\" alt=\"avatar\" style=\"max-width: 150px;\" />\r\n            <div v-else>\r\n              <a-icon :type=\"loading ? 'loading' : 'plus'\" />\r\n              <div class=\"ant-upload-text\" v-if=\"!loading\">Upload</div>\r\n              <div class=\"ant-upload-text\" v-if=\"loading\">{{ percent }}%</div>\r\n            </div>\r\n          </a-upload>\r\n        \r\n        </a-form-item>\r\n        \r\n        <a-form-item label=\"拒绝理由\" :labelCol=\"labelColk\" :wrapperCol=\"wrapperColk\" v-if=\"refusereason\">\r\n          <a-textarea v-model=\"refusereason\" :autosize=\"{ minRows: 3, maxRows: 8 }\" :readOnly=\"true\"/>\r\n        </a-form-item>\r\n      \r\n      </a-form>\r\n    </a-spin>\r\n    <avatar-modal ref=\"modal\"></avatar-modal>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import { getAction, httpAction } from '@/api/manage'\r\n  import pick from 'lodash.pick'\r\n  import JCodeEditor from \"@/components/jeecg/JCodeEditor\"\r\n  import JEditor from \"@/components/jeecg/JEditor\"\r\n  import AvatarModal from \"@/views/account/settings/AvatarModal\";\r\n  import * as qiniu from 'qiniu-js'\r\n\r\n  export default {\r\n    name: \"ProductAuditMoadl\",\r\n    data () {\r\n      return {\r\n        title:\"操作\",\r\n        visible: false,\r\n        model: {},\r\n        labelCol: {\r\n          xs: { span: 24 },\r\n          sm: { span: 5 },\r\n        },\r\n        wrapperCol: {\r\n          xs: { span: 24 },\r\n          sm: { span: 17 },\r\n        },\r\n        labelColc: {\r\n          xs: { span: 24 },\r\n          sm: { span: 3 },\r\n        },\r\n        wrapperColc: {\r\n          xs: { span: 24 },\r\n          sm: { span: 20 },\r\n        },\r\n        labelColk: {\r\n          xs: { span: 24 },\r\n          sm: { span: 2 },\r\n        },\r\n        wrapperColk: {\r\n          xs: { span: 24 },\r\n          sm: { span: 21 },\r\n        },\r\n        loading: false,\r\n        confirmLoading: false,\r\n        form: this.$form.createForm(this),\r\n        coverimg: '',\r\n        canimg: '',\r\n        percent: '',\r\n        refusereason: '',\r\n        disableSubmit: false,\r\n        content: '',\r\n        thisType: null,\r\n        headers: {},\r\n        selectList: [],\r\n        validatorRules:{\r\n        },\r\n        url: {\r\n          getbyId: '/product/productsource/findListByProductId',\r\n          fileUpload: window._CONFIG['domianQiNiu'],\r\n          qiniuToken: '/qiniuUpToken'\r\n        },\r\n      }\r\n    },\r\n    components: {\r\n      JCodeEditor,\r\n      JEditor,\r\n      AvatarModal\r\n    },\r\n    computed:{\r\n      uploadAction:function () {\r\n        return this.url.fileUpload;\r\n      }\r\n    },\r\n    methods: {\r\n      add () {\r\n        this.coverimg = '';\r\n        this.refusereason = '';\r\n        this.content = '';\r\n        this.edit({});\r\n      },\r\n      edit (record) {\r\n        console.log(record)\r\n        this.coverimg = record.coverimg;\r\n        this.form.resetFields();\r\n        this.getNewModel (record.id);\r\n        if (record.id) {\r\n          this.thisType = record.type;\r\n        }\r\n        this.model = Object.assign({}, record);\r\n        this.visible = true;\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(pick(this.model,'id','title','introduction','albumname','nickname','coverimg', 'auditstate','catename', 'type', 'price'))\r\n        });\r\n      },\r\n      // 根据id获取具体数据\r\n      getNewModel (id) {\r\n        let html = '';\r\n        const that = this;\r\n        getAction(this.url.getbyId,{productId: id, ischeck:1}).then((res) => {\r\n          if(res.success){\r\n            let record = res.result;\r\n            html += '<div style=\"max-height: 350px;overflow-y: scroll;\">';\r\n            record.forEach(item => {\r\n              switch (item.type) {\r\n                case 'img':\r\n                  html += `<p><img src=\"${item.url}\" style=\"width:300px;\" /><br/><span style=\"color: #ccc;\">${item.title}</span></p>`;\r\n                  break;\r\n                case 'text':\r\n                  html += `<p style=\"text-indent: 2em;\"><h3 style=\"text-align: center;\">${item.title}</h3>${item.url}</p>`;\r\n                  break;\r\n                case 'video':\r\n                  html += `<p><video controls=\"controls\" width=\"300\" height=\"150\"><source src=\"${item.url}\" /></video></p>`;\r\n                  break;\r\n                case 'audio':\r\n                  html += `<p><audio src=\"${item.url}\" controls=\"controls\"></audio></p>`;\r\n                  break;\r\n                default:\r\n                  break\r\n              }\r\n            });\r\n            html += '</div>';\r\n            this.content = html;\r\n             console.log('this.content')\r\n            console.log(this.content)\r\n          }else{\r\n            that.$message.warning(res.message);\r\n          }\r\n        })\r\n      },\r\n      close () {\r\n        this.$emit('close');\r\n        this.visible = false;\r\n        this.coverimg = '';\r\n        this.disableSubmit = false;\r\n        this.content = '';\r\n      },\r\n      handleCancel () {\r\n        this.close()\r\n      },\r\n      // 自定义上传\r\n      customRequest (data) {\r\n        const suffix = \".\" + data.file.name.replace(/^.+\\./, '')\r\n        //请求token\r\n        httpAction(this.url.qiniuToken, {}, 'post').then((res) => {\r\n          if (res) {\r\n            let token = res.data.token\r\n            const file = data.file\r\n            const key = new Date().getTime() + suffix;\r\n            let domain = this.url.fileUpload\r\n            let config = {\r\n              useCdnDomain: true,\r\n              region: null\r\n            }\r\n            let putExtra = {\r\n              fname: '',\r\n              params: {},\r\n              mimeType: null\r\n            }\r\n            let observable = qiniu.upload(file, key, token, putExtra, config);\r\n            observable.subscribe({\r\n              next: (res) => {\r\n                this.loading = true;\r\n                this.percent = res.total.percent.toFixed(2)\r\n                this.coverimg = '';\r\n              },\r\n              error: () => {\r\n                this.$message.error('上传失败')\r\n                this.loading = false;\r\n                this.coverimg = this.canimg\r\n              },\r\n              complete: (response) => {\r\n                this.coverimg = `${domain}/${response.key}`;\r\n                this.loading = false;\r\n              }\r\n            })\r\n          }\r\n        })\r\n      },\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  \r\n  .avatar-uploader > .ant-upload {\r\n    width: 128px;\r\n    height: 128px;\r\n  }\r\n  .ant-upload-select-picture-card i {\r\n    font-size: 32px;\r\n    color: #999;\r\n  }\r\n  \r\n  .ant-upload-select-picture-card .ant-upload-text {\r\n    margin-top: 8px;\r\n    color: #666;\r\n  }\r\n\r\n</style>\r\n"],"sourceRoot":"src/views/product/modules"}]}