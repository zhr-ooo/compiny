{"remainingRequest":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_thread-loader@2.1.3@thread-loader\\dist\\cjs.js!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js??ref--0-0!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js??vue-loader-options!E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\product\\modules\\awardAddModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\src\\views\\product\\modules\\awardAddModal.vue","mtime":1591262673292},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_thread-loader@2.1.3@thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\gitweb\\vcloudsapce_web\\ant-design-vue-jeecg\\node_modules\\_vue-loader@15.9.2@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { putAction, postAction, httpAction, getAction } from \"@/api/manage\";\nimport pick from \"lodash.pick\";\nimport * as qiniu from \"qiniu-js\";\nexport default {\n  name: \"awardAddModal\",\n  data: function data() {\n    return {\n      images: \"\",\n      canimg: \"\",\n      // 课程封面副\n      title: \"操作\",\n      selectList: [],\n      // 课程分类列表\n      selectList1: [],\n      percent: \"\",\n      // 图片上传进度\n      cateName: \"\",\n      // 分类名称\n      cateName1: \"\",\n      // 分类名称\n      userId: null,\n      teamName: \"\",\n      dataSource: [],\n      // 选择数据源\n      searchParam: \"\",\n      // 搜索字段\n      loading: false,\n      type: \"\",\n      autoSubmit: false,\n      visible: false,\n      // trueAnswer:1,\n      model: {},\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 5\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 16\n        }\n      },\n      confirmLoading: false,\n      form: this.$form.createForm(this),\n      validatorRules: {},\n      url: {\n        add: \"/system/question/add\",\n        edit: \"/system/question/update\",\n        //修改问题分类\n        selectNewList: \"/system/question/category/category-list\",\n        fileUpload: window._CONFIG[\"domianQiNiu\"],\n        // 七牛云地址\n        qiniuToken: \"/qiniuUpToken\",\n        // 请求七牛云上传的token\n        searchUrl: \"/system/appuserinfo/getUserBYPhoneOrCodeOrNickName\"\n      }\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    getAction(this.url.selectNewList).then(function (res) {\n      if (res.success) {\n        _this.selectList = res.result;\n      } else {\n        _this.$message.warning(res.message);\n      }\n    });\n  },\n  computed: {\n    uploadAction: function uploadAction() {\n      return this.url.fileUpload;\n    }\n  },\n  methods: {\n    // 类型选择\n    typeSelectHandle: function typeSelectHandle(value) {\n      var _this2 = this;\n\n      this.type = value;\n\n      if (this.type == 1) {\n        getAction(this.url.selectNewList, {\n          parentId: 1\n        }).then(function (res) {\n          if (res.success) {\n            console.log(res);\n            _this2.selectList = res.result;\n          } else {\n            _this2.$message.warning(res.message);\n          }\n        });\n      } else if (this.type == 2) {\n        getAction(this.url.selectNewList, {\n          parentId: 2\n        }).then(function (res) {\n          if (res.success) {\n            console.log(res);\n            _this2.selectList1 = res.result;\n          } else {\n            _this2.$message.warning(res.message);\n          }\n        });\n      }\n    },\n    makeNumber: function makeNumber(rule, value, callback) {\n      if (value < 100) {\n        callback(\"金额最少为100v币\");\n      } else {\n        callback();\n      }\n    },\n    handleSearch: function handleSearch(value) {\n      //   console.log(\"search\", value);\n      this.searchParam = value;\n    },\n    add: function add() {\n      this.images = \"\";\n      this.percent = \"\";\n      this.teamName = \"\";\n      this.trueAnswer = \"\";\n      this.confirmLoading = false;\n      this.edit({});\n    },\n    edit: function edit(record) {\n      var _this3 = this;\n\n      console.log(record);\n\n      if (record && record.title && record.title !== \"\") {\n        this.autoSubmit = true;\n      } else {\n        this.autoSubmit = false;\n      }\n\n      this.images = record.images;\n      this.canimg = record.images;\n      this.teamName = record.userName;\n      this.groupName = record.groupName;\n      this.questionId = record.id;\n      this.categoryId = record.groupId;\n      this.form.resetFields();\n      this.model = Object.assign({}, record);\n      this.visible = true;\n      this.$nextTick(function () {\n        _this3.form.setFieldsValue(pick(_this3.model, \"title\", \"images\", \"firstAnswer\", \"secondAnswer\", \"threeAnswer\", \"trueAnswer\", \"totalMoney\", \"number\", \"userName\", \"groupName\", //  \"groupName1\",\n        \"payPassword\", \"userId\", \"questionId\", \"categoryId\", \"parentId\"));\n      });\n    },\n    close: function close() {\n      this.$emit(\"close\");\n      this.percent = \"\";\n      this.images = \"\";\n      this.questionId = \"\";\n      this.categoryId = \"\";\n      this.userId = \"\";\n      this.visible = false;\n      this.cateName = \"\";\n      this.cateName2 = \"\";\n      this.dataSource = [];\n      this.trueAnswer = null;\n      this.searchParam = \"\";\n    },\n    onSelect: function onSelect(value) {\n      var _this4 = this;\n\n      this.dataSource.forEach(function (item) {\n        if (item.userId === Number(value)) {\n          _this4.userId = value;\n        }\n      });\n    },\n    //  开始搜索\n    beginSearch: function beginSearch() {\n      var _this5 = this;\n\n      getAction(this.url.searchUrl, {\n        searchParam: this.searchParam\n      }).then(function (res) {\n        if (res.success) {\n          if (res.result.length === 0) {\n            _this5.$message.warning(\"暂无数据\");\n          } else {\n            _this5.dataSource = res.result;\n          }\n        } else {\n          _this5.$message.warning(res.message);\n        }\n      }).catch(function (err) {\n        _this5.$message.warning(err.message);\n      });\n    },\n    cateoryHandle: function cateoryHandle(value) {\n      var _this6 = this;\n\n      this.selectList.forEach(function (item) {\n        if (item.id === value) {\n          _this6.groupName = item.name;\n          _this6.cateName = item.id;\n        }\n      });\n    },\n    cateoryHandle1: function cateoryHandle1(value) {\n      var _this7 = this;\n\n      this.selectList1.forEach(function (item) {\n        if (item.id === value) {\n          // this.groupName1 = item.name\n          _this7.groupName = item.name;\n          _this7.cateName = item.id;\n          console.log(\"this.cateName1\");\n          console.log(_this7.cateName);\n        }\n      });\n    },\n    handleOk: function handleOk() {\n      var _this8 = this;\n\n      var that = this; // 触发表单验证\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          // if(this.userId == undefined){\n          //   alert(\"请选择用户\")\n          // }else{\n          that.confirmLoading = true;\n          var httpurl = \"\"; // let categoryId  = '' ? this.cateName:this.cateName1;\n\n          var formData = Object.assign(_this8.model, values);\n          console.log(formData);\n          formData.images = _this8.images;\n          formData.questionId = _this8.questionId;\n          formData.categoryId = _this8.categoryId;\n          formData.userId = _this8.userId;\n          formData.groupName = _this8.groupName;\n          formData.groupName1 = _this8.groupName1;\n          var trueAnswer = formData.trueAnswer;\n\n          if (trueAnswer == 1) {\n            formData.trueAnswer = \"A\";\n          } else if (trueAnswer == 2) {\n            formData.trueAnswer = \"B\";\n          } else if (trueAnswer == 3) {\n            formData.trueAnswer = \"C\";\n          }\n\n          if (!_this8.model.id) {\n            httpurl += _this8.url.add;\n            var arr = \"?categoryId=\".concat(_this8.cateName, \"&firstAnswer=\").concat(formData.firstAnswer, \"&images=\").concat(formData.images, \"&number=\").concat(formData.number, \"&payPassword=\").concat(formData.payPassword, \"&secondAnswer=\").concat(formData.secondAnswer, \"&threeAnswer=\").concat(formData.threeAnswer, \"&title=\").concat(formData.title, \"&totalMoney=\").concat(formData.totalMoney, \"&trueAnswer=\").concat(formData.trueAnswer, \"&userId=\").concat(formData.userId);\n            arr = encodeURI(arr);\n            console.log(arr);\n            postAction(httpurl + arr).then(function (res) {\n              if (res.success) {\n                that.$message.success(res.message);\n                that.$emit(\"ok\");\n              } else {\n                that.$message.warning(res.message);\n              }\n            }).finally(function () {\n              that.confirmLoading = false;\n              that.close();\n            });\n          } else {\n            httpurl += _this8.url.edit;\n\n            var _arr = \"?firstAnswer=\".concat(formData.firstAnswer, \"&images=\").concat(formData.images, \"&questionId=\").concat(formData.questionId, \"&secondAnswer=\").concat(formData.secondAnswer, \"&threeAnswer=\").concat(formData.threeAnswer, \"&title=\").concat(formData.title, \"&trueAnswer=\").concat(formData.trueAnswer);\n\n            _arr = encodeURI(_arr);\n            console.log(_arr);\n            putAction(httpurl + _arr).then(function (res) {\n              if (res.success) {\n                that.$message.success(res.message);\n                that.$emit(\"ok\");\n              } else {\n                that.$message.warning(res.message);\n              }\n            }).finally(function () {\n              that.confirmLoading = false;\n              that.close();\n            }); // location.href = \"/vyun/product/awardList\"\n          }\n        } // }\n\n      });\n    },\n    // 图片自定义上传\n    imgCustomRequest: function imgCustomRequest(data) {\n      var _this9 = this;\n\n      // 开始转圈圈，上传中\n      this.loading = true; // 获取文件的后缀名\n\n      var suffix = \".\" + data.file.name.replace(/^.+\\./, \"\"); //请求token\n\n      httpAction(this.url.qiniuToken, {}, \"post\").then(function (res) {\n        if (res) {\n          var token = res.data.token;\n          var file = data.file;\n          var key = new Date().getTime() + suffix;\n          var domain = _this9.url.fileUpload;\n          var config = {\n            useCdnDomain: true,\n            // 域名加速\n            region: null // 不指定具体区域，自动识别\n\n          };\n          var putExtra = {\n            fname: \"\",\n            params: {},\n            mimeType: null\n          };\n          var observable = qiniu.upload(file, key, token, putExtra, config);\n          observable.subscribe({\n            next: function next(res) {\n              _this9.percent = res.total.percent.toFixed(2);\n              _this9.images = \"\";\n            },\n            error: function error() {\n              _this9.$message.error(\"上传失败\");\n\n              _this9.loading = false;\n              _this9.images = _this9.canimg;\n            },\n            complete: function complete(response) {\n              var allUrl = \"\".concat(domain, \"/\").concat(response.key); // 开始转圈圈，上传中\n\n              _this9.images = allUrl;\n              _this9.loading = false;\n            }\n          });\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.close();\n    }\n  }\n};",null]}